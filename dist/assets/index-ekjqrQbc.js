var ea=Object.defineProperty;var ll=e=>{throw TypeError(e)};var ta=(e,t,n)=>t in e?ea(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var pe=(e,t,n)=>ta(e,typeof t!="symbol"?t+"":t,n),di=(e,t,n)=>t.has(e)||ll("Cannot "+n);var u=(e,t,n)=>(di(e,t,"read from private field"),n?n.call(e):t.get(e)),ne=(e,t,n)=>t.has(e)?ll("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),z=(e,t,n,s)=>(di(e,t,"write to private field"),s?s.call(e,n):t.set(e,n),n),Z=(e,t,n)=>(di(e,t,"access private method"),n);var Bn=(e,t,n,s)=>({set _(i){z(e,t,i,n)},get _(){return u(e,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();function Tt(){}function na(e,t){for(const n in t)e[n]=t[n];return e}function Zl(e){return e()}function rl(){return Object.create(null)}function ut(e){e.forEach(Zl)}function Vs(e){return typeof e=="function"}function Ft(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function sa(e){return Object.keys(e).length===0}function bi(e,t,n,s){if(e){const i=Ql(e,t,n,s);return e[0](i)}}function Ql(e,t,n,s){return e[1]&&s?na(n.ctx.slice(),e[1](s(t))):n.ctx}function yi(e,t,n,s){if(e[2]&&s){const i=e[2](s(n));if(t.dirty===void 0)return i;if(typeof i=="object"){const l=[],r=Math.max(t.dirty.length,i.length);for(let d=0;d<r;d+=1)l[d]=t.dirty[d]|i[d];return l}return t.dirty|i}return t.dirty}function wi(e,t,n,s,i,l){if(i){const r=Ql(t,n,s,l);e.p(r,i)}}function Si(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let s=0;s<n;s++)t[s]=-1;return t}return-1}function Rn(e){return e??""}function xl(e){return e&&Vs(e.destroy)?e.destroy:Tt}const ia=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function a(e,t){e.appendChild(t)}function Q(e,t,n){e.insertBefore(t,n||null)}function J(e){e.parentNode&&e.parentNode.removeChild(e)}function Gi(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function h(e){return document.createElement(e)}function Se(e){return document.createTextNode(e)}function y(){return Se(" ")}function hs(){return Se("")}function M(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function m(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Ts(e){let t;return{p(...n){t=n,t.forEach(s=>e.push(s))},r(){t.forEach(n=>e.splice(e.indexOf(n),1))}}}function la(e,t){let n=i(e),s;function i(d){for(let o=0;o<t.length;o++)d=d[t[o]]=d[t[o]]||[];return d}function l(){s.forEach(d=>n.push(d))}function r(){s.forEach(d=>n.splice(n.indexOf(d),1))}return{u(d){t=d;const o=i(e);o!==n&&(r(),n=o,l())},p(...d){s=d,l()},r}}function tt(e){return e===""?null:+e}function ra(e){return Array.from(e.childNodes)}function ht(e,t){t=""+t,e.data!==t&&(e.data=t)}function V(e,t){e.value=t??""}function Nt(e,t,n,s){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,"")}function Qn(e,t,n){e.classList.toggle(t,!!n)}function aa(e,t,{bubbles:n=!1,cancelable:s=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:s})}let Os;function Fs(e){Os=e}function oa(){if(!Os)throw new Error("Function called outside component initialization");return Os}function gs(){const e=oa();return(t,n,{cancelable:s=!1}={})=>{const i=e.$$.callbacks[t];if(i){const l=aa(t,n,{cancelable:s});return i.slice().forEach(r=>{r.call(e,l)}),!l.defaultPrevented}return!0}}const $n=[],be=[];let ts=[];const Ci=[],ua=Promise.resolve();let vi=!1;function da(){vi||(vi=!0,ua.then(ti))}function Ai(e){ts.push(e)}function xe(e){Ci.push(e)}const ci=new Set;let xn=0;function ti(){if(xn!==0)return;const e=Os;do{try{for(;xn<$n.length;){const t=$n[xn];xn++,Fs(t),ca(t.$$)}}catch(t){throw $n.length=0,xn=0,t}for(Fs(null),$n.length=0,xn=0;be.length;)be.pop()();for(let t=0;t<ts.length;t+=1){const n=ts[t];ci.has(n)||(ci.add(n),n())}ts.length=0}while($n.length);for(;Ci.length;)Ci.pop()();vi=!1,ci.clear(),Fs(e)}function ca(e){if(e.fragment!==null){e.update(),ut(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Ai)}}function ha(e){const t=[],n=[];ts.forEach(s=>e.indexOf(s)===-1?t.push(s):n.push(s)),n.forEach(s=>s()),ts=t}const Gs=new Set;let Un;function _s(){Un={r:0,c:[],p:Un}}function bs(){Un.r||ut(Un.c),Un=Un.p}function ye(e,t){e&&e.i&&(Gs.delete(e),e.i(t))}function ke(e,t,n,s){if(e&&e.o){if(Gs.has(e))return;Gs.add(e),Un.c.push(()=>{Gs.delete(e),s&&(n&&e.d(1),s())}),e.o(t)}else s&&s()}function Yt(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function $l(e,t){e.d(1),t.delete(e.key)}function fa(e,t){ke(e,1,1,()=>{t.delete(e.key)})}function Ki(e,t,n,s,i,l,r,d,o,c,f,g){let p=e.length,S=l.length,C=p;const w={};for(;C--;)w[e[C].key]=C;const k=[],_=new Map,b=new Map,v=[];for(C=S;C--;){const N=g(i,l,C),T=n(N);let R=r.get(T);R?v.push(()=>R.p(N,t)):(R=c(T,N),R.c()),_.set(T,k[C]=R),T in w&&b.set(T,Math.abs(C-w[T]))}const O=new Set,H=new Set;function I(N){ye(N,1),N.m(d,f),r.set(N.key,N),f=N.first,S--}for(;p&&S;){const N=k[S-1],T=e[p-1],R=N.key,U=T.key;N===T?(f=N.first,p--,S--):_.has(U)?!r.has(R)||O.has(R)?I(N):H.has(U)?p--:b.get(R)>b.get(U)?(H.add(R),I(N)):(O.add(U),p--):(o(T,r),p--)}for(;p--;){const N=e[p];_.has(N.key)||o(N,r)}for(;S;)I(k[S-1]);return ut(v),k}function $e(e,t,n){const s=e.$$.props[t];s!==void 0&&(e.$$.bound[s]=n,n(e.$$.ctx[s]))}function je(e){e&&e.c()}function Ue(e,t,n){const{fragment:s,after_update:i}=e.$$;s&&s.m(t,n),Ai(()=>{const l=e.$$.on_mount.map(Zl).filter(Vs);e.$$.on_destroy?e.$$.on_destroy.push(...l):ut(l),e.$$.on_mount=[]}),i.forEach(Ai)}function He(e,t){const n=e.$$;n.fragment!==null&&(ha(n.after_update),ut(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ma(e,t){e.$$.dirty[0]===-1&&($n.push(e),da(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Jt(e,t,n,s,i,l,r=null,d=[-1]){const o=Os;Fs(e);const c=e.$$={fragment:null,ctx:[],props:l,update:Tt,not_equal:i,bound:rl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(o?o.$$.context:[])),callbacks:rl(),dirty:d,skip_bound:!1,root:t.target||o.$$.root};r&&r(c.root);let f=!1;if(c.ctx=n?n(e,t.props||{},(g,p,...S)=>{const C=S.length?S[0]:p;return c.ctx&&i(c.ctx[g],c.ctx[g]=C)&&(!c.skip_bound&&c.bound[g]&&c.bound[g](C),f&&ma(e,g)),p}):[],c.update(),f=!0,ut(c.before_update),c.fragment=s?s(c.ctx):!1,t.target){if(t.hydrate){const g=ra(t.target);c.fragment&&c.fragment.l(g),g.forEach(J)}else c.fragment&&c.fragment.c();t.intro&&ye(e.$$.fragment),Ue(e,t.target,t.anchor),ti()}Fs(o)}class Zt{constructor(){pe(this,"$$");pe(this,"$$set")}$destroy(){He(this,1),this.$destroy=Tt}$on(t,n){if(!Vs(n))return Tt;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(t){this.$$set&&!sa(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const pa="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(pa);const ga=e=>({}),al=e=>({});function _a(e){let t,n,s,i,l,r,d,o,c,f,g,p,S;const C=e[10].header,w=bi(C,e,e[9],al),k=e[10].default,_=bi(k,e,e[9],null);return{c(){t=h("dialog"),n=h("header"),w&&w.c(),s=y(),i=h("hr"),l=y(),r=h("div"),_&&_.c(),d=y(),o=h("footer"),c=h("button"),c.textContent="done",m(i,"class","svelte-139kryi"),m(n,"class","svelte-139kryi"),m(r,"class","svelte-139kryi"),m(c,"class","submit svelte-139kryi"),c.autofocus=!0,m(o,"class","svelte-139kryi"),m(t,"class",f=Rn(e[2]?"modal":"")+" svelte-139kryi"),Nt(t,"top",e[5]+"px"),Nt(t,"left",e[4]+"px")},m(b,v){Q(b,t,v),a(t,n),w&&w.m(n,null),a(n,s),a(n,i),a(t,l),a(t,r),_&&_.m(r,null),a(t,d),a(t,o),a(o,c),e[13](t),g=!0,c.focus(),p||(S=[M(n,"mousedown",e[11]),M(c,"click",e[12]),M(t,"close",e[14])],p=!0)},p(b,[v]){w&&w.p&&(!g||v&512)&&wi(w,C,b,b[9],g?yi(C,b[9],v,ga):Si(b[9]),al),_&&_.p&&(!g||v&512)&&wi(_,k,b,b[9],g?yi(k,b[9],v,null):Si(b[9]),null),(!g||v&4&&f!==(f=Rn(b[2]?"modal":"")+" svelte-139kryi"))&&m(t,"class",f),(!g||v&32)&&Nt(t,"top",b[5]+"px"),(!g||v&16)&&Nt(t,"left",b[4]+"px")},i(b){g||(ye(w,b),ye(_,b),g=!0)},o(b){ke(w,b),ke(_,b),g=!1},d(b){b&&J(t),w&&w.d(b),_&&_.d(b),e[13](null),p=!1,ut(S)}}}function ba(e,t,n){let{$$slots:s={},$$scope:i}=t,{show:l=!1}=t,{modal:r=!0}=t,{centerWhenOpen:d=!0}=t,{frontend:o}=t,c;const f=gs(),g=()=>f("submit");let p,S,C,w,k,_;b();function b(){n(4,k=window.innerWidth/2),n(5,_=window.innerHeight/2)}function v(T){p=T.clientX,S=T.clientY,C=k,w=_;let R=j=>{n(4,k=C+j.clientX-p),n(5,_=w+j.clientY-S)},U=()=>{document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",U)};document.addEventListener("mousemove",R),document.addEventListener("mouseup",U)}const O=T=>v(T),H=()=>{n(0,l=!1),g()};function I(T){be[T?"unshift":"push"](()=>{c=T,n(3,c)})}const N=()=>{r&&n(1,o.states.modalOpenCounter--,o),n(0,l=!1)};return e.$$set=T=>{"show"in T&&n(0,l=T.show),"modal"in T&&n(2,r=T.modal),"centerWhenOpen"in T&&n(8,d=T.centerWhenOpen),"frontend"in T&&n(1,o=T.frontend),"$$scope"in T&&n(9,i=T.$$scope)},e.$$.update=()=>{e.$$.dirty&271&&c&&l&&!c.open&&(d&&b(),r?(n(1,o.states.modalOpenCounter++,o),c.showModal()):c.show()),e.$$.dirty&9&&c&&!l&&c.open&&c.close()},[l,o,r,c,k,_,g,v,d,i,s,O,H,I,N]}class ys extends Zt{constructor(t){super(),Jt(this,t,ba,_a,Ft,{show:0,modal:2,centerWhenOpen:8,frontend:1})}}function ya(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function ki(e,t=!1){const n=ya(),s=`_${n}`;return Object.defineProperty(window,s,{value:i=>(t&&Reflect.deleteProperty(window,s),e==null?void 0:e(i)),writable:!1,configurable:!0}),n}async function wa(e,t={}){return new Promise((n,s)=>{const i=ki(r=>{n(r),Reflect.deleteProperty(window,`_${l}`)},!0),l=ki(r=>{s(r),Reflect.deleteProperty(window,`_${i}`)},!0);window.__TAURI_IPC__({cmd:e,callback:i,error:l,...t})})}function Sa(e,t="asset"){return window.__TAURI__.convertFileSrc(e,t)}async function se(e){return wa("tauri",e)}async function Ca(e){return se({__tauriModule:"Clipboard",message:{cmd:"writeText",data:e}})}async function va(){return se({__tauriModule:"Clipboard",message:{cmd:"readText",data:null}})}async function hi(e={}){return typeof e=="object"&&Object.freeze(e),se({__tauriModule:"Dialog",message:{cmd:"openDialog",options:e}})}async function ol(e={}){return typeof e=="object"&&Object.freeze(e),se({__tauriModule:"Dialog",message:{cmd:"saveDialog",options:e}})}async function er(e,t){return se({__tauriModule:"Event",message:{cmd:"unlisten",event:e,eventId:t}})}async function Aa(e,t,n){await se({__tauriModule:"Event",message:{cmd:"emit",event:e,windowLabel:t,payload:n}})}async function tr(e,t,n){return se({__tauriModule:"Event",message:{cmd:"listen",event:e,windowLabel:t,handler:ki(n)}}).then(s=>async()=>er(e,s))}async function ka(e,t,n){return tr(e,t,s=>{n(s),er(e,s.id).catch(()=>{})})}var zt;(function(e){e.WINDOW_RESIZED="tauri://resize",e.WINDOW_MOVED="tauri://move",e.WINDOW_CLOSE_REQUESTED="tauri://close-requested",e.WINDOW_CREATED="tauri://window-created",e.WINDOW_DESTROYED="tauri://destroyed",e.WINDOW_FOCUS="tauri://focus",e.WINDOW_BLUR="tauri://blur",e.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",e.WINDOW_THEME_CHANGED="tauri://theme-changed",e.WINDOW_FILE_DROP="tauri://file-drop",e.WINDOW_FILE_DROP_HOVER="tauri://file-drop-hover",e.WINDOW_FILE_DROP_CANCELLED="tauri://file-drop-cancelled",e.MENU="tauri://menu",e.CHECK_UPDATE="tauri://update",e.UPDATE_AVAILABLE="tauri://update-available",e.INSTALL_UPDATE="tauri://update-install",e.STATUS_UPDATE="tauri://update-status",e.DOWNLOAD_PROGRESS="tauri://update-download-progress"})(zt||(zt={}));var fs;(function(e){e[e.Audio=1]="Audio",e[e.Cache=2]="Cache",e[e.Config=3]="Config",e[e.Data=4]="Data",e[e.LocalData=5]="LocalData",e[e.Desktop=6]="Desktop",e[e.Document=7]="Document",e[e.Download=8]="Download",e[e.Executable=9]="Executable",e[e.Font=10]="Font",e[e.Home=11]="Home",e[e.Picture=12]="Picture",e[e.Public=13]="Public",e[e.Runtime=14]="Runtime",e[e.Template=15]="Template",e[e.Video=16]="Video",e[e.Resource=17]="Resource",e[e.App=18]="App",e[e.Log=19]="Log",e[e.Temp=20]="Temp",e[e.AppConfig=21]="AppConfig",e[e.AppData=22]="AppData",e[e.AppLocalData=23]="AppLocalData",e[e.AppCache=24]="AppCache",e[e.AppLog=25]="AppLog"})(fs||(fs={}));async function Ei(e,t={}){return se({__tauriModule:"Fs",message:{cmd:"readTextFile",path:e,options:t}})}async function nr(e,t,n){typeof n=="object"&&Object.freeze(n),typeof e=="object"&&Object.freeze(e);const s={path:"",contents:""};let i=n;return typeof e=="string"?s.path=e:(s.path=e.path,s.contents=e.contents),typeof t=="string"?s.contents=t??"":i=t,se({__tauriModule:"Fs",message:{cmd:"writeFile",path:s.path,contents:Array.from(new TextEncoder().encode(s.contents)),options:i}})}async function Ea(e,t={}){return se({__tauriModule:"Fs",message:{cmd:"createDir",path:e,options:t}})}async function sr(e,t={}){return se({__tauriModule:"Fs",message:{cmd:"exists",path:e,options:t}})}var ul;(function(e){e[e.JSON=1]="JSON",e[e.Text=2]="Text",e[e.Binary=3]="Binary"})(ul||(ul={}));function Xi(){return navigator.appVersion.includes("Win")}async function ir(){return se({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:fs.AppConfig}})}const Di=Xi()?"\\":"/";Xi();class Da{constructor(t,n){this.type="Logical",this.width=t,this.height=n}}class Fi{constructor(t,n){this.type="Physical",this.width=t,this.height=n}toLogical(t){return new Da(this.width/t,this.height/t)}}class Fa{constructor(t,n){this.type="Logical",this.x=t,this.y=n}}class Mi{constructor(t,n){this.type="Physical",this.x=t,this.y=n}toLogical(t){return new Fa(this.x/t,this.y/t)}}var Ti;(function(e){e[e.Critical=1]="Critical",e[e.Informational=2]="Informational"})(Ti||(Ti={}));function dl(){return window.__TAURI_METADATA__.__windows.map(e=>new Ps(e.label,{skip:!0}))}const cl=["tauri://created","tauri://error"];class Ma{constructor(t){this.label=t,this.listeners=Object.create(null)}async listen(t,n){return this._handleTauriEvent(t,n)?Promise.resolve(()=>{const s=this.listeners[t];s.splice(s.indexOf(n),1)}):tr(t,this.label,n)}async once(t,n){return this._handleTauriEvent(t,n)?Promise.resolve(()=>{const s=this.listeners[t];s.splice(s.indexOf(n),1)}):ka(t,this.label,n)}async emit(t,n){if(cl.includes(t)){for(const s of this.listeners[t]||[])s({event:t,id:-1,windowLabel:this.label,payload:n});return Promise.resolve()}return Aa(t,this.label,n)}_handleTauriEvent(t,n){return cl.includes(t)?(t in this.listeners?this.listeners[t].push(n):this.listeners[t]=[n],!0):!1}}class Ta extends Ma{async scaleFactor(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"scaleFactor"}}}})}async innerPosition(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"innerPosition"}}}}).then(({x:t,y:n})=>new Mi(t,n))}async outerPosition(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"outerPosition"}}}}).then(({x:t,y:n})=>new Mi(t,n))}async innerSize(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"innerSize"}}}}).then(({width:t,height:n})=>new Fi(t,n))}async outerSize(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"outerSize"}}}}).then(({width:t,height:n})=>new Fi(t,n))}async isFullscreen(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isFullscreen"}}}})}async isMinimized(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isMinimized"}}}})}async isMaximized(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isMaximized"}}}})}async isFocused(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isFocused"}}}})}async isDecorated(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isDecorated"}}}})}async isResizable(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isResizable"}}}})}async isMaximizable(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isMaximizable"}}}})}async isMinimizable(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isMinimizable"}}}})}async isClosable(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isClosable"}}}})}async isVisible(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isVisible"}}}})}async title(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"title"}}}})}async theme(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"theme"}}}})}async center(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"center"}}}})}async requestUserAttention(t){let n=null;return t&&(t===Ti.Critical?n={type:"Critical"}:n={type:"Informational"}),se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"requestUserAttention",payload:n}}}})}async setResizable(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setResizable",payload:t}}}})}async setMaximizable(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setMaximizable",payload:t}}}})}async setMinimizable(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setMinimizable",payload:t}}}})}async setClosable(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setClosable",payload:t}}}})}async setTitle(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setTitle",payload:t}}}})}async maximize(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"maximize"}}}})}async unmaximize(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"unmaximize"}}}})}async toggleMaximize(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"toggleMaximize"}}}})}async minimize(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"minimize"}}}})}async unminimize(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"unminimize"}}}})}async show(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"show"}}}})}async hide(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"hide"}}}})}async close(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"close"}}}})}async setDecorations(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setDecorations",payload:t}}}})}async setAlwaysOnTop(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setAlwaysOnTop",payload:t}}}})}async setContentProtected(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setContentProtected",payload:t}}}})}async setSize(t){if(!t||t.type!=="Logical"&&t.type!=="Physical")throw new Error("the `size` argument must be either a LogicalSize or a PhysicalSize instance");return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setSize",payload:{type:t.type,data:{width:t.width,height:t.height}}}}}})}async setMinSize(t){if(t&&t.type!=="Logical"&&t.type!=="Physical")throw new Error("the `size` argument must be either a LogicalSize or a PhysicalSize instance");return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setMinSize",payload:t?{type:t.type,data:{width:t.width,height:t.height}}:null}}}})}async setMaxSize(t){if(t&&t.type!=="Logical"&&t.type!=="Physical")throw new Error("the `size` argument must be either a LogicalSize or a PhysicalSize instance");return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setMaxSize",payload:t?{type:t.type,data:{width:t.width,height:t.height}}:null}}}})}async setPosition(t){if(!t||t.type!=="Logical"&&t.type!=="Physical")throw new Error("the `position` argument must be either a LogicalPosition or a PhysicalPosition instance");return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setPosition",payload:{type:t.type,data:{x:t.x,y:t.y}}}}}})}async setFullscreen(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setFullscreen",payload:t}}}})}async setFocus(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setFocus"}}}})}async setIcon(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setIcon",payload:{icon:typeof t=="string"?t:Array.from(t)}}}}})}async setSkipTaskbar(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setSkipTaskbar",payload:t}}}})}async setCursorGrab(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setCursorGrab",payload:t}}}})}async setCursorVisible(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setCursorVisible",payload:t}}}})}async setCursorIcon(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setCursorIcon",payload:t}}}})}async setCursorPosition(t){if(!t||t.type!=="Logical"&&t.type!=="Physical")throw new Error("the `position` argument must be either a LogicalPosition or a PhysicalPosition instance");return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setCursorPosition",payload:{type:t.type,data:{x:t.x,y:t.y}}}}}})}async setIgnoreCursorEvents(t){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setIgnoreCursorEvents",payload:t}}}})}async startDragging(){return se({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"startDragging"}}}})}async onResized(t){return this.listen(zt.WINDOW_RESIZED,n=>{n.payload=Ra(n.payload),t(n)})}async onMoved(t){return this.listen(zt.WINDOW_MOVED,n=>{n.payload=Pa(n.payload),t(n)})}async onCloseRequested(t){return this.listen(zt.WINDOW_CLOSE_REQUESTED,n=>{const s=new Oa(n);Promise.resolve(t(s)).then(()=>{if(!s.isPreventDefault())return this.close()})})}async onFocusChanged(t){const n=await this.listen(zt.WINDOW_FOCUS,i=>{t({...i,payload:!0})}),s=await this.listen(zt.WINDOW_BLUR,i=>{t({...i,payload:!1})});return()=>{n(),s()}}async onScaleChanged(t){return this.listen(zt.WINDOW_SCALE_FACTOR_CHANGED,t)}async onMenuClicked(t){return this.listen(zt.MENU,t)}async onFileDropEvent(t){const n=await this.listen(zt.WINDOW_FILE_DROP,l=>{t({...l,payload:{type:"drop",paths:l.payload}})}),s=await this.listen(zt.WINDOW_FILE_DROP_HOVER,l=>{t({...l,payload:{type:"hover",paths:l.payload}})}),i=await this.listen(zt.WINDOW_FILE_DROP_CANCELLED,l=>{t({...l,payload:{type:"cancel"}})});return()=>{n(),s(),i()}}async onThemeChanged(t){return this.listen(zt.WINDOW_THEME_CHANGED,t)}}class Oa{constructor(t){this._preventDefault=!1,this.event=t.event,this.windowLabel=t.windowLabel,this.id=t.id}preventDefault(){this._preventDefault=!0}isPreventDefault(){return this._preventDefault}}class Ps extends Ta{constructor(t,n={}){super(t),n!=null&&n.skip||se({__tauriModule:"Window",message:{cmd:"createWebview",data:{options:{label:t,...n}}}}).then(async()=>this.emit("tauri://created")).catch(async s=>this.emit("tauri://error",s))}static getByLabel(t){return dl().some(n=>n.label===t)?new Ps(t,{skip:!0}):null}static async getFocusedWindow(){for(const t of dl())if(await t.isFocused())return t;return null}}"__TAURI_METADATA__"in window?new Ps(window.__TAURI_METADATA__.__currentWindow.label,{skip:!0}):(console.warn(`Could not find "window.__TAURI_METADATA__". The "appWindow" value will reference the "main" window label.
Note that this is not an issue if running this frontend on a browser instead of a Tauri window.`),new Ps("main",{skip:!0}));function Pa(e){return new Mi(e.x,e.y)}function Ra(e){return new Fi(e.width,e.height)}Xi();async function La(){return se({__tauriModule:"Os",message:{cmd:"osType"}})}function Ve(e){if(!e)throw Error("assertion failed")}const Xt={OSType:await La(),pathSeparator:Di,ctrlKey:()=>Xt.OSType=="Darwin"?"Meta":"Control",getFilename(e){return e.split(Xt.pathSeparator).at(-1)},escapeRegexp(e){return e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")},splitPrintingWords(e){return e.split(/(\n)/u).flatMap(t=>t.split(new RegExp("(?<=[^\\u4E00-\\u9FFF])(?=[\\u4E00-\\u9FFF])|(?<= )|(?<=[\\u4E00-\\u9FFF])(?=[\\u0000-\\u00FF\\u4E00-\\u9FFF])","u")))},timeout(e,t){return Promise.race([t,new Promise((n,s)=>setTimeout(()=>s("timeout"),e))])}},hl={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ms(e){return e=Math.round(e),e<0?0:e>255?255:e}function lr(e){return e<0?0:e>1?1:e}function Wa(e){return e[e.length-1]==="%"?Ms(Number(e.slice(0,-1))/100*255):Ms(Number(e))}function Oi(e){return e[e.length-1]!=="%"?null:lr(Number(e.slice(0,-1))/100)}function Na(e){return Oi(e)??lr(Number(e))}function fi(e,t,n){return n<0?n+=1:n>1&&(n-=1),n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}function fl(e){return e<48?NaN:e<=57?e-48:e<97?NaN:e<=102?e-87:NaN}const Ba=new Set([" ","	",`
`,"\r",",","/"]);function Ia(e){return e.endsWith("deg")?Number(e.slice(0,-3)):e.endsWith("grad")?Number(e.slice(0,-4))*360/400:e.endsWith("rad")?Number(e.slice(0,-3))*360/(2*Math.PI):e.endsWith("turn")?Number(e.slice(0,-4))*360:Number(e)}function za(e){const t=e.trim().toLowerCase();if(t in hl)return hl[t].slice();if(t[0]==="#"){const i=t.length===4||t.length===5,l=t.length===7||t.length===9;if(!i&&!l)return null;const r=i?1:2,d=[0,0,0,255],o=t.length===5||t.length===9?4:3;for(let c=0;c<o;c++){const f=fl(t.charCodeAt(c*r+1));if(d[c]=16*f+(i?f:fl(t.charCodeAt(c*r+2))),Number.isNaN(d[c]))return null}return d[3]/=255,d}const n=t.indexOf("(");let s=t.indexOf(")");if(s===-1&&(s=t.length),n!==-1&&(s+1===t.length||s===t.length)){const i=t.substr(0,n),l=[];let r="";for(let C=n+1;C<s;C++)Ba.has(t[C])?r.length!==0&&(l.push(r),r=""):r+=t[C];r.length!==0&&l.push(r);const d=l.length===4?Na(l.pop()):1;if(l.length!==3)return null;let o,c,f,g,p,S;switch(i){case"rgba":case"rgb":return S=[...l.map(Wa),d],S.some(Number.isNaN)?null:S;case"hsla":case"hsl":return o=(Ia(l[0])%360+360)%360/360,Number.isNaN(o)||(c=Oi(l[1]),Number.isNaN(c)||c===null)||(f=Oi(l[2]),Number.isNaN(f)||f===null)?null:(p=f<=.5?f*(c+1):f+c-f*c,g=f*2-p,[Ms(fi(g,p,o+1/3)*255),Ms(fi(g,p,o)*255),Ms(fi(g,p,o-1/3)*255),d]);default:return null}}return null}var Ct=(e=>(e[e.BottomLeft=1]="BottomLeft",e[e.BottomCenter=2]="BottomCenter",e[e.BottomRight=3]="BottomRight",e[e.CenterLeft=4]="CenterLeft",e[e.Center=5]="Center",e[e.CenterRight=6]="CenterRight",e[e.TopLeft=7]="TopLeft",e[e.TopCenter=8]="TopCenter",e[e.TopRight=9]="TopRight",e))(Ct||{}),Yi=(e=>(e[e.KeepAll=0]="KeepAll",e[e.KeepDifferent=1]="KeepDifferent",e[e.UseLocalByName=2]="UseLocalByName",e[e.Overwrite=3]="Overwrite",e[e.UseOverrideForAll=4]="UseOverrideForAll",e))(Yi||{}),Ji=(e=>(e[e.SortedBefore=0]="SortedBefore",e[e.SortedAfter=1]="SortedAfter",e[e.Before=2]="Before",e[e.After=3]="After",e[e.Overwrite=4]="Overwrite",e[e.Custom=5]="Custom",e))(Ji||{}),Ls;const In=class In{constructor(t){pe(this,"font","");pe(this,"size",72);pe(this,"color","white");pe(this,"outlineColor","black");pe(this,"outline",1);pe(this,"shadow",0);pe(this,"styles",{bold:!1,italic:!1,underline:!1,strikethrough:!1});pe(this,"margin",{top:10,bottom:10,left:10,right:10});pe(this,"alignment",2);pe(this,"uniqueID");this.name=t,this.uniqueID=u(In,Ls),Bn(In,Ls)._++}clone(){return In.deserialize(this.toSerializable())}equals(t){return JSON.stringify(this.toSerializable())==JSON.stringify(t.toSerializable())}toSerializable(){return{name:this.name,color:this.color,outlineColor:this.outlineColor,outline:this.outline,shadow:this.shadow,styles:this.styles,font:this.font,size:this.size,margin:this.margin,alignment:this.alignment}}static deserialize(t){let n=new In(t.name);return t.font!==void 0&&(n.font=t.font),t.size!==void 0&&(n.size=t.size),t.color!==void 0&&(n.color=t.color),t.shadow!==void 0&&(n.shadow=t.shadow),t.outline!==void 0&&(n.outline=t.outline),t.styles!==void 0&&(n.styles=t.styles),t.outlineColor!==void 0&&(n.outlineColor=t.outlineColor),t.margin!==void 0&&(n.margin=t.margin),t.alignment!==void 0&&(n.alignment=t.alignment),n}};Ls=new WeakMap,ne(In,Ls,0);let On=In;var Ws;const es=class es{constructor(t,n,...s){pe(this,"texts",[]);pe(this,"gui");pe(this,"uniqueID");this.start=t,this.end=n,this.texts=s,this.uniqueID=u(es,Ws),Bn(es,Ws)._++}toSerializable(){return{start:this.start,end:this.end,texts:this.texts.map(t=>[t.style.name,t.text])}}static deserialize(t,n){return new es(t.start,t.end,...t.texts.map(s=>({style:n.styles.find(i=>i.name==s[0])??n.defaultStyle,text:s[1]})))}};Ws=new WeakMap,ne(es,Ws,0);let Ht=es;class Pn{constructor(t){pe(this,"defaultStyle");pe(this,"styles",[]);pe(this,"entries",[]);pe(this,"title","");pe(this,"language","");pe(this,"width",1920);pe(this,"height",1080);t?(this.defaultStyle=t.defaultStyle.clone(),this.styles=t.styles.map(n=>n.clone())):this.defaultStyle=new On("default")}merge(t,n){let s=new Map,i=o=>{if(s.has(o))return s.get(o);let c=this.styles.findIndex(g=>g.name==o.name),f=o.name==this.defaultStyle.name;if(c<0&&!f)return this.styles.push(o),s.set(o,o),o;switch(n.style??1){case 1:if(o.equals(f?this.defaultStyle:this.styles[c]))return f?s.set(o,this.defaultStyle):s.set(o,this.styles[c]),s.get(o);case 0:let g=o.clone();return g.name=Rs.getUniqueStyleName(this,o.name),this.styles.push(g),s.set(o,g),g;case 2:return f?s.set(o,this.defaultStyle):s.set(o,this.styles[c]),s.get(o);case 3:return this.styles.splice(c,1,o),s.set(o,o),o;case 4:return s.set(o,n.overrideStyle??this.defaultStyle),s.get(o);default:Ve(!1)}};if(n.importAllStyles)for(let o of t.styles)i(o);let l=n.position??3;l==4&&(this.entries=[]);let r,d=n.customPosition??0;switch(l){case 0:r=o=>{let c=this.entries.findIndex(f=>f.start>=o.start);this.entries.splice(c,0,o)};break;case 1:r=o=>{let c=this.entries.findLastIndex(f=>f.start<=o.start);this.entries.splice(c+1,0,o)};break;case 2:case 5:r=o=>{this.entries.splice(d,0,o),d++};break;case 3:case 4:r=o=>{this.entries.push(o)};break;default:Ve(!1)}for(let o of t.entries){r(o);for(let c of o.texts)c.style=i(c.style)}}shiftTimes(t){let n=t.modifySince??!1,s=t.offset??0,i=t.scale??1;if(s==0&&i==1)return!1;let l=t.selection??this.entries,r=new Set(l),d=Math.min(...l.map(o=>o.start));for(let o of this.entries)(r.has(o)||o.start>=d&&n)&&(o.start=Math.max(0,o.start*i+s),o.end=Math.max(0,o.end*i+s));return!0}toSerializable(){return{width:this.width,height:this.height,title:this.title,language:this.language,defaultStyle:this.defaultStyle.toSerializable(),styles:this.styles.map(t=>t.toSerializable()),entries:this.entries.map(t=>t.toSerializable())}}static deserialize(t){let n=new Pn;return n.width=t.width??1920,n.height=t.height??1080,n.title=t.title??"",n.language=t.language??"",n.defaultStyle=On.deserialize(t.defaultStyle),n.styles=t.styles.map(s=>On.deserialize(s)),n.entries=t.entries.map(s=>Ht.deserialize(s,n)).filter(s=>s.texts.length>0),n}}function qs(e){let t=za(e);return t?"&H"+((1-t[3])*255).toString(16).toUpperCase().padStart(2,"0")+t[2].toString(16).toUpperCase().padStart(2,"0")+t[1].toString(16).toUpperCase().padStart(2,"0")+t[0].toString(16).toUpperCase().padStart(2,"0"):"&H00FFFFFF"}const yn={JSON(e){return JSON.stringify(e.toSerializable())},SRT(e){let t="",n=1;for(let s of e.entries)t+=`${n}
${ft.formatTimestamp(s.start,3,",")} --> ${ft.formatTimestamp(s.end,3,",")}
${s.texts.map(i=>i.text).join(`
`)}

`,n+=1;return t},ASS(e){return yn.ASSHeader(e)+yn.ASSFragment(e)},ASSHeader(e){let t=`[Script Info]
ScriptType: v4.00+
YCbCr Matrix: None
PlayResX: ${e.width}
PlayResY: ${e.height}
LayoutResX: ${e.width}
LayoutResY: ${e.height}

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
`;for(let n of[e.defaultStyle,...e.styles])t+=`Style: ${n.name},${n.font==""?"Arial":""},${n.size},${qs(n.color)},${qs(n.color)},${qs(n.outlineColor)},${qs(n.outlineColor)},${n.styles.bold?"-1":"0"},${n.styles.italic?"-1":"0"},${n.styles.underline?"-1":"0"},${n.styles.strikethrough?"-1":"0"},100,100,0,0,1,1,0,${n.alignment},${n.margin.left},${n.margin.right},${Math.max(n.margin.top,n.margin.bottom)},1
`;return t+=`
[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
`,t},ASSFragment(e){let t="";for(let n of e.entries){let s=ft.formatTimestamp(n.start,2),i=ft.formatTimestamp(n.end,2);for(let l of n.texts)t+=`Dialogue: 0,${s},${i},${l.style.name},,0,0,0,,${l.text.replaceAll(`
`,"\\N")}
`}return t},plaintext(e){return e.entries.map(t=>t.texts.map(n=>n.text).join(`
`)).join(`
`)}},mi={JSON(e){try{return Pn.deserialize(JSON.parse(e))}catch{return null}},SRT(e){const t=/\n(\d+:\d+:\d+[,.]\d+)\s-->\s(\d+:\d+:\d+[,.]\d+)\n((.+\n)+)$/gm;let n=[...e.matchAll(t)];if(n.length==0)return null;let s=new Pn;for(let i of n){let l=ft.parseTimestamp(i[1]),r=ft.parseTimestamp(i[2]);l===null||r===null||s.entries.push(new Ht(l,r,{style:s.defaultStyle,text:i[3].trimEnd()}))}return s},ASSFragment(e){const t=/^Dialogue: \d+,([\d:.]+),([\d:.]+),(.+),,\d+,\d+,\d+,,(.+)$/gm;let n=[...e.matchAll(t)];if(n.length==0)return null;let s=new Pn,i=new Map;for(let l of n){let r=ft.parseTimestamp(l[1]),d=ft.parseTimestamp(l[2]);if(!(r===null||d===null)){if(!i.has(l[3])){let o=new On(l[3]);i.set(l[3],o),s.styles.push(o)}s.entries.push(new Ht(r,d,{style:i.get(l[3]),text:l[4].replaceAll("\\N",`
`).trimEnd()}))}}return s}},Rs={alignTimes:(e,t)=>{for(let n=0;n<e.entries.length-1;n++){let s=e.entries[n].start,i=e.entries[n].end;for(let l=n+1;l<e.entries.length;l++){let r=e.entries[l].start,d=e.entries[l].end;Math.abs(r-s)<=t&&(e.entries[l].start=s),Math.abs(d-i)<=t&&(e.entries[l].end=i)}}},replaceStyle:(e,t,n)=>{let s=!1;for(let i of e)for(let l of i.texts)l.style==t&&(l.style=n,s=!0);return s},makeTestSubtitles:()=>{let e=new Pn;for(let t=0;t<10;t++)e.entries.push(new Ht(t*5,t*5+5,{style:e.defaultStyle,text:`测试第${t}行
test line ${t}`}));return e},getUniqueStyleName:(e,t)=>{let n=1,s=t;for(;e.styles.find(i=>i.name==s)||s==e.defaultStyle.name;)s=t+`_${n}`,n++;return s}},ft={parseTimestamp:e=>{let n=/(\d+):(\d+):(\d+)[,.](\d+)/.exec(e);if(!n)return null;let s=parseInt(n[1]),i=parseInt(n[2]),l=parseFloat(n[3]+"."+n[4]),r=s*3600+i*60+l;return isNaN(r)?null:r},formatTimestamp:(e,t=3,n=".")=>{let s=Math.floor(e/3600).toString().padStart(2,"0"),i=Math.floor(e%3600/60).toString().padStart(2,"0"),l=Math.floor(e%60).toString().padStart(2,"0"),r=(e%1).toFixed(t).slice(2);return`${s}:${i}:${l}${n}${r}`},getTextLength:e=>[...e.matchAll(/[\w\u4E00-\u9FFF]/g)].length,normalizeNewlines:e=>e.replaceAll(`\r
`,`
`).replaceAll("\r",`
`)};var Ua=Object.defineProperty,Ot=(e,t)=>{for(var n in t)Ua(e,n,{get:t[n],enumerable:!0})},Ha={};Ot(Ha,{convertFileSrc:()=>Va,invoke:()=>Zi,transformCallback:()=>Xn});function ja(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function Xn(e,t=!1){let n=ja(),s=`_${n}`;return Object.defineProperty(window,s,{value:i=>(t&&Reflect.deleteProperty(window,s),e==null?void 0:e(i)),writable:!1,configurable:!0}),n}async function Zi(e,t={}){return new Promise((n,s)=>{let i=Xn(r=>{n(r),Reflect.deleteProperty(window,`_${l}`)},!0),l=Xn(r=>{s(r),Reflect.deleteProperty(window,`_${i}`)},!0);window.__TAURI_IPC__({cmd:e,callback:i,error:l,...t})})}function Va(e,t="asset"){return window.__TAURI__.convertFileSrc(e,t)}async function A(e){return Zi("tauri",e)}var qa={};Ot(qa,{TauriEvent:()=>ur,emit:()=>xi,listen:()=>ai,once:()=>dr});async function rr(e,t){return A({__tauriModule:"Event",message:{cmd:"unlisten",event:e,eventId:t}})}async function ar(e,t,n){await A({__tauriModule:"Event",message:{cmd:"emit",event:e,windowLabel:t,payload:n}})}async function Qi(e,t,n){return A({__tauriModule:"Event",message:{cmd:"listen",event:e,windowLabel:t,handler:Xn(n)}}).then(s=>async()=>rr(e,s))}async function or(e,t,n){return Qi(e,t,s=>{n(s),rr(e,s.id).catch(()=>{})})}var ur=(e=>(e.WINDOW_RESIZED="tauri://resize",e.WINDOW_MOVED="tauri://move",e.WINDOW_CLOSE_REQUESTED="tauri://close-requested",e.WINDOW_CREATED="tauri://window-created",e.WINDOW_DESTROYED="tauri://destroyed",e.WINDOW_FOCUS="tauri://focus",e.WINDOW_BLUR="tauri://blur",e.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",e.WINDOW_THEME_CHANGED="tauri://theme-changed",e.WINDOW_FILE_DROP="tauri://file-drop",e.WINDOW_FILE_DROP_HOVER="tauri://file-drop-hover",e.WINDOW_FILE_DROP_CANCELLED="tauri://file-drop-cancelled",e.MENU="tauri://menu",e.CHECK_UPDATE="tauri://update",e.UPDATE_AVAILABLE="tauri://update-available",e.INSTALL_UPDATE="tauri://update-install",e.STATUS_UPDATE="tauri://update-status",e.DOWNLOAD_PROGRESS="tauri://update-download-progress",e))(ur||{});async function ai(e,t){return Qi(e,null,t)}async function dr(e,t){return or(e,null,t)}async function xi(e,t){return ar(e,void 0,t)}var Ga={};Ot(Ga,{checkUpdate:()=>Xa,installUpdate:()=>Ka,onUpdaterEvent:()=>$i});async function $i(e){return ai("tauri://update-status",t=>{e(t==null?void 0:t.payload)})}async function Ka(){let e;function t(){e&&e(),e=void 0}return new Promise((n,s)=>{function i(l){if(l.error){t(),s(l.error);return}l.status==="DONE"&&(t(),n())}$i(i).then(l=>{e=l}).catch(l=>{throw t(),l}),xi("tauri://update-install").catch(l=>{throw t(),l})})}async function Xa(){let e;function t(){e&&e(),e=void 0}return new Promise((n,s)=>{function i(r){t(),n({manifest:r,shouldUpdate:!0})}function l(r){if(r.error){t(),s(r.error);return}r.status==="UPTODATE"&&(t(),n({shouldUpdate:!1}))}dr("tauri://update-available",r=>{i(r==null?void 0:r.payload)}).catch(r=>{throw t(),r}),$i(l).then(r=>{e=r}).catch(r=>{throw t(),r}),xi("tauri://update").catch(r=>{throw t(),r})})}var Ya={};Ot(Ya,{CloseRequestedEvent:()=>gr,LogicalPosition:()=>hr,LogicalSize:()=>cr,PhysicalPosition:()=>si,PhysicalSize:()=>ni,UserAttentionType:()=>fr,WebviewWindow:()=>ms,WebviewWindowHandle:()=>mr,WindowManager:()=>pr,appWindow:()=>Ri,availableMonitors:()=>xa,currentMonitor:()=>Za,getAll:()=>Pi,getCurrent:()=>Ja,primaryMonitor:()=>Qa});var cr=class{constructor(e,t){this.type="Logical",this.width=e,this.height=t}},ni=class{constructor(e,t){this.type="Physical",this.width=e,this.height=t}toLogical(e){return new cr(this.width/e,this.height/e)}},hr=class{constructor(e,t){this.type="Logical",this.x=e,this.y=t}},si=class{constructor(e,t){this.type="Physical",this.x=e,this.y=t}toLogical(e){return new hr(this.x/e,this.y/e)}},fr=(e=>(e[e.Critical=1]="Critical",e[e.Informational=2]="Informational",e))(fr||{});function Ja(){return new ms(window.__TAURI_METADATA__.__currentWindow.label,{skip:!0})}function Pi(){return window.__TAURI_METADATA__.__windows.map(e=>new ms(e.label,{skip:!0}))}var ml=["tauri://created","tauri://error"],mr=class{constructor(e){this.label=e,this.listeners=Object.create(null)}async listen(e,t){return this._handleTauriEvent(e,t)?Promise.resolve(()=>{let n=this.listeners[e];n.splice(n.indexOf(t),1)}):Qi(e,this.label,t)}async once(e,t){return this._handleTauriEvent(e,t)?Promise.resolve(()=>{let n=this.listeners[e];n.splice(n.indexOf(t),1)}):or(e,this.label,t)}async emit(e,t){if(ml.includes(e)){for(let n of this.listeners[e]||[])n({event:e,id:-1,windowLabel:this.label,payload:t});return Promise.resolve()}return ar(e,this.label,t)}_handleTauriEvent(e,t){return ml.includes(e)?(e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t],!0):!1}},pr=class extends mr{async scaleFactor(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"scaleFactor"}}}})}async innerPosition(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"innerPosition"}}}}).then(({x:e,y:t})=>new si(e,t))}async outerPosition(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"outerPosition"}}}}).then(({x:e,y:t})=>new si(e,t))}async innerSize(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"innerSize"}}}}).then(({width:e,height:t})=>new ni(e,t))}async outerSize(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"outerSize"}}}}).then(({width:e,height:t})=>new ni(e,t))}async isFullscreen(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isFullscreen"}}}})}async isMinimized(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isMinimized"}}}})}async isMaximized(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isMaximized"}}}})}async isFocused(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isFocused"}}}})}async isDecorated(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isDecorated"}}}})}async isResizable(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isResizable"}}}})}async isMaximizable(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isMaximizable"}}}})}async isMinimizable(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isMinimizable"}}}})}async isClosable(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isClosable"}}}})}async isVisible(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isVisible"}}}})}async title(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"title"}}}})}async theme(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"theme"}}}})}async center(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"center"}}}})}async requestUserAttention(e){let t=null;return e&&(e===1?t={type:"Critical"}:t={type:"Informational"}),A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"requestUserAttention",payload:t}}}})}async setResizable(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setResizable",payload:e}}}})}async setMaximizable(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setMaximizable",payload:e}}}})}async setMinimizable(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setMinimizable",payload:e}}}})}async setClosable(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setClosable",payload:e}}}})}async setTitle(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setTitle",payload:e}}}})}async maximize(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"maximize"}}}})}async unmaximize(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"unmaximize"}}}})}async toggleMaximize(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"toggleMaximize"}}}})}async minimize(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"minimize"}}}})}async unminimize(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"unminimize"}}}})}async show(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"show"}}}})}async hide(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"hide"}}}})}async close(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"close"}}}})}async setDecorations(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setDecorations",payload:e}}}})}async setAlwaysOnTop(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setAlwaysOnTop",payload:e}}}})}async setContentProtected(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setContentProtected",payload:e}}}})}async setSize(e){if(!e||e.type!=="Logical"&&e.type!=="Physical")throw new Error("the `size` argument must be either a LogicalSize or a PhysicalSize instance");return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setSize",payload:{type:e.type,data:{width:e.width,height:e.height}}}}}})}async setMinSize(e){if(e&&e.type!=="Logical"&&e.type!=="Physical")throw new Error("the `size` argument must be either a LogicalSize or a PhysicalSize instance");return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setMinSize",payload:e?{type:e.type,data:{width:e.width,height:e.height}}:null}}}})}async setMaxSize(e){if(e&&e.type!=="Logical"&&e.type!=="Physical")throw new Error("the `size` argument must be either a LogicalSize or a PhysicalSize instance");return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setMaxSize",payload:e?{type:e.type,data:{width:e.width,height:e.height}}:null}}}})}async setPosition(e){if(!e||e.type!=="Logical"&&e.type!=="Physical")throw new Error("the `position` argument must be either a LogicalPosition or a PhysicalPosition instance");return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setPosition",payload:{type:e.type,data:{x:e.x,y:e.y}}}}}})}async setFullscreen(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setFullscreen",payload:e}}}})}async setFocus(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setFocus"}}}})}async setIcon(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setIcon",payload:{icon:typeof e=="string"?e:Array.from(e)}}}}})}async setSkipTaskbar(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setSkipTaskbar",payload:e}}}})}async setCursorGrab(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setCursorGrab",payload:e}}}})}async setCursorVisible(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setCursorVisible",payload:e}}}})}async setCursorIcon(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setCursorIcon",payload:e}}}})}async setCursorPosition(e){if(!e||e.type!=="Logical"&&e.type!=="Physical")throw new Error("the `position` argument must be either a LogicalPosition or a PhysicalPosition instance");return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setCursorPosition",payload:{type:e.type,data:{x:e.x,y:e.y}}}}}})}async setIgnoreCursorEvents(e){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setIgnoreCursorEvents",payload:e}}}})}async startDragging(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"startDragging"}}}})}async onResized(e){return this.listen("tauri://resize",t=>{t.payload=br(t.payload),e(t)})}async onMoved(e){return this.listen("tauri://move",t=>{t.payload=_r(t.payload),e(t)})}async onCloseRequested(e){return this.listen("tauri://close-requested",t=>{let n=new gr(t);Promise.resolve(e(n)).then(()=>{if(!n.isPreventDefault())return this.close()})})}async onFocusChanged(e){let t=await this.listen("tauri://focus",s=>{e({...s,payload:!0})}),n=await this.listen("tauri://blur",s=>{e({...s,payload:!1})});return()=>{t(),n()}}async onScaleChanged(e){return this.listen("tauri://scale-change",e)}async onMenuClicked(e){return this.listen("tauri://menu",e)}async onFileDropEvent(e){let t=await this.listen("tauri://file-drop",i=>{e({...i,payload:{type:"drop",paths:i.payload}})}),n=await this.listen("tauri://file-drop-hover",i=>{e({...i,payload:{type:"hover",paths:i.payload}})}),s=await this.listen("tauri://file-drop-cancelled",i=>{e({...i,payload:{type:"cancel"}})});return()=>{t(),n(),s()}}async onThemeChanged(e){return this.listen("tauri://theme-changed",e)}},gr=class{constructor(e){this._preventDefault=!1,this.event=e.event,this.windowLabel=e.windowLabel,this.id=e.id}preventDefault(){this._preventDefault=!0}isPreventDefault(){return this._preventDefault}},ms=class extends pr{constructor(e,t={}){super(e),t!=null&&t.skip||A({__tauriModule:"Window",message:{cmd:"createWebview",data:{options:{label:e,...t}}}}).then(async()=>this.emit("tauri://created")).catch(async n=>this.emit("tauri://error",n))}static getByLabel(e){return Pi().some(t=>t.label===e)?new ms(e,{skip:!0}):null}static async getFocusedWindow(){for(let e of Pi())if(await e.isFocused())return e;return null}},Ri;"__TAURI_METADATA__"in window?Ri=new ms(window.__TAURI_METADATA__.__currentWindow.label,{skip:!0}):(console.warn(`Could not find "window.__TAURI_METADATA__". The "appWindow" value will reference the "main" window label.
Note that this is not an issue if running this frontend on a browser instead of a Tauri window.`),Ri=new ms("main",{skip:!0}));function el(e){return e===null?null:{name:e.name,scaleFactor:e.scaleFactor,position:_r(e.position),size:br(e.size)}}function _r(e){return new si(e.x,e.y)}function br(e){return new ni(e.width,e.height)}async function Za(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{cmd:{type:"currentMonitor"}}}}).then(el)}async function Qa(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{cmd:{type:"primaryMonitor"}}}}).then(el)}async function xa(){return A({__tauriModule:"Window",message:{cmd:"manage",data:{cmd:{type:"availableMonitors"}}}}).then(e=>e.map(el))}var $a={};Ot($a,{isPermissionGranted:()=>eo,requestPermission:()=>to,sendNotification:()=>no});async function eo(){return window.Notification.permission!=="default"?Promise.resolve(window.Notification.permission==="granted"):A({__tauriModule:"Notification",message:{cmd:"isNotificationPermissionGranted"}})}async function to(){return window.Notification.requestPermission()}function no(e){typeof e=="string"?new window.Notification(e):new window.Notification(e.title,e)}function tl(){return navigator.appVersion.includes("Win")}var so={};Ot(so,{EOL:()=>io,arch:()=>oo,locale:()=>co,platform:()=>lo,tempdir:()=>uo,type:()=>ao,version:()=>ro});var io=tl()?`\r
`:`
`;async function lo(){return A({__tauriModule:"Os",message:{cmd:"platform"}})}async function ro(){return A({__tauriModule:"Os",message:{cmd:"version"}})}async function ao(){return A({__tauriModule:"Os",message:{cmd:"osType"}})}async function oo(){return A({__tauriModule:"Os",message:{cmd:"arch"}})}async function uo(){return A({__tauriModule:"Os",message:{cmd:"tempdir"}})}async function co(){return A({__tauriModule:"Os",message:{cmd:"locale"}})}var ho={};Ot(ho,{BaseDirectory:()=>ii,Dir:()=>ii,copyFile:()=>yo,createDir:()=>_o,exists:()=>Co,readBinaryFile:()=>mo,readDir:()=>go,readTextFile:()=>fo,removeDir:()=>bo,removeFile:()=>wo,renameFile:()=>So,writeBinaryFile:()=>po,writeFile:()=>pl,writeTextFile:()=>pl});var ii=(e=>(e[e.Audio=1]="Audio",e[e.Cache=2]="Cache",e[e.Config=3]="Config",e[e.Data=4]="Data",e[e.LocalData=5]="LocalData",e[e.Desktop=6]="Desktop",e[e.Document=7]="Document",e[e.Download=8]="Download",e[e.Executable=9]="Executable",e[e.Font=10]="Font",e[e.Home=11]="Home",e[e.Picture=12]="Picture",e[e.Public=13]="Public",e[e.Runtime=14]="Runtime",e[e.Template=15]="Template",e[e.Video=16]="Video",e[e.Resource=17]="Resource",e[e.App=18]="App",e[e.Log=19]="Log",e[e.Temp=20]="Temp",e[e.AppConfig=21]="AppConfig",e[e.AppData=22]="AppData",e[e.AppLocalData=23]="AppLocalData",e[e.AppCache=24]="AppCache",e[e.AppLog=25]="AppLog",e))(ii||{});async function fo(e,t={}){return A({__tauriModule:"Fs",message:{cmd:"readTextFile",path:e,options:t}})}async function mo(e,t={}){let n=await A({__tauriModule:"Fs",message:{cmd:"readFile",path:e,options:t}});return Uint8Array.from(n)}async function pl(e,t,n){typeof n=="object"&&Object.freeze(n),typeof e=="object"&&Object.freeze(e);let s={path:"",contents:""},i=n;return typeof e=="string"?s.path=e:(s.path=e.path,s.contents=e.contents),typeof t=="string"?s.contents=t??"":i=t,A({__tauriModule:"Fs",message:{cmd:"writeFile",path:s.path,contents:Array.from(new TextEncoder().encode(s.contents)),options:i}})}async function po(e,t,n){typeof n=="object"&&Object.freeze(n),typeof e=="object"&&Object.freeze(e);let s={path:"",contents:[]},i=n;return typeof e=="string"?s.path=e:(s.path=e.path,s.contents=e.contents),t&&"dir"in t?i=t:typeof e=="string"&&(s.contents=t??[]),A({__tauriModule:"Fs",message:{cmd:"writeFile",path:s.path,contents:Array.from(s.contents instanceof ArrayBuffer?new Uint8Array(s.contents):s.contents),options:i}})}async function go(e,t={}){return A({__tauriModule:"Fs",message:{cmd:"readDir",path:e,options:t}})}async function _o(e,t={}){return A({__tauriModule:"Fs",message:{cmd:"createDir",path:e,options:t}})}async function bo(e,t={}){return A({__tauriModule:"Fs",message:{cmd:"removeDir",path:e,options:t}})}async function yo(e,t,n={}){return A({__tauriModule:"Fs",message:{cmd:"copyFile",source:e,destination:t,options:n}})}async function wo(e,t={}){return A({__tauriModule:"Fs",message:{cmd:"removeFile",path:e,options:t}})}async function So(e,t,n={}){return A({__tauriModule:"Fs",message:{cmd:"renameFile",oldPath:e,newPath:t,options:n}})}async function Co(e,t={}){return A({__tauriModule:"Fs",message:{cmd:"exists",path:e,options:t}})}var vo={};Ot(vo,{BaseDirectory:()=>ii,appCacheDir:()=>Do,appConfigDir:()=>yr,appDataDir:()=>ko,appDir:()=>Ao,appLocalDataDir:()=>Eo,appLogDir:()=>wr,audioDir:()=>Fo,basename:()=>eu,cacheDir:()=>Mo,configDir:()=>To,dataDir:()=>Oo,delimiter:()=>Yo,desktopDir:()=>Po,dirname:()=>xo,documentDir:()=>Ro,downloadDir:()=>Lo,executableDir:()=>Wo,extname:()=>$o,fontDir:()=>No,homeDir:()=>Bo,isAbsolute:()=>tu,join:()=>Qo,localDataDir:()=>Io,logDir:()=>Ko,normalize:()=>Zo,pictureDir:()=>zo,publicDir:()=>Uo,resolve:()=>Jo,resolveResource:()=>jo,resourceDir:()=>Ho,runtimeDir:()=>Vo,sep:()=>Xo,templateDir:()=>qo,videoDir:()=>Go});async function Ao(){return yr()}async function yr(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:21}})}async function ko(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:22}})}async function Eo(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:23}})}async function Do(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:24}})}async function Fo(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:1}})}async function Mo(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:2}})}async function To(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:3}})}async function Oo(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:4}})}async function Po(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:6}})}async function Ro(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:7}})}async function Lo(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:8}})}async function Wo(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:9}})}async function No(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:10}})}async function Bo(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:11}})}async function Io(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:5}})}async function zo(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:12}})}async function Uo(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:13}})}async function Ho(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:17}})}async function jo(e){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:e,directory:17}})}async function Vo(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:14}})}async function qo(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:15}})}async function Go(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:16}})}async function Ko(){return wr()}async function wr(){return A({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:25}})}var Xo=tl()?"\\":"/",Yo=tl()?";":":";async function Jo(...e){return A({__tauriModule:"Path",message:{cmd:"resolve",paths:e}})}async function Zo(e){return A({__tauriModule:"Path",message:{cmd:"normalize",path:e}})}async function Qo(...e){return A({__tauriModule:"Path",message:{cmd:"join",paths:e}})}async function xo(e){return A({__tauriModule:"Path",message:{cmd:"dirname",path:e}})}async function $o(e){return A({__tauriModule:"Path",message:{cmd:"extname",path:e}})}async function eu(e,t){return A({__tauriModule:"Path",message:{cmd:"basename",path:e,ext:t}})}async function tu(e){return A({__tauriModule:"Path",message:{cmd:"isAbsolute",path:e}})}var nu={};Ot(nu,{exit:()=>su,relaunch:()=>iu});async function su(e=0){return A({__tauriModule:"Process",message:{cmd:"exit",exitCode:e}})}async function iu(){return A({__tauriModule:"Process",message:{cmd:"relaunch"}})}var lu={};Ot(lu,{Child:()=>Sr,Command:()=>Cr,EventEmitter:()=>Ks,open:()=>au});async function ru(e,t,n=[],s){return typeof n=="object"&&Object.freeze(n),A({__tauriModule:"Shell",message:{cmd:"execute",program:t,args:n,options:s,onEventFn:Xn(e)}})}var Ks=class{constructor(){this.eventListeners=Object.create(null)}addListener(e,t){return this.on(e,t)}removeListener(e,t){return this.off(e,t)}on(e,t){return e in this.eventListeners?this.eventListeners[e].push(t):this.eventListeners[e]=[t],this}once(e,t){let n=(...s)=>{this.removeListener(e,n),t(...s)};return this.addListener(e,n)}off(e,t){return e in this.eventListeners&&(this.eventListeners[e]=this.eventListeners[e].filter(n=>n!==t)),this}removeAllListeners(e){return e?delete this.eventListeners[e]:this.eventListeners=Object.create(null),this}emit(e,...t){if(e in this.eventListeners){let n=this.eventListeners[e];for(let s of n)s(...t);return!0}return!1}listenerCount(e){return e in this.eventListeners?this.eventListeners[e].length:0}prependListener(e,t){return e in this.eventListeners?this.eventListeners[e].unshift(t):this.eventListeners[e]=[t],this}prependOnceListener(e,t){let n=(...s)=>{this.removeListener(e,n),t(...s)};return this.prependListener(e,n)}},Sr=class{constructor(e){this.pid=e}async write(e){return A({__tauriModule:"Shell",message:{cmd:"stdinWrite",pid:this.pid,buffer:typeof e=="string"?e:Array.from(e)}})}async kill(){return A({__tauriModule:"Shell",message:{cmd:"killChild",pid:this.pid}})}},Cr=class extends Ks{constructor(e,t=[],n){super(),this.stdout=new Ks,this.stderr=new Ks,this.program=e,this.args=typeof t=="string"?[t]:t,this.options=n??{}}static sidecar(e,t=[],n){let s=new Cr(e,t,n);return s.options.sidecar=!0,s}async spawn(){return ru(e=>{switch(e.event){case"Error":this.emit("error",e.payload);break;case"Terminated":this.emit("close",e.payload);break;case"Stdout":this.stdout.emit("data",e.payload);break;case"Stderr":this.stderr.emit("data",e.payload);break}},this.program,this.args,this.options).then(e=>new Sr(e))}async execute(){return new Promise((e,t)=>{this.on("error",t);let n=[],s=[];this.stdout.on("data",i=>{n.push(i)}),this.stderr.on("data",i=>{s.push(i)}),this.on("close",i=>{e({code:i.code,signal:i.signal,stdout:n.join(`
`),stderr:s.join(`
`)})}),this.spawn().catch(t)})}};async function au(e,t){return A({__tauriModule:"Shell",message:{cmd:"open",path:e,with:t}})}var ou={};Ot(ou,{getName:()=>du,getTauriVersion:()=>cu,getVersion:()=>uu,hide:()=>fu,show:()=>hu});async function uu(){return A({__tauriModule:"App",message:{cmd:"getAppVersion"}})}async function du(){return A({__tauriModule:"App",message:{cmd:"getAppName"}})}async function cu(){return A({__tauriModule:"App",message:{cmd:"getTauriVersion"}})}async function hu(){return A({__tauriModule:"App",message:{cmd:"show"}})}async function fu(){return A({__tauriModule:"App",message:{cmd:"hide"}})}var mu={};Ot(mu,{getMatches:()=>pu});async function pu(){return A({__tauriModule:"Cli",message:{cmd:"cliMatches"}})}var gu={};Ot(gu,{readText:()=>bu,writeText:()=>_u});async function _u(e){return A({__tauriModule:"Clipboard",message:{cmd:"writeText",data:e}})}async function bu(){return A({__tauriModule:"Clipboard",message:{cmd:"readText",data:null}})}var yu={};Ot(yu,{ask:()=>vu,confirm:()=>Au,message:()=>Cu,open:()=>wu,save:()=>Su});async function wu(e={}){return typeof e=="object"&&Object.freeze(e),A({__tauriModule:"Dialog",message:{cmd:"openDialog",options:e}})}async function Su(e={}){return typeof e=="object"&&Object.freeze(e),A({__tauriModule:"Dialog",message:{cmd:"saveDialog",options:e}})}async function Cu(e,t){var s,i;let n=typeof t=="string"?{title:t}:t;return A({__tauriModule:"Dialog",message:{cmd:"messageDialog",message:e.toString(),title:(s=n==null?void 0:n.title)==null?void 0:s.toString(),type:n==null?void 0:n.type,buttonLabel:(i=n==null?void 0:n.okLabel)==null?void 0:i.toString()}})}async function vu(e,t){var s,i,l;let n=typeof t=="string"?{title:t}:t;return A({__tauriModule:"Dialog",message:{cmd:"askDialog",message:e.toString(),title:(s=n==null?void 0:n.title)==null?void 0:s.toString(),type:n==null?void 0:n.type,buttonLabels:[((i=n==null?void 0:n.okLabel)==null?void 0:i.toString())??"Yes",((l=n==null?void 0:n.cancelLabel)==null?void 0:l.toString())??"No"]}})}async function Au(e,t){var s,i,l;let n=typeof t=="string"?{title:t}:t;return A({__tauriModule:"Dialog",message:{cmd:"confirmDialog",message:e.toString(),title:(s=n==null?void 0:n.title)==null?void 0:s.toString(),type:n==null?void 0:n.type,buttonLabels:[((i=n==null?void 0:n.okLabel)==null?void 0:i.toString())??"Ok",((l=n==null?void 0:n.cancelLabel)==null?void 0:l.toString())??"Cancel"]}})}var ku={};Ot(ku,{isRegistered:()=>Fu,register:()=>Eu,registerAll:()=>Du,unregister:()=>Mu,unregisterAll:()=>Tu});async function Eu(e,t){return A({__tauriModule:"GlobalShortcut",message:{cmd:"register",shortcut:e,handler:Xn(t)}})}async function Du(e,t){return A({__tauriModule:"GlobalShortcut",message:{cmd:"registerAll",shortcuts:e,handler:Xn(t)}})}async function Fu(e){return A({__tauriModule:"GlobalShortcut",message:{cmd:"isRegistered",shortcut:e}})}async function Mu(e){return A({__tauriModule:"GlobalShortcut",message:{cmd:"unregister",shortcut:e}})}async function Tu(){return A({__tauriModule:"GlobalShortcut",message:{cmd:"unregisterAll"}})}var Ou={};Ot(Ou,{Body:()=>ks,Client:()=>kr,Response:()=>Ar,ResponseType:()=>vr,fetch:()=>Ru,getClient:()=>Er});var vr=(e=>(e[e.JSON=1]="JSON",e[e.Text=2]="Text",e[e.Binary=3]="Binary",e))(vr||{});async function Pu(e){let t={},n=async(s,i)=>{if(i!==null){let l;typeof i=="string"?l=i:i instanceof Uint8Array||Array.isArray(i)?l=Array.from(i):i instanceof File?l={file:Array.from(new Uint8Array(await i.arrayBuffer())),mime:i.type,fileName:i.name}:typeof i.file=="string"?l={file:i.file,mime:i.mime,fileName:i.fileName}:l={file:Array.from(i.file),mime:i.mime,fileName:i.fileName},t[String(s)]=l}};if(e instanceof FormData)for(let[s,i]of e)await n(s,i);else for(let[s,i]of Object.entries(e))await n(s,i);return t}var ks=class{constructor(e,t){this.type=e,this.payload=t}static form(e){return new ks("Form",e)}static json(e){return new ks("Json",e)}static text(e){return new ks("Text",e)}static bytes(e){return new ks("Bytes",Array.from(e instanceof ArrayBuffer?new Uint8Array(e):e))}},Ar=class{constructor(e){this.url=e.url,this.status=e.status,this.ok=this.status>=200&&this.status<300,this.headers=e.headers,this.rawHeaders=e.rawHeaders,this.data=e.data}},kr=class{constructor(e){this.id=e}async drop(){return A({__tauriModule:"Http",message:{cmd:"dropClient",client:this.id}})}async request(e){var n;let t=!e.responseType||e.responseType===1;return t&&(e.responseType=2),((n=e.body)==null?void 0:n.type)==="Form"&&(e.body.payload=await Pu(e.body.payload)),A({__tauriModule:"Http",message:{cmd:"httpRequest",client:this.id,options:e}}).then(s=>{let i=new Ar(s);if(t){try{i.data=JSON.parse(i.data)}catch(l){if(i.ok&&i.data==="")i.data={};else if(i.ok)throw Error(`Failed to parse response \`${i.data}\` as JSON: ${l};
              try setting the \`responseType\` option to \`ResponseType.Text\` or \`ResponseType.Binary\` if the API does not return a JSON response.`)}return i}return i})}async get(e,t){return this.request({method:"GET",url:e,...t})}async post(e,t,n){return this.request({method:"POST",url:e,body:t,...n})}async put(e,t,n){return this.request({method:"PUT",url:e,body:t,...n})}async patch(e,t){return this.request({method:"PATCH",url:e,...t})}async delete(e,t){return this.request({method:"DELETE",url:e,...t})}};async function Er(e){return A({__tauriModule:"Http",message:{cmd:"createClient",options:e}}).then(t=>new kr(t))}var pi=null;async function Ru(e,t){return pi===null&&(pi=await Er()),pi.request({url:e,method:(t==null?void 0:t.method)??"GET",...t})}var Lu=Zi,Wu="plugin:context_menu|show_context_menu";async function Dr(e,t){let n=[],s=[...e.map(i=>({...i}))];for(let i=0;i<s.length;i++){let l=s[i].event;if(typeof l=="function"){let r=`${t}_context_menu_item_${i}`;n.push(await ai(r,d=>{let o={...d,payload:e[i].payload};l(o)})),s[i].event=r,s[i].payload=void 0}if(e[i].subitems){let r=await Dr(e[i].subitems,`${t}_${i}`);n.push(...r.unlisteners),s[i].subitems=r.processed}}return{unlisteners:n,processed:s}}async function oi(e){let{unlisteners:t,processed:n}=await Dr(e.items,"root"),s=await ai("menu-did-close",()=>{t.forEach(i=>i()),t.length=0,s()});Lu(Wu,{...e,items:n})}function Nu(e,t,n){return{x:t-e.actualBoundingBoxLeft,y:n-e.fontBoundingBoxDescent-e.fontBoundingBoxAscent,w:e.width,h:e.fontBoundingBoxDescent+e.fontBoundingBoxAscent,diffy:e.fontBoundingBoxAscent}}function Bu(e,t){let n=e.x+e.w>t.x&&t.x+t.w>e.x,s=e.y+e.h>t.y&&t.y+t.h>e.y;return n&&s}function gl(e){return e==Ct.BottomLeft||e==Ct.CenterLeft||e==Ct.TopLeft}function _l(e){return e==Ct.BottomCenter||e==Ct.Center||e==Ct.TopCenter}function bl(e){return e==Ct.BottomRight||e==Ct.CenterRight||e==Ct.TopRight}function yl(e){return e==Ct.TopLeft||e==Ct.TopCenter||e==Ct.TopRight}function wl(e){return e==Ct.CenterLeft||e==Ct.Center||e==Ct.CenterRight}function Iu(e){return e==Ct.BottomLeft||e==Ct.BottomCenter||e==Ct.BottomRight}var vn,it,on,An,Hn,kn,jn,un,fn,Gt,rn,Li,Fr,Mr,Tr;class zu{constructor(t,n,s){ne(this,rn);ne(this,vn);ne(this,it);ne(this,on);ne(this,An,!0);ne(this,Hn,[]);ne(this,kn,[]);ne(this,jn,0);ne(this,un,0);ne(this,fn,0);ne(this,Gt,1);this.width=t,this.height=n,z(this,on,s),z(this,vn,new OffscreenCanvas(t,n)),this.changeResolution();let i=u(this,vn).getContext("2d");if(!i)throw new Error("SubtitleRenderer: cannot create context for OffscreenCanvas");z(this,it,i),this.updateTimes()}get currentTime(){return u(this,jn)}changeSubtitles(t){z(this,on,t),this.changeResolution(),this.updateTimes()}changeResolution(t=this.width,n=this.height){u(this,vn).width=t,u(this,vn).height=n,this.width=t,this.height=n;let s=u(this,on).width/u(this,on).height;t/n<s?([Bn(this,un)._,Bn(this,fn)._]=[0,(n-t/s)/2],z(this,Gt,t/u(this,on).width)):([Bn(this,un)._,Bn(this,fn)._]=[(t-n*s)/2,0],z(this,Gt,n/u(this,on).height)),this.requireRerender()}requireRerender(){z(this,An,!0)}updateTimes(){z(this,kn,u(this,on).entries.map((t,n)=>({oldIndex:n,newIndex:-1,entry:t})).toSorted((t,n)=>t.entry.start-n.entry.start));for(let t=0;t<u(this,kn).length;t++)u(this,kn)[t].newIndex=t;Z(this,rn,Li).call(this),z(this,An,!0)}setTime(t){t!=this.currentTime&&(z(this,jn,t),Z(this,rn,Li).call(this),z(this,An,!0))}getCanvas(){return u(this,An)&&(Z(this,rn,Tr).call(this),z(this,An,!1)),u(this,vn)}}vn=new WeakMap,it=new WeakMap,on=new WeakMap,An=new WeakMap,Hn=new WeakMap,kn=new WeakMap,jn=new WeakMap,un=new WeakMap,fn=new WeakMap,Gt=new WeakMap,rn=new WeakSet,Li=function(){z(this,Hn,[]);for(let t=0;t<u(this,kn).length;t++){let n=u(this,kn)[t];if(n.entry.start>u(this,jn))break;n.entry.end>u(this,jn)&&u(this,Hn).push(n)}u(this,Hn).sort((t,n)=>t.oldIndex-n.oldIndex)},Fr=function(t){let n=0,s=0,i=1;return gl(t.alignment)&&(n=t.margin.left*u(this,Gt)+u(this,un)),_l(t.alignment)&&(n=this.width/2),bl(t.alignment)&&(n=this.width-(t.margin.right*u(this,Gt)+u(this,un))),yl(t.alignment)&&(s=t.margin.top*u(this,Gt)+u(this,fn)),wl(t.alignment)&&(s=this.height/2),Iu(t.alignment)&&(s=this.height-(t.margin.bottom*u(this,Gt)+u(this,fn)),i=-1),[n,s,i]},Mr=function(t,n){let s=Xt.splitPrintingWords(t),i=[],l="";for(let r of s){if(r==`
`){i.push(l),l="";continue}u(this,it).measureText(l+r).width<n?l+=r:(i.push(l),l=r)}return i.push(l),i},Tr=function(){let t=[];u(this,it).clearRect(0,0,this.width,this.height),u(this,it).strokeStyle="white",u(this,it).beginPath(),u(this,it).rect(u(this,un),u(this,fn),this.width-2*u(this,un),this.height-2*u(this,fn)),u(this,it).stroke();for(let n of u(this,Hn))for(let s of n.entry.texts){gl(s.style.alignment)&&(u(this,it).textAlign="left"),_l(s.style.alignment)&&(u(this,it).textAlign="center"),bl(s.style.alignment)&&(u(this,it).textAlign="right");let i=s.style.size,l=s.style.font,r=s.style.color,d=s.style.outlineColor,o=s.style.outline;isNaN(i)&&(i=48),isNaN(o)&&(o=0),l==""&&(l="sans-serif"),r==""&&(r="white"),d==""&&(d="black"),u(this,it).font=`${s.style.styles.bold?"bold ":""}${s.style.styles.italic?"italic ":""}${i*u(this,Gt)*3/4}px "${l}", sans-serif`,u(this,it).fillStyle=r;let c=this.width-u(this,un)*2-(s.style.margin.left+s.style.margin.right)*u(this,Gt),f=Z(this,rn,Mr).call(this,s.text,c),[g,p,S]=Z(this,rn,Fr).call(this,s.style);S<0&&f.reverse();for(let C of f){let w=u(this,it).measureText(C),[k,_]=[g,p],b=Nu(w,k,_),v=0;for(yl(s.style.alignment)&&(v=b.h),wl(s.style.alignment)&&(v=b.h*.5),b.y+=v;;){let O=t.find(H=>Bu(H,b));if(!O)break;S>0?b.y=Math.max(b.y+1,O.y+O.h):b.y=Math.min(b.y-1,O.y-O.h)}t.push(b),u(this,it).beginPath(),u(this,it).rect(b.x,b.y,b.w,b.h),u(this,it).strokeStyle="white",u(this,it).lineWidth=1,u(this,it).stroke(),o>0&&(u(this,it).strokeStyle=d,u(this,it).lineWidth=o*u(this,Gt)*3/4,u(this,it).strokeText(C,k,b.y+b.diffy)),u(this,it).fillText(C,k,b.y+b.diffy)}}};var gt,Vn,Ns,En,Kt,Dn,Bs,qn,Gn,ns,Is,Wi;class Uu{constructor(t){ne(this,Is);ne(this,gt);ne(this,Vn);ne(this,Ns);ne(this,En,!1);ne(this,Kt,!1);ne(this,Dn,0);ne(this,Bs,!1);ne(this,qn,1920);ne(this,Gn,1080);ne(this,ns);pe(this,"onPositionChange",()=>{});pe(this,"onPlayStateChange",()=>{});z(this,gt,document.createElement("video")),z(this,Vn,t)}get duration(){return u(this,gt).duration}get width(){return u(this,gt).videoWidth}get height(){return u(this,gt).videoHeight}get ratio(){return this.width/this.height}get currentPosition(){return u(this,Dn)}get isLoaded(){return u(this,En)}get isPlaying(){return u(this,Kt)}get source(){return u(this,Ns)}get subRenderer(){return u(this,ns)}setDisplaySize(t,n){var i;let s=window.devicePixelRatio;z(this,qn,Math.floor(t*s)),z(this,Gn,Math.floor(n*s)),(i=this.subRenderer)==null||i.changeResolution(u(this,qn),u(this,Gn)),this.requestRender()}setSubtitles(t){var n;this.subRenderer?(n=u(this,ns))==null||n.changeSubtitles(t):z(this,ns,new zu(u(this,qn),u(this,Gn),t)),this.requestRender()}async load(t){return new Promise((n,s)=>{let i=()=>{u(this,gt).removeEventListener("loadeddata",i),z(this,Kt,!1),z(this,En,!0),z(this,Ns,t),this.onPlayStateChange(),this.setPosition(0),n()},l=r=>{u(this,gt).removeEventListener("error",l),s("error loading video: "+r.message)};u(this,gt).addEventListener("loadeddata",i),u(this,gt).addEventListener("error",l),u(this,gt).src=t,u(this,gt).load()})}async setPosition(t){return t<0&&(t=0),t>this.duration&&(t=this.duration),new Promise(n=>{var i;let s=()=>{u(this,gt).removeEventListener("seeked",s),z(this,Dn,t),this.onPositionChange(),this.requestRender(),n()};if((i=this.subRenderer)==null||i.setTime(t),!u(this,En)){z(this,Dn,t),this.requestRender(),n();return}z(this,Kt,!1),u(this,gt).addEventListener("seeked",s),u(this,gt).currentTime=t})}requestRender(){u(this,Bs)||(u(this,Kt)?u(this,gt).requestVideoFrameCallback((t,n)=>Z(this,Is,Wi).call(this,n)):requestAnimationFrame(t=>Z(this,Is,Wi).call(this)))}play(t=!0){return new Promise((n,s)=>{u(this,gt).readyState<2?s("not ready"):!t&&u(this,Kt)?(u(this,gt).pause(),z(this,Kt,!1),this.onPlayStateChange(),n()):t&&!u(this,Kt)?u(this,gt).play().then(i=>{z(this,Kt,!0),this.onPlayStateChange(),this.requestRender(),n()}):n()})}}gt=new WeakMap,Vn=new WeakMap,Ns=new WeakMap,En=new WeakMap,Kt=new WeakMap,Dn=new WeakMap,Bs=new WeakMap,qn=new WeakMap,Gn=new WeakMap,ns=new WeakMap,Is=new WeakSet,Wi=function(t){var i;z(this,Bs,!1);let n=u(this,qn),s=u(this,Gn);if(u(this,Vn).clearRect(0,0,n,s),u(this,En)){let l,r,d=this.ratio;n/s<d?[l,r]=[n,n/d]:[l,r]=[s*d,s];let o=(n-l)/2,c=(s-r)/2;u(this,Vn).drawImage(u(this,gt),o,c,l,r),z(this,Dn,u(this,gt).currentTime),(i=this.subRenderer)==null||i.setTime(u(this,Dn)),this.onPositionChange()}this.subRenderer&&u(this,Vn).drawImage(this.subRenderer.getCanvas(),0,0),u(this,En)&&u(this,Kt)&&this.requestRender()};var lt,ss,mn,Fn,is,li,zs,pn,ls,dn;const zn=class zn{constructor(){ne(this,lt);ne(this,ss);ne(this,mn);ne(this,Fn);ne(this,is,0);ne(this,li,0);ne(this,zs,0);ne(this,pn,0);ne(this,ls,!1);ne(this,dn,!1);pe(this,"data",new Float32Array);pe(this,"detail",new Float32Array);z(this,lt,new Audio),z(this,ss,new AudioContext);let t=u(this,ss).createMediaElementSource(u(this,lt));z(this,mn,u(this,ss).createAnalyser()),u(this,mn).fftSize=2048,u(this,mn).smoothingTimeConstant=0,z(this,Fn,new Float32Array(u(this,mn).fftSize)),t.connect(u(this,mn))}get duration(){return u(this,lt).duration}get isSampling(){return u(this,dn)}get sampleStart(){return u(this,li)}get sampleEnd(){return u(this,zs)}get sampleProgress(){return u(this,pn)}static create(t){return new Promise((n,s)=>{let i=new zn,l=()=>{console.log("audio: loadeddata"),u(i,lt).removeEventListener("loadeddata",l),z(i,is,Math.round(u(i,lt).duration*this.RESOLUTION)),i.data=new Float32Array(u(i,is)),i.detail=new Float32Array(u(i,is)),n(i)},r=d=>{u(i,lt).removeEventListener("error",r),s("error loading video: "+d.message)};u(i,lt).addEventListener("loadeddata",l),u(i,lt).addEventListener("error",r),u(i,lt).src=t,u(i,lt).volume=1,u(i,lt).load()})}tryCancelSampling(){Ve(u(this,dn)),z(this,ls,!0)}extendSampling(t){Ve(u(this,dn)),t>u(this,lt).duration&&(t=u(this,lt).duration),Ve(u(this,pn)<t),Ve(this.sampleEnd<=t),z(this,zs,t)}startSampling(t,n,s){return Ve(!u(this,dn)),n>u(this,lt).duration&&(n=u(this,lt).duration),Ve(n>t),z(this,dn,!0),z(this,ls,!1),u(this,lt).playbackRate=s,u(this,lt).currentTime=t,console.log("starting sampling: ",t,n,"at",s),new Promise(i=>{let l=u(this,lt).currentTime,r=Math.ceil(t*zn.RESOLUTION),d=()=>{z(this,pn,u(this,lt).currentTime);let o=Math.floor(u(this,pn)*zn.RESOLUTION);if(u(this,ls)&&this.sampleProgress-t>.01){console.log("sucessfully cancelled"),z(this,dn,!1),u(this,lt).pause(),i();return}if(o>=n*zn.RESOLUTION){console.log("sampling done"),z(this,dn,!1),u(this,lt).pause(),i();return}if(u(this,pn)-l>0){u(this,mn).getFloatTimeDomainData(u(this,Fn));let c=0;for(let g=0;g<u(this,Fn).length;g++)c+=Math.pow(u(this,Fn)[g],2);c*=8/u(this,Fn).length;let f=o-r+1;for(let g=r;g<o;g++)if(this.detail[g]==0)this.data[g]=c,this.detail[g]=f;else{let p=f/(f+this.detail[g]);this.data[g]=this.data[g]*p+c*(1-p),this.detail[g]=this.detail[g]*p+f*(1-p)}l=u(this,pn),r=o}requestAnimationFrame(d)};u(this,lt).play().then(()=>requestAnimationFrame(d))})}};lt=new WeakMap,ss=new WeakMap,mn=new WeakMap,Fn=new WeakMap,is=new WeakMap,li=new WeakMap,zs=new WeakMap,pn=new WeakMap,ls=new WeakMap,dn=new WeakMap,pe(zn,"RESOLUTION",60);let Ut=zn;const Sl=15,an=30,Hu="hsl(0deg 0% 20%)",ju="white",Vu="hsl(0deg 0% 60%)",qu="hsl(0deg 0% 30%)",Gu="white",Ku=5,Xu=.1,Yu=100,Cl=40,Ju=1,Zu="hsl(0deg 0% 60%)",Qu="hsl(0deg 0% 40% / 60%)",xu="hsl(0deg 0% 80%)",$u="goldenrod",ed=4,td="pink",nd="hsl(0deg 0% 80% / 40%)",sd="hsl(0deg 0% 70%)",id=3,vs=10,vl=10,ld="hsl(0deg 0% 80%)",rd=3;function ad(e){const t=[.001,.01,.1,1,10,60,600,3600];for(let n=0;n<t.length-3;n++)if(e*t[n]>2)return[t[n],t[n+1]/t[n],t[n+2]/t[n]];return[60,600,3600]}let Es=-1;function od(e,t,n){const s="…",i=(d,o,c)=>{let f=0;for(;f<=d;){let g=Math.floor((f+d)/2);const p=c(g);if(p===o)return g;p<o?f=g+1:d=g-1}return d},l=e.measureText(t).width;if(Es<0&&(Es=e.measureText(s).width),l<=n||l<=Es)return t;const r=i(t.length,n-Es,d=>e.measureText(t.substring(0,d)).width);return t.substring(0,r)+s}var Ke,K,rs,as,Mn,ot,fe,De,gn,St,Lt,os,Us,sn,Xe,cn,ae,Xs,Ys,Ni,Js,Or,Pr,Rr,Zs,Lr,Wr,Nr,Br,Qs,Ds,xs,Ir,zr,Ur,Hr,jr;class ud{constructor(t,n){ne(this,ae);ne(this,Ke);ne(this,K);ne(this,rs,!1);ne(this,as,!1);ne(this,Mn,!1);ne(this,ot,null);ne(this,fe,1);ne(this,De,0);ne(this,gn,0);ne(this,St,100);ne(this,Lt,100);ne(this,os,0);ne(this,Us,new Map);ne(this,sn,null);ne(this,Xe,new Set);ne(this,cn,null);pe(this,"onPositionChange",t=>{});z(this,K,t),z(this,Ke,n),this.setViewScale(10),this.requestRender(),t.canvas.oncontextmenu=s=>s.preventDefault(),t.canvas.onmousemove=s=>Z(this,ae,Lr).call(this,s),t.canvas.onmousedown=s=>Z(this,ae,Wr).call(this,s),t.canvas.ondblclick=()=>Z(this,ae,Nr).call(this),t.canvas.onwheel=s=>Z(this,ae,Br).call(this,s),n.onSelectionChanged.bind(s=>{s!=Me.Timeline&&(z(this,Xe,new Set(u(this,Ke).getSelection())),u(this,Ke).current.entry&&Z(this,ae,Rr).call(this,u(this,Ke).current.entry),this.requestRender())}),n.onSubtitlesChanged.bind(s=>{(s==Ye.Styles||s==Ye.Both)&&Z(this,ae,Xs).call(this)}),n.onSubtitleObjectReload.bind(()=>{Z(this,ae,Xs).call(this)})}get viewScale(){return u(this,fe)}get viewOffset(){return u(this,De)}get cursorPos(){return u(this,gn)}setDisplaySize(t,n,s,i){z(this,St,s),z(this,Lt,i),Z(this,ae,Xs).call(this),this.setViewScale(u(this,fe)),this.requestRender()}async load(t){z(this,ot,await Ut.create(t)),z(this,fe,Math.max(u(this,St)/u(this,ot).duration,10)),z(this,De,0),z(this,gn,0),this.requestRender()}setViewOffset(t){t<0&&(t=0),t=Math.min(t,Z(this,ae,Ds).call(this)-u(this,St)/u(this,fe)),z(this,De,t),Z(this,ae,xs).call(this),this.requestRender(),z(this,Mn,!0)}setCursorPos(t,n=!1){t<0&&(t=0),t=Math.min(t,Z(this,ae,Ds).call(this)),z(this,gn,t),Z(this,ae,Zs).call(this,t),this.requestRender(),this.onPositionChange(n)}setViewScale(t){Ve(t>0),t=Math.max(t,u(this,St)/Z(this,ae,Ds).call(this)),t=Math.min(t,500),t!=u(this,fe)&&(z(this,fe,t),Z(this,ae,xs).call(this),this.requestRender(),z(this,Mn,!0))}requestRender(){u(this,as)||(z(this,as,!0),requestAnimationFrame(()=>Z(this,ae,jr).call(this)))}}Ke=new WeakMap,K=new WeakMap,rs=new WeakMap,as=new WeakMap,Mn=new WeakMap,ot=new WeakMap,fe=new WeakMap,De=new WeakMap,gn=new WeakMap,St=new WeakMap,Lt=new WeakMap,os=new WeakMap,Us=new WeakMap,sn=new WeakMap,Xe=new WeakMap,cn=new WeakMap,ae=new WeakSet,Xs=function(){const t=u(this,Ke).subs;z(this,os,(u(this,Lt)-an-Cl*2)/(t.styles.length+1)),z(this,Us,new Map([[t.defaultStyle,0],...t.styles.map((n,s)=>[n,s+1])]))},Ys=function(){const t=u(this,De)+u(this,St)/u(this,fe);return u(this,Ke).subs.entries.filter(n=>n.end>u(this,De)&&n.start<t)},Ni=function(t){const n=(t.end-t.start)*u(this,fe),s=(t.start-u(this,De))*u(this,fe);return t.texts.map(i=>{let l=u(this,Us).get(i.style)??0,r=u(this,os)*l+an+Cl;return{x:s,y:r,w:n,h:u(this,os),channel:i}})},Js=function(t,n,s=0,i=0){let l=[];const r=t/u(this,fe)+u(this,De),d=t+s/u(this,fe)+u(this,De);for(let o of u(this,Ke).subs.entries)o.end<r||o.start>d||Z(this,ae,Ni).call(this,o).some(c=>c.x<=t+s&&c.x+c.w>=t&&c.y<=n+i&&c.y+c.h>=n)&&l.push(o);return l},Or=function(t,n){let s=t.end-t.start,i=o=>{let c=Math.abs(n-o);c<l&&(r=o,d=o,l=c),c=Math.abs(n+s-o),c<l&&(r=o,d=o-s,l=c)},l=vl/u(this,fe),r=null,d=n;i(u(this,gn));for(let o of Z(this,ae,Ys).call(this))u(this,Xe).has(o)||(i(o.start),i(o.end));return z(this,cn,r!==null?(r-u(this,De))*u(this,fe):null),d},Pr=function(t,n,s){let i=s?o=>o<t.end:o=>o>t.start,l=o=>{if(!i(o))return;let c=Math.abs(n-o);c<r&&(d=o,r=c)},r=vl/u(this,fe),d=null;l(u(this,gn));for(let o of Z(this,ae,Ys).call(this))o!=t&&(l(o.start),l(o.end));return z(this,cn,d!==null?(d-u(this,De))*u(this,fe):null),d??n},Rr=function(t){const n=(t.end-t.start)*u(this,fe),s=(t.start-u(this,De))*u(this,fe),i=s,l=s+n-u(this,St);i>=0&&l<=0||(Math.abs(i)<Math.abs(l)?this.setViewOffset(u(this,De)+i/u(this,fe)):this.setViewOffset(u(this,De)+l/u(this,fe)))},Zs=function(t){let n=Yu/u(this,fe),s=u(this,De)+n,i=u(this,De)+u(this,St)/u(this,fe)-n;t<s&&this.setViewOffset(u(this,De)+t-s),t>i&&this.setViewOffset(u(this,De)+t-i)},Lr=function(t){const n=window.devicePixelRatio;if(u(this,K).canvas.style.cursor="default",t.offsetY*n<an){u(this,K).canvas.style.cursor="col-resize";return}const s=Z(this,ae,Js).call(this,t.offsetX*n,t.offsetY*n);if(s.length!=0)if((u(this,Xe).size>1||(Xt.ctrlKey()=="Meta"?t.metaKey:t.ctrlKey))&&s.some(i=>u(this,Xe).has(i)))u(this,K).canvas.style.cursor="move";else{let i=s.find(d=>u(this,Xe).has(d))??s[0];const l=(i.end-i.start)*u(this,fe),r=(i.start-u(this,De))*u(this,fe);t.offsetX*n-r<vs?u(this,K).canvas.style.cursor="e-resize":r+l-t.offsetX*n<vs&&(u(this,K).canvas.style.cursor="w-resize")}},Wr=function(t){t.preventDefault();let n=d=>{},s=d=>{};const i=window.devicePixelRatio,l=u(this,De)+t.offsetX/u(this,fe)*i;if(t.button==1){const d=u(this,fe);n=o=>{this.setViewScale(d/Math.pow(1.03,t.clientX-o.clientX)),this.setViewOffset(l-t.offsetX/u(this,fe)*i)}}else if(t.offsetY*i<an)n=d=>this.setCursorPos(u(this,De)+d.offsetX/u(this,fe)*i),n(t);else{let d=Z(this,ae,Js).call(this,t.offsetX*i,t.offsetY*i);if(d.length==0){(Xt.ctrlKey()=="Meta"?!t.metaKey:!t.ctrlKey)&&(u(this,Ke).clearSelection(Me.Timeline),u(this,Xe).clear(),this.requestRender()),z(this,sn,null);const o=[...u(this,Xe)];let c=[];n=f=>{let g=(l-u(this,De))*u(this,fe),p=f.offsetX*i,S=t.offsetY*i,C=f.offsetY*i,w={x:Math.min(g,p),y:Math.min(S,C),w:Math.abs(g-p),h:Math.abs(S-C)};z(this,sn,w);let k=Z(this,ae,Js).call(this,w.x,w.y,w.w,w.h);k.length!=c.length&&(z(this,Xe,new Set([...o,...k])),c=k,Z(this,ae,Qs).call(this)),Z(this,ae,Zs).call(this,p/u(this,fe)+u(this,De)),this.requestRender()},s=()=>{z(this,sn,null),this.requestRender()}}else if(t.button==2)d.some(o=>u(this,Xe).has(o))||(u(this,Ke).clearSelection(Me.Timeline),u(this,Ke).selectEntry(d[0],!1,!1,Me.Action)),s=()=>u(this,Ke).uiHelper.contextMenu();else{let o=()=>{};if(Xt.ctrlKey()=="Meta"?t.metaKey:t.ctrlKey)u(this,Xe).has(d[0])?o=()=>{console.log("afterup"),u(this,Xe).delete(d[0]),Z(this,ae,Qs).call(this),this.requestRender()}:(u(this,Xe).add(d[0]),Z(this,ae,Qs).call(this),this.requestRender());else{if(u(this,Xe).size>1)o=()=>{console.log("afterup"),u(this,Xe).clear(),u(this,Xe).add(d[0]),u(this,Ke).selectEntry(d[0],!1,!1,Me.Timeline)};else{let C=[...u(this,Xe)][0],w=(d.indexOf(C)+1)%d.length;u(this,Xe).clear(),u(this,Xe).add(d[w]),u(this,Ke).selectEntry(d[w],!1,!1,Me.Timeline)}this.requestRender()}const c=[...u(this,Xe)],f=Math.min(...c.map(C=>C.start)),g=Math.max(...c.map(C=>C.end)),p=l-f,S=g-l;if(console.log(p*u(this,fe),S*u(this,fe)),u(this,Xe).size>1||p*u(this,fe)>vs&&S*u(this,fe)>vs){const C=d.find(_=>u(this,Xe).has(_)),w=new Map(c.map(_=>[_,_.start]));let k=!1;n=_=>{const b=_.offsetX/u(this,fe)*i+u(this,De);let v=b-l;!_.altKey&&C&&(v=Z(this,ae,Or).call(this,C,w.get(C)+v)-w.get(C)),k=b!=l;for(let O of c){const H=O.end-O.start;O.start=w.get(O)+v,O.end=O.start+H}this.requestRender()},s=()=>{z(this,cn,null),this.requestRender(),k?u(this,Ke).markChanged(Ye.Times,Me.Timeline):o()}}else{const C=p*u(this,fe)<=vs,w=c[0],k=C?w.start:w.end;let _=!1;n=b=>{const v=b.offsetX/u(this,fe)*i+u(this,De);let O=k+v-l;b.altKey||(O=Z(this,ae,Pr).call(this,w,O,C)),C?w.start=Math.min(w.end,O):w.end=Math.max(w.start,O),_=O!=k,Z(this,ae,Zs).call(this,O),this.requestRender()},s=()=>{z(this,cn,null),this.requestRender(),_?u(this,Ke).markChanged(Ye.Times,Me.Timeline):o()}}}}let r=d=>{s(d),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",r)};window.addEventListener("mousemove",n),window.addEventListener("mouseup",r)},Nr=function(){if(u(this,Xe).size==1){let t=[...u(this,Xe)][0];u(this,Ke).current.entry==t&&u(this,Ke).focusOnCurrentEntry()}},Br=function(t){if(t.deltaX!=0)this.setViewOffset(u(this,De)+10*t.deltaX/u(this,fe));else if(t.deltaY%1!=0){const n=window.devicePixelRatio,s=u(this,De)+t.offsetX/u(this,fe)*n;this.setViewScale(u(this,fe)/Math.pow(1.03,t.deltaY)),this.setViewOffset(s-t.offsetX/u(this,fe)*n)}},Qs=function(){if(u(this,Ke).current.entry=null,u(this,Ke).selection.submitted=new Set(u(this,Xe)),u(this,Xe).size==1){let t=[...u(this,Xe).values()];u(this,Ke).selection.currentGroup=t,u(this,Ke).selection.currentStart=t[0],u(this,Ke).current.entry=t[0]}else u(this,Ke).selection.currentGroup=[],u(this,Ke).selection.currentStart=null;u(this,Ke).onSelectionChanged.dispatch(Me.Timeline)},Ds=function(){return u(this,ot)?u(this,ot).duration:Math.max(...u(this,Ke).subs.entries.map(t=>t.end))+20},xs=function(){if(!u(this,ot))return;let t=u(this,De),n=u(this,De)+u(this,St)/u(this,fe);const s=Math.min(Ku,(n-t)*Xu);if(u(this,ot).isSampling&&(u(this,ot).sampleProgress+s<u(this,De)||u(this,ot).sampleProgress>n+s?u(this,ot).tryCancelSampling():u(this,ot).sampleEnd<n+s&&u(this,ot).extendSampling(n+s)),u(this,ot).isSampling)return;const i=Math.floor(u(this,De)*Ut.RESOLUTION),l=Math.ceil(n*Ut.RESOLUTION),r=u(this,ot).detail.subarray(i,l),d=r.findIndex(f=>f==0),o=r.findIndex(f=>f>5);if(u(this,Ke).playback.isPlaying){if(d<0){o<0&&z(this,Mn,!1);return}t=(d+i)/Ut.RESOLUTION}else if(z(this,Mn,!1),d>=0)t=(d+i)/Ut.RESOLUTION;else if(o>=0)t=(o+i)/Ut.RESOLUTION;else return;if(n+=s,t<0&&(t=0),n>u(this,ot).duration&&(n=u(this,ot).duration),n<=t)return;z(this,rs,!0),u(this,ot).startSampling(t,n,Math.min(25,(n-u(this,De))/8)).then(()=>{z(this,rs,!1),this.requestRender()}),this.requestRender()},Ir=function(){if(!u(this,ot))return;u(this,Mn)&&Z(this,ae,xs).call(this);let t=Math.floor(u(this,De)*Ut.RESOLUTION),n=Math.ceil((u(this,De)+u(this,St)/u(this,fe))*Ut.RESOLUTION);t<0&&(t=0),n>=u(this,ot).data.length&&(n=u(this,ot).data.length-1);const s=1/Ut.RESOLUTION*u(this,fe),i=Math.max(1,Math.ceil(1/s)),l=Math.max(1,i*s);for(let r=t;r<n;r+=i){const d=u(this,ot).detail[r];if(d==0)continue;let o=u(this,ot).data[r]*u(this,Lt),c=(r-u(this,De)*Ut.RESOLUTION)*s;u(this,K).fillStyle="rgb(100 255 255)",u(this,K).fillRect(c,(u(this,Lt)-o)/2,l,Math.max(o,1)),u(this,K).fillStyle="rgb(100% 10% 10% / 30%)";let f=d/Ut.RESOLUTION*200;u(this,K).fillRect(c,u(this,Lt)-f,l,f)}},zr=function(){let t=(c,f)=>{u(this,K).beginPath(),u(this,K).moveTo(c,0),u(this,K).lineTo(c,f),u(this,K).stroke()};const[n,s,i]=ad(u(this,fe)),l=Math.floor(u(this,De)/n/i)*n*i,r=u(this,De)+u(this,St)/u(this,fe),d=Math.ceil((r-l)/n);u(this,K).fillStyle=Hu,u(this,K).fillRect(0,0,u(this,St),an),u(this,K).fillStyle=Gu,u(this,K).font="20px sans-serif",u(this,K).textBaseline="bottom",u(this,K).lineWidth=1;for(let c=0;c<d;c++){let f=l+c*n,g=Math.round((f-u(this,De))*u(this,fe)),p=5;c%i==0?(p=an,u(this,K).strokeStyle=Vu,t(g,u(this,Lt))):c%s==0?(p=an*.5,u(this,K).strokeStyle=qu,t(g,u(this,Lt))):p=an*.2,u(this,K).strokeStyle=ju,t(g,p)}for(let c=l;c<r;c+=i*n){const f=Math.round((c-u(this,De))*u(this,fe));u(this,K).fillText(ft.formatTimestamp(c,2),f+5,an)}const o=Z(this,ae,Ds).call(this);Math.abs(u(this,St)-u(this,fe)*o)<.001||(u(this,K).fillStyle="rgb(255 255 255 / 40%)",u(this,K).fillRect(u(this,St)*(u(this,De)/o),u(this,Lt)-Sl,u(this,St)*(u(this,St)/u(this,fe)/o),Sl))},Ur=function(){Es=-1,u(this,K).textBaseline="top";for(let t of Z(this,ae,Ys).call(this))Z(this,ae,Ni).call(this,t).forEach(n=>{u(this,K).fillStyle=Qu,u(this,Xe).has(t)?(u(this,K).strokeStyle=$u,u(this,K).lineWidth=ed):(u(this,K).strokeStyle=Zu,u(this,K).lineWidth=Ju),u(this,K).beginPath(),u(this,K).roundRect(n.x,n.y,n.w,n.h,4),u(this,K).fill(),u(this,K).stroke(),n.w>50&&(u(this,K).fillStyle=xu,u(this,K).fillText(od(u(this,K),n.channel.text,n.w-8),n.x+4,n.y+4))})},Hr=function(){let t=(u(this,gn)-u(this,De))*u(this,fe);u(this,sn)&&(u(this,K).fillStyle=nd,u(this,K).strokeStyle=sd,u(this,K).lineWidth=id,u(this,K).beginPath(),u(this,K).roundRect(u(this,sn).x,u(this,sn).y,u(this,sn).w,u(this,sn).h,2),u(this,K).fill(),u(this,K).stroke()),u(this,cn)&&(u(this,K).strokeStyle=ld,u(this,K).lineWidth=rd,u(this,K).beginPath(),u(this,K).moveTo(u(this,cn),an),u(this,K).lineTo(u(this,cn),u(this,Lt)),u(this,K).stroke()),u(this,K).fillStyle=td,u(this,K).beginPath(),u(this,K).moveTo(t+8,0),u(this,K).lineTo(t-8,0),u(this,K).lineTo(t-2,10),u(this,K).lineTo(t-2,u(this,Lt)),u(this,K).lineTo(t+2,u(this,Lt)),u(this,K).lineTo(t+2,10),u(this,K).lineTo(t+8,0),u(this,K).fill()},jr=function(){z(this,as,!1);const t=Date.now();u(this,K).fillStyle="black",u(this,K).fillRect(0,0,u(this,St),u(this,Lt)),Z(this,ae,zr).call(this),Z(this,ae,Ir).call(this),Z(this,ae,Ur).call(this),Z(this,ae,Hr).call(this),u(this,K).font="15px sans-serif",u(this,K).textBaseline="top",u(this,K).fillStyle="white",u(this,K).fillText(`offset=${u(this,De).toFixed(2)}`,10,30),u(this,K).fillText(`scale=${u(this,fe).toFixed(2)}`,10,50),u(this,K).fillText(`render time=${(Date.now()-t).toFixed(1)}`,100,30),u(this,rs)&&this.requestRender()};var Hs,Kn,_n,js,ri,Vr;class dd{constructor(t){ne(this,ri);ne(this,Hs,!1);ne(this,Kn,!1);ne(this,_n,0);ne(this,js,0);pe(this,"video",null);pe(this,"timeline",null);pe(this,"onRefreshPlaybackControl",()=>{});this.frontend=t,t.onSubtitlesChanged.bind((n,s)=>{var i;(i=this.video)!=null&&i.subRenderer&&(n&&this.video.subRenderer.updateTimes(),this.video.subRenderer.requireRerender())}),t.onSubtitleObjectReload.bind(()=>{var n;(n=this.video)==null||n.setSubtitles(t.subs)})}get position(){return u(this,_n)}get duration(){return u(this,js)}get isLoaded(){return u(this,Hs)}get isPlaying(){return u(this,Kn)}createVideo(t,n){return Ve(this.video==null),this.video=new Uu(t),this.video.setSubtitles(n),this.video.onPositionChange=()=>{Ve(this.video!=null),u(this,Kn)&&Z(this,ri,Vr).call(this,this.video.currentPosition),this.onRefreshPlaybackControl()},this.video.onPlayStateChange=()=>{Ve(this.video!=null),z(this,Kn,this.video.isPlaying),this.onRefreshPlaybackControl()},this.video}createTimeline(t,n){return Ve(this.timeline==null),this.timeline=new ud(t,n),this.timeline.onPositionChange=s=>{Ve(this.timeline!=null),!s&&(z(this,_n,this.timeline.cursorPos),this.video&&this.video.setPosition(u(this,_n)),this.onRefreshPlaybackControl())},this.timeline}async load(t){Ve(this.video!==null),Ve(this.timeline!==null),await Promise.allSettled([this.video.load(t),this.timeline.load(t)]),z(this,Hs,!0),z(this,js,this.video.duration),this.onRefreshPlaybackControl()}async setPosition(t){var n,s;this.video?(Ve(this.timeline!==null),await this.video.setPosition(t),z(this,_n,t),(s=this.timeline)==null||s.setCursorPos(t,!0)):(z(this,_n,t),(n=this.timeline)==null||n.setCursorPos(t,!0))}async play(t=!0){Ve(this.video!==null),await this.video.play(t)}async toggle(){await this.play(!u(this,Kn))}}Hs=new WeakMap,Kn=new WeakMap,_n=new WeakMap,js=new WeakMap,ri=new WeakSet,Vr=function(t){var n;z(this,_n,t),(n=this.timeline)==null||n.setCursorPos(t,!0),this.onRefreshPlaybackControl()};var nt,Bi,Ii,zi,qr,Ui,Gr,Kr,Hi,Xr,Yr;class cd{constructor(t){ne(this,nt);this.frontend=t}processGlobalKeydown(t){var r,d;let n=t.getModifierState(Xt.ctrlKey()),s=this.frontend.states.modalOpenCounter>0||((r=document.activeElement)==null?void 0:r.localName)=="input",i=!this.frontend.states.isEditing&&!s,l=(!this.frontend.states.isEditing||t.altKey)&&!s;if(t.key=="Enter"&&n&&(t.preventDefault(),this.frontend.insertEntryAfter(this.frontend.current.entry??void 0)),t.key=="Enter"&&i&&(t.preventDefault(),this.frontend.states.virtualEntryHighlighted?this.frontend.startEditingNewVirtualEntry():this.frontend.focusOnCurrentEntry()),t.key=="a"&&n&&i&&(Z(this,nt,Ii).call(this),t.preventDefault()),(t.key=="Delete"||t.key=="Backspace"&&n)&&i&&(this.frontend.deleteSelection(),t.preventDefault()),t.key=="c"&&n&&i&&(this.frontend.copySelection(),t.preventDefault()),t.key=="v"&&n&&i&&(this.frontend.paste(),t.preventDefault()),t.key=="x"&&n&&i&&(this.frontend.copySelection(),this.frontend.deleteSelection(),t.preventDefault()),t.key=="z"&&n&&i&&(t.preventDefault(),t.shiftKey?this.frontend.redo():this.frontend.undo()),t.key=="ArrowUp"&&n&&i&&(t.preventDefault(),Z(this,nt,Ui).call(this,this.frontend.getSelection(),-1)),t.key=="ArrowDown"&&n&&i&&(t.preventDefault(),Z(this,nt,Ui).call(this,this.frontend.getSelection(),1)),t.key=="s"&&n&&(t.preventDefault(),this.frontend.askSaveFile()),t.key=="f"&&n&&!s&&(t.preventDefault(),(d=this.frontend.dialogs.search)==null||d.$set({show:!0})),t.key=="ArrowUp"&&l&&!n&&(t.preventDefault(),this.frontend.offsetFocus(-1,t.shiftKey,n)),t.key=="ArrowDown"&&l&&!n&&(t.preventDefault(),this.frontend.offsetFocus(1,t.shiftKey,n)),t.code=="Space"&&l&&(this.frontend.playback.toggle(),t.preventDefault()),t.key=="ArrowLeft"&&l&&(this.frontend.playback.setPosition(this.frontend.playback.position-1),t.preventDefault()),t.key=="ArrowRight"&&l&&(this.frontend.playback.setPosition(this.frontend.playback.position+1),t.preventDefault()),t.key=="Enter"&&!t.shiftKey&&this.frontend.states.isEditing){t.preventDefault();let o=this.frontend.current.entry;if(!o)return;this.frontend.subs.entries.indexOf(o)+1==this.frontend.subs.entries.length?this.frontend.startEditingNewVirtualEntry():this.frontend.offsetFocus(1)}}contextMenu(){let t=this.frontend.getSelection();if(t.length==0)return;let n=this.frontend.isSelectionDisjunct(),s=[this.frontend.subs.defaultStyle,...this.frontend.subs.styles];oi({items:[{label:"copy",subitems:[{label:"JSON (internal)",shortcut:"cmd_or_ctrl+c",event:()=>this.frontend.copySelection()},{label:"SRT",event:()=>this.frontend.copySelection(yn.SRT)},{label:"ASS fragment",event:()=>this.frontend.copySelection(yn.ASSFragment)},{label:"plain text",event:()=>this.frontend.copySelection(yn.plaintext)}]},{label:"cut",shortcut:"cmd_or_ctrl+x",event:()=>{this.frontend.copySelection(),this.frontend.deleteSelection()}},{label:"paste",shortcut:"cmd_or_ctrl+v",event:()=>this.frontend.paste()},{is_separator:!0},{label:"delete",shortcut:"cmd_or_ctrl+backspace",event:()=>this.frontend.deleteSelection()},{is_separator:!0},{label:"select all",shortcut:"cmd_or_ctrl+a",event:()=>Z(this,nt,Ii).call(this)},{label:"select all by channel",subitems:s.map(i=>({label:i.name,event:()=>{this.frontend.selection.currentGroup=[],this.frontend.selection.currentStart=null,this.frontend.selection.submitted=new Set(this.frontend.subs.entries.filter(l=>l.texts.some(r=>r.style==i))),this.frontend.onSelectionChanged.dispatch(Me.Action)}}))},{is_separator:!0},{label:"insert before",event:()=>this.frontend.insertEntryBefore(t[0])},{label:"insert after",shortcut:"cmd_or_ctrl+enter",event:()=>this.frontend.insertEntryAfter(t[0])},{label:"split simultaneous",event:()=>Z(this,nt,Yr).call(this,t)},{label:"merge entries",disabled:n||t.length<=1,subitems:[{label:"connect all",event:()=>Z(this,nt,Hi).call(this,t,!0)},{label:"keep first only",event:()=>Z(this,nt,Hi).call(this,t,!1)}]},{is_separator:!0},{label:"utilities",subitems:[{label:"transform times...",event:()=>{if(!this.frontend.modalDialogs.timeTrans)return;let i=this.frontend.modalDialogs.timeTrans.$on("submit",l=>{this.frontend.subs.shiftTimes(l.detail)&&this.frontend.markChanged(Ye.Times,Me.Action),i()});this.frontend.modalDialogs.timeTrans.$set({show:!0})}},{is_separator:!0},{label:"sort by time",disabled:n||t.length<=1,event:()=>Z(this,nt,zi).call(this,t,!1)},{label:"sort by first style",disabled:n||t.length<=1,event:()=>Z(this,nt,zi).call(this,t,!0)},{label:"sort channels",event:()=>Z(this,nt,qr).call(this,t)},{is_separator:!0},{label:"create channel",subitems:s.map(i=>({label:i.name,event:()=>{let l=!1;for(let r of t)r.texts.find(d=>d.style==i)||(r.texts.push({style:i,text:""}),l=!0);l&&this.frontend.markChanged(Ye.NonTime,Me.Action)}}))},{label:"replace channel",disabled:this.frontend.subs.styles.length==0,subitems:s.map(i=>({label:i.name,subitems:[{label:"by:",disabled:!0},...s.filter(l=>l!=i).map(l=>({label:l.name,event:()=>{Rs.replaceStyle(t,i,l)&&this.frontend.markChanged(Ye.NonTime,Me.Action)}}))]}))},{label:"remove channel",disabled:this.frontend.subs.styles.length==0,subitems:this.frontend.subs.styles.map(i=>({label:i.name,event:()=>Z(this,nt,Bi).call(this,t,l=>l.style==i)}))},{label:"remove empty",event:()=>Z(this,nt,Bi).call(this,t,i=>i.text=="")},{is_separator:!0},{label:"combine overlapping duplicates",disabled:t.length<=1,event:()=>Z(this,nt,Kr).call(this,t)},{label:"combine by matching time...",disabled:t.length<=1,event:()=>{var i;return(i=this.frontend.modalDialogs.combine)==null?void 0:i.$set({show:!0})}},{label:"split by line",disabled:t.length<=1,event:()=>Z(this,nt,Xr).call(this,t)},{label:"split by language...",event:()=>{var i;return(i=this.frontend.modalDialogs.splitLanguages)==null?void 0:i.$set({show:!0})}},{label:"fix erroneous overlapping",event:()=>Z(this,nt,Gr).call(this,t)}]}]})}}nt=new WeakSet,Bi=function(t,n){console.log(t);let s=0,i=[];for(let l of t)l.texts.find(r=>n(r))&&(l.texts=l.texts.filter(r=>!n(r)),console.log(l.texts),l.texts.length>0?i.push(l):this.frontend.subs.entries.splice(this.frontend.subs.entries.indexOf(l),1),s++);s>0?(this.frontend.current.entry&&i.indexOf(this.frontend.current.entry)>=0&&this.frontend.current.entry,this.frontend.clearSelection(),this.frontend.selection.submitted=new Set(i),this.frontend.markChanged(Ye.NonTime,Me.Action),this.frontend.status=`changed ${s} entrie${s>1?"s":""}`):this.frontend.status="changed nothing"},Ii=function(){this.frontend.selection.currentStart=null,this.frontend.selection.currentGroup=[];for(let t of this.frontend.subs.entries)this.frontend.selection.submitted.add(t);this.frontend.onSelectionChanged.dispatch(Me.Action)},zi=function(t,n){if(t.length==0)return;let s=this.frontend.subs.entries.indexOf(t[0]);if(s<0)return;let i=new Map;for(let l=0;l<this.frontend.subs.entries.length;l++)i.set(this.frontend.subs.entries[l],l);n?t.sort((l,r)=>l.texts[0].style.name.localeCompare(r.texts[0].style.name)):t.sort((l,r)=>l.start-r.start),this.frontend.subs.entries.splice(s,t.length,...t),this.frontend.markChanged(Ye.NonTime,Me.Action)},qr=function(t){let n=new Map;n.set(this.frontend.subs.defaultStyle,0);for(let s=0;s<this.frontend.subs.styles.length;s++)n.set(this.frontend.subs.styles[s],s+1);for(let s of t)s.texts.sort((i,l)=>(n.get(i.style)??0)-(n.get(l.style)??0));this.frontend.markChanged(Ye.NonTime,Me.Action)},Ui=function(t,n){if(t.length==0||n==0)return;let s=this.frontend.subs.entries.indexOf(t[0]);s+n<0||s+n>this.frontend.subs.entries.length||(this.frontend.subs.entries.splice(s,t.length),this.frontend.subs.entries.splice(s+n,0,...t),this.frontend.markChanged(Ye.NonTime,Me.Action),setTimeout(()=>{this.frontend.keepEntryInView(n>0?t.at(-1):t[0])},0))},Gr=function(t,n=.05){let s=0;for(let i=0;i<t.length-1;i++){let l=t[i];for(let r=1;r<t.length;r++){let d=t[r];l.start<d.end&&d.end-l.start<n&&(l.start=d.end,s++),l.end>d.start&&l.end-d.start<n&&(l.end=d.start,s++)}}s>0?(this.frontend.markChanged(Ye.Times,Me.Action),this.frontend.status=`changed ${s} entrie${s>1?"s":""}`):this.frontend.status="changed nothing"},Kr=function(t){let n=new Set;for(let s=0;s<t.length;s++){let i=t[s];if(!(n.has(i)||i.texts.length>1))for(;;){for(let l=0;l<t.length;l++){if(s==l)continue;let r=t[l];if(!(n.has(r)||r.texts.length>1)&&r.texts[0].text==i.texts[0].text&&(Math.abs(r.start-i.end)<this.frontend.timeEpsilon||Math.abs(r.end-i.start)<this.frontend.timeEpsilon)){i.start=Math.min(i.start,r.start),i.end=Math.max(i.end,r.end),n.add(r);break}}break}}for(const s of n){let i=this.frontend.subs.entries.indexOf(s);Ve(i>0),this.frontend.subs.entries.splice(i,1)}this.frontend.markChanged(Ye.Times,Me.Action)},Hi=function(t,n){let s=t[0],i=s.start,l=s.end;for(let r=1;r<t.length;r++){if(n)for(const d of t[r].texts){const o=s.texts.findLast(c=>c.style.name==d.style.name);o?o.text+=" "+d.text:s.texts.push(d)}i=Math.min(i,t[r].start),l=Math.max(l,t[r].end)}s.start=i,s.end=l,this.frontend.subs.entries.splice(this.frontend.subs.entries.indexOf(s)+1,t.length-1),this.frontend.selectEntry(s),this.frontend.markChanged(Ye.Times,Me.Action)},Xr=function(t){for(const n of t){let s=[];for(const i of n.texts){let l=i.text.split(`
`);l.length>1?s.push(...l.map(r=>({style:i.style,text:r}))):s.push(i)}n.texts=s}this.frontend.markChanged(Ye.Times,Me.Action)},Yr=function(t){if(t.length==0)return;let n=[];for(let s=0;s<t.length;s++){let i=t[s],l=this.frontend.subs.entries.indexOf(i);n.push(i);for(let r=1;r<i.texts.length;r++){l++;let d=new Ht(i.start,i.end,i.texts[r]);this.frontend.subs.entries.splice(l,0,d),n.push(d)}i.texts=[i.texts[0]]}if(n.length!=t.length){this.frontend.clearSelection();for(let s of n)this.frontend.selection.submitted.add(s);this.frontend.markChanged(Ye.Times,Me.Action)}};const $s="config.json";let Rt={windowsW:1e3,windowsH:800,editorH:200,timelineH:150,maxRecent:10,paths:[]};async function gi(){const e=await ir();await sr(e)||Ea(e,{recursive:!0}),nr($s,JSON.stringify(Rt),{dir:fs.AppConfig}).catch(t=>{console.log("error saving config file:",t)})}const Cn={async init(){if(console.log(await ir(),$s),await sr($s,{dir:fs.AppConfig}))try{Rt=JSON.parse(await Ei($s,{dir:fs.AppConfig}))}catch{console.log("error reading config file")}},set(e,t){Rt[e]=t,gi()},get(e){return Rt[e]},pushRecent(e){const t=Rt.paths.findIndex(n=>n.name==e);for(t>=0?Rt.paths.unshift(...Rt.paths.splice(t,1)):Rt.paths.unshift({name:e});Rt.paths.length>Rt.maxRecent;)Rt.paths.pop();gi()},getVideo(e){var t;return(t=Rt.paths.find(n=>n.name==e))==null?void 0:t.video},rememberVideo(e,t){Ve(Rt.paths.length>0&&Rt.paths[0].name==e),Rt.paths[0].video=t,gi()}};var Me=(e=>(e[e.UIForm=0]="UIForm",e[e.UIList=1]="UIList",e[e.Action=2]="Action",e[e.Timeline=3]="Timeline",e))(Me||{}),Ye=(e=>(e[e.NonTime=0]="NonTime",e[e.Times=1]="Times",e[e.Styles=2]="Styles",e[e.Both=3]="Both",e))(Ye||{}),us;class As{constructor(){ne(this,us,new Set)}dispatch(...t){u(this,us).forEach(n=>n(...t))}bind(t){u(this,us).add(t)}unbind(t){u(this,us).delete(t)}}us=new WeakMap;const Al=[{name:"SRT subtitles",extensions:["srt"]},{name:"SSA subtitles",extensions:["ssa","ass"]},{name:"subtle archive",extensions:["json"]}];var bn,Ln,ji,Vi;class hd{constructor(){ne(this,Ln);pe(this,"subs");pe(this,"undoStack",[]);pe(this,"redoStack",[]);pe(this,"timeEpsilon",.01);pe(this,"ui",{});pe(this,"modalDialogs",{});pe(this,"dialogs",{});pe(this,"states",{isEditing:!1,isEditingVirtualEntry:!1,modalOpenCounter:0,virtualEntryHighlighted:!1,editChanged:!1});pe(this,"selection",{submitted:new Set,currentGroup:[],currentStart:null});pe(this,"current",{entry:null,style:null});pe(this,"currentFile","");pe(this,"fileChanged",!1);ne(this,bn,"ok");pe(this,"onUndoBufferChanged",new As);pe(this,"onStatusChanged",new As);pe(this,"onSubtitlesChanged",new As);pe(this,"onSubtitleObjectReload",new As);pe(this,"onSelectionChanged",new As);pe(this,"playback",new dd(this));pe(this,"uiHelper",new cd(this));this.subs=Rs.makeTestSubtitles(),this.markChanged(1,2),this.fileChanged=!1}get status(){return u(this,bn)}set status(t){z(this,bn,t),this.onStatusChanged.dispatch()}markChanged(t,n){this.fileChanged=!0,this.states.editChanged=!1,this.states.isEditingVirtualEntry=!1,this.undoStack.push({archive:JSON.stringify(this.subs.toSerializable()),change:t,saved:!this.fileChanged}),this.redoStack=[],this.onUndoBufferChanged.dispatch(),this.onSubtitlesChanged.dispatch(t,n)}canUndo(){return this.undoStack.length>1}canRedo(){return this.redoStack.length>0}getSelection(){return this.subs.entries.filter(t=>this.selection.submitted.has(t)||this.selection.currentGroup.includes(t))}isSelectionDisjunct(){let t=0;for(let n=0;n<this.subs.entries.length;n++){let s=this.subs.entries[n];if(this.selection.submitted.has(s)||this.selection.currentGroup.includes(s)){if(t==2)return!0;t=1}else t==1&&(t=2)}return!1}undo(){if(!this.canUndo())return!1;this.redoStack.push(this.undoStack.pop());let t=this.undoStack.at(-1);return Z(this,Ln,ji).call(this,t),this.onUndoBufferChanged.dispatch(),!0}redo(){if(!this.canRedo())return!1;this.undoStack.push(this.redoStack.pop());let t=this.undoStack.at(-1);return Z(this,Ln,ji).call(this,t),this.onUndoBufferChanged.dispatch(),!0}async askImportFile(){Ve(this.modalDialogs.importOpt!==void 0);const t=await hi({multiple:!1,filters:Al});if(typeof t!="string")return;const n=await Ei(t);let s=this.retrieveFromSource(n);if(!s){z(this,bn,`import failed for ${t}`);return}let i=this.modalDialogs.importOpt.$on("submit",l=>{Ve(s!==null),Z(this,Ln,Vi).call(this,s,l.detail),i()});this.modalDialogs.importOpt.$set({show:!0})}async askOpenFile(){const t=await hi({multiple:!1,filters:Al});typeof t=="string"&&await this.openDocument(t)}async askOpenVideo(){const t=await hi({multiple:!1,filters:[{name:"video file",extensions:["avi","mp4","webm","mkv"]}]});typeof t=="string"&&await this.openVideo(t)}async askSaveFile(t=!1){let n=this.currentFile;if(n==""||t){const i=await ol({filters:[{name:"subtle archive",extensions:["json"]}]});if(typeof i!="string")return;n=i}const s=JSON.stringify(this.subs.toSerializable());await this.saveTo(n,s)}async askExportFile(){let t=async(n,s)=>{const i=await ol({filters:[{name:"subtitle file",extensions:[n]}]});typeof i=="string"&&await this.saveTo(i,s(this.subs))};oi({items:[{label:"SRT",event:()=>t("srt",yn.SRT)},{label:"ASS",event:()=>t("ass",yn.ASS)},{label:"plain text",event:()=>t("txt",yn.plaintext)}]})}async openDocument(t){let n;try{const i=await Ei(t);if(n=this.retrieveFromSource(i),!n)throw"file is unparsable"}catch{this.status=`error when reading ${t}`;return}const s=Cn.getVideo(t);Cn.pushRecent(t),this.subs=n,this.current.entry=null,this.current.style=n.defaultStyle,this.currentFile=t,this.fileChanged=!1,this.status="opened: "+t,this.onSubtitleObjectReload.dispatch(),this.markChanged(3,2),s&&await this.openVideo(s)}async openVideo(t){const n=Sa(t);await this.playback.load(n).catch(s=>z(this,bn,s)).catch(s=>this.status="error opening video: "+s),this.currentFile!=""&&Cn.rememberVideo(this.currentFile,t)}async saveTo(t,n){var s;try{return await nr(t,n),this.status="saved to "+t,this.fileChanged=!1,t!=this.currentFile&&(Cn.pushRecent(t),(s=this.playback.video)!=null&&s.source&&Cn.rememberVideo(t,this.playback.video.source),this.currentFile=t),!0}catch(i){this.status=`error when saving to ${t}: ${i}`}return!1}retrieveFromSource(t){let n=mi.JSON(t);return n||(t=ft.normalizeNewlines(t),n=mi.SRT(t),n)||(n=mi.ASSFragment(t)),n}focusOnCurrentEntry(){if(!this.current.entry)return;let t=this.current.entry,n=t.texts.find(s=>s.style==this.current.style);n||(n=t.texts[0]),this.current.style=n.style,n.gui&&(this.status="focused on "+n.style.name+" of "+n.text,n.gui.focus(),n.gui.scrollIntoView())}keepEntryInView(t){if(!t.gui||!this.ui.subscontainer||!this.ui.tableHeader)return;t.gui.scrollIntoView({block:"nearest"});let n=this.ui.subscontainer.scrollTop+this.ui.tableHeader.offsetHeight;t.gui.offsetTop<n&&this.ui.subscontainer.scroll(0,t.gui.offsetTop-this.ui.tableHeader.offsetHeight)}insertEntryBefore(t){let n=t?this.subs.entries.indexOf(t):0;if(n<0)return;let s,i,l=this.playback.isLoaded?this.playback.position:1/0;if(this.subs.entries.length==0)s=0,i=2;else if(n==0){let d=this.subs.entries[0];s=Math.max(Math.min(l,d.start-2),0),i=Math.min(s+2,d.start)}else{Ve(t!==void 0);let d=this.subs.entries[n-1];d.end<=t.start?(s=Math.max(Math.min(l,t.start-2),d.end),i=Math.min(s+2,t.start)):(s=Math.max(Math.min(l,t.start-2),0),i=Math.min(s+2,t.start))}let r=t?new Ht(s,i,...t.texts.map(d=>({style:d.style,text:""}))):new Ht(s,i,{style:this.subs.defaultStyle,text:""});return this.subs.entries.splice(n,0,r),this.markChanged(1,2),setTimeout(()=>this.selectEntry(r),0),r}insertEntryAfter(t){let n=t?this.subs.entries.indexOf(t)+1:this.subs.entries.length;if(n<0)return;let s,i,l=this.playback.isLoaded?this.playback.position:1/0;if(n==this.subs.entries.length){let d=this.subs.entries.at(-1);s=Math.max(l,(d==null?void 0:d.end)??0),i=s+2}else{Ve(t!==void 0);let d=this.subs.entries[n];d.start>=t.end?(s=Math.max(Math.min(d.start,l),t.end),i=Math.min(s+2,d.start)):(s=t.end,i=s+2)}let r=t?new Ht(s,i,...t.texts.map(d=>({style:d.style,text:""}))):new Ht(s,i,{style:this.subs.defaultStyle,text:""});return this.subs.entries.splice(n,0,r),this.markChanged(1,2),setTimeout(()=>this.selectEntry(r),0),r}startEditingNewVirtualEntry(){z(this,bn,"new entry appended");let t=this.subs.entries.at(-1),n=t?new Ht(t.end,t.end+2,...t.texts.map(s=>({style:s.style,text:""}))):new Ht(0,2,{style:this.subs.defaultStyle,text:""});this.subs.entries.push(n),this.markChanged(1,2),this.clearSelection(),this.selectEntry(n),this.current.style=n.texts[0].style,setTimeout(()=>{this.keepEntryInView(n),this.focusOnCurrentEntry()},0),this.states.isEditingVirtualEntry=!0,this.states.virtualEntryHighlighted=!1}insertChannelAt(t){Ve(this.current.entry!==null);let n=this.current.entry,s={style:n.texts[t].style,text:""};n.texts=n.texts.toSpliced(t+1,0,s),this.markChanged(0,2),setTimeout(()=>{var i,l;(i=s.gui)==null||i.focus(),(l=s.gui)==null||l.scrollIntoView()},0)}deleteChannelAt(t){Ve(this.current.entry!==null);let n=this.current.entry;n.texts=n.texts.toSpliced(t,1),this.markChanged(0,2)}clearSelection(t=1){this.selection.submitted.clear(),this.selection.currentGroup=[],this.selection.currentStart=null,this.current.entry=null,this.onSelectionChanged.dispatch(t)}deleteSelection(t=1){let n=this.getSelection();if(n.length==0)return;let s=this.subs.entries.at(this.subs.entries.indexOf(n.at(-1))+1),i=this.subs.entries.filter(l=>!n.includes(l));this.subs.entries=i,this.clearSelection(),s?this.selectEntry(s):this.states.virtualEntryHighlighted=!0,this.markChanged(1,2),this.onSelectionChanged.dispatch(t)}copySelection(t=yn.JSON){let n=new Set([...this.selection.currentGroup,...this.selection.submitted]);if(n.size==0)return;let s=this.subs.entries.filter(l=>n.has(l)),i=new Pn(this.subs);i.entries=s,Ca(t(i)),this.status="copied"}async paste(){const t=await va();if(!t)return;let n=this.retrieveFromSource(t);if(!n){this.status="cannot read clipboard data as subtitles";return}let s;this.selection.submitted.size>0||this.selection.currentStart?(s=this.subs.entries.findIndex(i=>this.selection.submitted.has(i)||this.selection.currentGroup.includes(i)),this.clearSelection()):s=this.subs.entries.length,Z(this,Ln,Vi).call(this,n,{position:Ji.Custom,customPosition:s,style:Yi.KeepDifferent}),this.status="pasted"}offsetFocus(t,n=!1,s=!1){if(this.current.entry==null)return;let i=this.current.entry,l=this.subs.entries.indexOf(i)+t;if(l<0||l>=this.subs.entries.length){this.status="focusOffset out of range";return}this.selectEntry(this.subs.entries[l],n,s)}toggleEntry(t,n=!1,s=!1,i=1){if(s){if(this.current.entry==t&&(this.current.entry=null),this.selection.currentGroup.includes(t)){for(let l of this.selection.currentGroup)this.selection.submitted.add(l);this.selection.currentStart=null,this.selection.currentGroup=[]}if(this.selection.submitted.has(t)){this.selection.submitted.delete(t),this.states.isEditingVirtualEntry=!1,this.states.virtualEntryHighlighted=!1,z(this,bn,"multiselect removed item"),this.onSelectionChanged.dispatch(i);return}}this.selectEntry(t,n,s,i)}selectEntry(t,n=!1,s=!1,i=1){if(n)if(this.selection.currentStart==null)this.selection.currentStart=t,this.selection.currentGroup=[t];else{let l=this.subs.entries.indexOf(this.selection.currentStart),r=this.subs.entries.indexOf(t);Ve(l>=0&&r>=0),this.selection.currentGroup=this.subs.entries.slice(Math.min(l,r),Math.max(l,r)+1)}else if(s){for(let l of this.selection.currentGroup)this.selection.submitted.add(l);this.selection.currentStart=t,this.selection.currentGroup=[t]}else this.selection.submitted.clear(),this.selection.currentGroup=[t],this.selection.currentStart=t;this.current.entry!=t&&(this.states.isEditingVirtualEntry=!1,this.states.virtualEntryHighlighted=!1,this.current.entry=t,this.keepEntryInView(t),this.onSelectionChanged.dispatch(i))}}bn=new WeakMap,Ln=new WeakSet,ji=function(t){this.clearSelection(),this.current.entry=null,this.current.style=null,this.subs=Pn.deserialize(JSON.parse(t.archive)),this.fileChanged=!t.saved,this.onSubtitleObjectReload.dispatch(),this.onSubtitlesChanged.dispatch(t.change,2)},Vi=function(t,n){this.subs.merge(t,n);for(let s of t.entries)this.selection.submitted.add(s);this.markChanged(3,2)};function kl(e,t,n){const s=e.slice();return s[7]=t[n],s}function El(e){let t,n=e[7].name+"",s,i,l;return{c(){t=h("option"),s=Se(n),t.selected=i=e[0]==e[7],t.__value=l=e[7].name,V(t,t.__value)},m(r,d){Q(r,t,d),a(t,s)},p(r,d){d&2&&n!==(n=r[7].name+"")&&ht(s,n),d&3&&i!==(i=r[0]==r[7])&&(t.selected=i),d&2&&l!==(l=r[7].name)&&(t.__value=l,V(t,t.__value))},d(r){r&&J(t)}}}function Dl(e){let t,n=e[1].defaultStyle.name+"",s,i,l,r,d,o=Yt(e[1].styles),c=[];for(let f=0;f<o.length;f+=1)c[f]=El(kl(e,o,f));return{c(){t=h("option"),s=Se(n),i=y();for(let f=0;f<c.length;f+=1)c[f].c();d=hs(),t.selected=l=e[0]==e[1].defaultStyle,t.__value=r=`
        `+e[1].defaultStyle.name+`
    `,V(t,t.__value)},m(f,g){Q(f,t,g),a(t,s),a(t,i);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(f,g);Q(f,d,g)},p(f,g){if(g&2&&n!==(n=f[1].defaultStyle.name+"")&&ht(s,n),g&3&&l!==(l=f[0]==f[1].defaultStyle)&&(t.selected=l),g&2&&r!==(r=`
        `+f[1].defaultStyle.name+`
    `)&&(t.__value=r,V(t,t.__value)),g&3){o=Yt(f[1].styles);let p;for(p=0;p<o.length;p+=1){const S=kl(f,o,p);c[p]?c[p].p(S,g):(c[p]=El(S),c[p].c(),c[p].m(d.parentNode,d))}for(;p<c.length;p+=1)c[p].d(1);c.length=o.length}},d(f){f&&(J(t),J(d)),Gi(c,f)}}}function fd(e){let t,n=e[2],s,i,l=Dl(e);return{c(){t=h("select"),l.c(),m(t,"class","styleselect"),m(t,"tabindex","-1")},m(r,d){Q(r,t,d),l.m(t,null),s||(i=[M(t,"input",e[4]),M(t,"click",e[5])],s=!0)},p(r,[d]){d&4&&Ft(n,n=r[2])?(l.d(1),l=Dl(r),l.c(),l.m(t,null)):l.p(r,d)},i:Tt,o:Tt,d(r){r&&J(t),l.d(r),s=!1,ut(i)}}}function md(e,t,n){let{subtitles:s}=t,{currentStyle:i}=t,l=0;const r=gs(),d=()=>r("submit"),o=f=>{let g=f.currentTarget.selectedIndex;g<=0?n(0,i=s.defaultStyle):n(0,i=s.styles[g-1]),d()},c=()=>n(2,l++,l);return e.$$set=f=>{"subtitles"in f&&n(1,s=f.subtitles),"currentStyle"in f&&n(0,i=f.currentStyle)},[i,s,l,d,o,c]}class ps extends Zt{constructor(t){super(),Jt(this,t,md,fd,Ft,{subtitles:1,currentStyle:0})}get subtitles(){return this.$$.ctx[1]}set subtitles(t){this.$$set({subtitles:t}),ti()}get currentStyle(){return this.$$.ctx[0]}set currentStyle(t){this.$$set({currentStyle:t}),ti()}}function pd(e){let t,n,s,i,l,r,d,o,c,f,g,p,S,C,w,k,_,b,v,O,H,I,N,T,R,U,j,oe,$,B,F,me,ie,Be,E,P,x,q,W,G,ce,_e,Ce,ue,Pe,ve,Te,Y,le,Ie,X,Ee,Je,ee,he,Re,Ze,vt,We,mt,_t,rt,et,Oe,dt,ze,Pt,qe,Le,Mt,at,pt,ge,Ge,Qe,Ne,At;function wt(re){e[16](re)}let D={subtitles:e[0].subs};return e[5]!==void 0&&(D.currentStyle=e[5]),F=new ps({props:D}),e[15](F),be.push(()=>$e(F,"currentStyle",wt)),Ge=Ts(e[10][0]),Qe=Ts(e[10][1]),{c(){t=h("form"),n=h("table"),s=h("tr"),i=h("td"),i.textContent="styles",l=y(),r=h("td"),d=h("input"),o=y(),c=h("label"),c.textContent="import only different ones",f=h("br"),g=y(),p=h("input"),S=y(),C=h("label"),C.textContent="import all (even if identical to existing style)",w=h("br"),k=y(),_=h("input"),b=y(),v=h("label"),v.textContent="use local styles when names match",O=h("br"),H=y(),I=h("input"),N=y(),T=h("label"),T.textContent="overwrite local styles when names match",R=h("br"),U=y(),j=h("input"),oe=y(),$=h("label"),B=Se("use "),je(F.$$.fragment),ie=Se(" for all"),Be=h("br"),E=y(),P=h("tr"),x=h("td"),q=y(),W=h("td"),G=h("input"),ce=y(),_e=h("label"),_e.textContent="import unused styles as well",Ce=h("br"),ue=y(),Pe=h("tr"),ve=h("td"),ve.textContent="position",Te=y(),Y=h("td"),le=h("input"),Ie=y(),X=h("label"),X.textContent="after existing lines",Ee=h("br"),Je=y(),ee=h("input"),he=y(),Re=h("label"),Re.textContent="before existing lines",Ze=h("br"),vt=y(),We=h("input"),mt=y(),_t=h("label"),_t.textContent="sorted; before existing lines if time points are equal",rt=h("br"),et=y(),Oe=h("input"),dt=y(),ze=h("label"),ze.textContent="sorted; after existing lines if time points are equal",Pt=h("br"),qe=y(),Le=h("input"),Mt=y(),at=h("label"),at.textContent="overwrite current file",pt=h("br"),m(d,"type","radio"),m(d,"id","is1"),d.__value="KeepDifferent",V(d,d.__value),m(c,"for","is1"),m(p,"type","radio"),m(p,"id","is2"),p.__value="KeepAll",V(p,p.__value),m(C,"for","is2"),m(_,"type","radio"),m(_,"id","is3"),_.__value="UseLocalByName",V(_,_.__value),m(v,"for","is3"),m(I,"type","radio"),m(I,"id","is4"),I.__value="Overwrite",V(I,I.__value),m(T,"for","is4"),m(j,"type","radio"),m(j,"id","is5"),j.__value="UseOverrideForAll",V(j,j.__value),m($,"for","is5"),m(G,"type","checkbox"),m(G,"id","i6"),m(_e,"for","i6"),m(le,"type","radio"),m(le,"id","ib1"),le.__value="After",V(le,le.__value),m(X,"for","ib1"),m(ee,"type","radio"),m(ee,"id","ib2"),ee.__value="Before",V(ee,ee.__value),m(Re,"for","ib2"),m(We,"type","radio"),m(We,"id","ib3"),We.__value="SortedBefore",V(We,We.__value),m(_t,"for","ib3"),m(Oe,"type","radio"),m(Oe,"id","ib4"),Oe.__value="SortedAfter",V(Oe,Oe.__value),m(ze,"for","ib4"),m(Le,"type","radio"),m(Le,"id","ib5"),Le.__value="Overwrite",V(Le,Le.__value),m(at,"for","ib5"),m(n,"class","config"),Ge.p(le,ee,We,Oe,Le),Qe.p(d,p,_,I,j)},m(re,we){Q(re,t,we),a(t,n),a(n,s),a(s,i),a(s,l),a(s,r),a(r,d),d.checked=d.__value===e[6],a(r,o),a(r,c),a(r,f),a(r,g),a(r,p),p.checked=p.__value===e[6],a(r,S),a(r,C),a(r,w),a(r,k),a(r,_),_.checked=_.__value===e[6],a(r,b),a(r,v),a(r,O),a(r,H),a(r,I),I.checked=I.__value===e[6],a(r,N),a(r,T),a(r,R),a(r,U),a(r,j),j.checked=j.__value===e[6],a(r,oe),a(r,$),a($,B),Ue(F,$,null),a($,ie),a(r,Be),a(n,E),a(n,P),a(P,x),a(P,q),a(P,W),a(W,G),e[17](G),a(W,ce),a(W,_e),a(W,Ce),a(n,ue),a(n,Pe),a(Pe,ve),a(Pe,Te),a(Pe,Y),a(Y,le),le.checked=le.__value===e[7],a(Y,Ie),a(Y,X),a(Y,Ee),a(Y,Je),a(Y,ee),ee.checked=ee.__value===e[7],a(Y,he),a(Y,Re),a(Y,Ze),a(Y,vt),a(Y,We),We.checked=We.__value===e[7],a(Y,mt),a(Y,_t),a(Y,rt),a(Y,et),a(Y,Oe),Oe.checked=Oe.__value===e[7],a(Y,dt),a(Y,ze),a(Y,Pt),a(Y,qe),a(Y,Le),Le.checked=Le.__value===e[7],a(Y,Mt),a(Y,at),a(Y,pt),e[23](t),ge=!0,Ne||(At=[M(d,"change",e[9]),M(p,"change",e[11]),M(_,"change",e[12]),M(I,"change",e[13]),M(j,"change",e[14]),M(le,"change",e[18]),M(ee,"change",e[19]),M(We,"change",e[20]),M(Oe,"change",e[21]),M(Le,"change",e[22])],Ne=!0)},p(re,we){we&64&&(d.checked=d.__value===re[6]),we&64&&(p.checked=p.__value===re[6]),we&64&&(_.checked=_.__value===re[6]),we&64&&(I.checked=I.__value===re[6]),we&64&&(j.checked=j.__value===re[6]);const bt={};we&1&&(bt.subtitles=re[0].subs),!me&&we&32&&(me=!0,bt.currentStyle=re[5],xe(()=>me=!1)),F.$set(bt),we&128&&(le.checked=le.__value===re[7]),we&128&&(ee.checked=ee.__value===re[7]),we&128&&(We.checked=We.__value===re[7]),we&128&&(Oe.checked=Oe.__value===re[7]),we&128&&(Le.checked=Le.__value===re[7])},i(re){ge||(ye(F.$$.fragment,re),ge=!0)},o(re){ke(F.$$.fragment,re),ge=!1},d(re){re&&J(t),e[15](null),He(F),e[17](null),e[23](null),Ge.r(),Qe.r(),Ne=!1,ut(At)}}}function gd(e){let t,n,s,i;function l(o){e[24](o)}function r(o){e[25](o)}let d={$$slots:{default:[pd]},$$scope:{ctx:e}};return e[0]!==void 0&&(d.frontend=e[0]),e[1]!==void 0&&(d.show=e[1]),t=new ys({props:d}),be.push(()=>$e(t,"frontend",l)),be.push(()=>$e(t,"show",r)),t.$on("submit",e[26]),{c(){je(t.$$.fragment)},m(o,c){Ue(t,o,c),i=!0},p(o,[c]){const f={};c&268435709&&(f.$$scope={dirty:c,ctx:o}),!n&&c&1&&(n=!0,f.frontend=o[0],xe(()=>n=!1)),!s&&c&2&&(s=!0,f.show=o[1],xe(()=>s=!1)),t.$set(f)},i(o){i||(ye(t.$$.fragment,o),i=!0)},o(o){ke(t.$$.fragment,o),i=!1},d(o){He(t,o)}}}function _d(e,t,n){let{frontend:s}=t,{show:i=!1}=t,l,r,d,o=s.subs.defaultStyle,c="KeepDifferent",f="After";const g=gs(),p=F=>g("submit",F),S=[[],[]];function C(){c=this.__value,n(6,c)}function w(){c=this.__value,n(6,c)}function k(){c=this.__value,n(6,c)}function _(){c=this.__value,n(6,c)}function b(){c=this.__value,n(6,c)}function v(F){be[F?"unshift":"push"](()=>{r=F,n(3,r)})}function O(F){o=F,n(5,o)}function H(F){be[F?"unshift":"push"](()=>{d=F,n(4,d)})}function I(){f=this.__value,n(7,f)}function N(){f=this.__value,n(7,f)}function T(){f=this.__value,n(7,f)}function R(){f=this.__value,n(7,f)}function U(){f=this.__value,n(7,f)}function j(F){be[F?"unshift":"push"](()=>{l=F,n(2,l)})}function oe(F){s=F,n(0,s)}function $(F){i=F,n(1,i)}const B=()=>{p({style:Yi[c],overrideStyle:o,position:Ji[f],importAllStyles:d.checked})};return e.$$set=F=>{"frontend"in F&&n(0,s=F.frontend),"show"in F&&n(1,i=F.show)},[s,i,l,r,d,o,c,f,p,C,S,w,k,_,b,v,O,H,I,N,T,R,U,j,oe,$,B]}class bd extends Zt{constructor(t){super(),Jt(this,t,_d,gd,Ft,{frontend:0,show:1})}}function yd(e){let t,n,s,i,l,r,d,o,c,f,g,p,S,C,w,k,_,b,v,O,H,I,N,T,R,U,j,oe,$,B,F,me,ie,Be,E,P,x,q,W,G,ce,_e,Ce,ue,Pe,ve,Te,Y,le,Ie,X,Ee,Je,ee,he,Re,Ze,vt,We,mt,_t,rt,et,Oe,dt,ze,Pt,qe,Le,Mt,at,pt,ge,Ge,Qe,Ne,At,wt,D,re,we,bt,kt,jt,Vt,Wt,Qt,qt,Dt,Bt,Ae,st,wn,Wn,Sn,xt,ws,$t,yt,Ss,en,Nn,Yn,ct,tn,L,de,It,Jn,nn,Zn,Cs;return{c(){t=h("tr"),n=h("td"),s=h("button"),i=Se("+"),r=y(),d=h("br"),o=y(),c=h("button"),f=Se("↑"),p=y(),S=h("button"),C=Se("↓"),k=y(),_=h("button"),_.textContent="...",b=y(),v=h("td"),v.innerHTML='<label for="name">name:</label>',O=y(),H=h("td"),I=h("input"),T=y(),R=h("tr"),U=h("td"),U.innerHTML='<label for="font">font:</label>',j=y(),oe=h("td"),$=h("input"),B=y(),F=h("tr"),me=h("td"),me.innerHTML='<label for="size">font size:</label>',ie=y(),Be=h("td"),E=h("input"),P=y(),x=h("tr"),q=h("td"),W=y(),G=h("td"),ce=h("input"),_e=h("label"),_e.textContent="bold",Ce=y(),ue=h("input"),Pe=h("label"),Pe.textContent="italic",ve=y(),Te=h("input"),Y=h("label"),Y.textContent="underline",le=y(),Ie=h("input"),X=h("label"),X.textContent="strikethru",Ee=y(),Je=h("tr"),ee=h("td"),ee.innerHTML='<label for="color">text color:</label>',he=y(),Re=h("td"),Ze=h("input"),vt=y(),We=h("tr"),mt=h("td"),mt.innerHTML='<label for="ocolor">line color:</label>',_t=y(),rt=h("td"),et=h("input"),Oe=y(),dt=h("tr"),ze=h("td"),ze.innerHTML='<label for="outline">line size:</label>',Pt=y(),qe=h("td"),Le=h("input"),Mt=y(),at=h("tr"),pt=h("td"),pt.innerHTML='<label for="shadow">shadow:</label>',ge=y(),Ge=h("td"),Qe=h("input"),Ne=y(),At=h("tr"),wt=h("td"),wt.innerHTML='<label for="align">alignment:</label>',D=y(),re=h("td"),we=h("select"),bt=h("option"),bt.textContent="bottom left",kt=h("option"),kt.textContent="bottom center",jt=h("option"),jt.textContent="bottom right",Vt=h("option"),Vt.textContent="center left",Wt=h("option"),Wt.textContent="center",Qt=h("option"),Qt.textContent="center right",qt=h("option"),qt.textContent="top left",Dt=h("option"),Dt.textContent="top center",Bt=h("option"),Bt.textContent="top right",Ae=y(),st=h("tr"),wn=h("td"),wn.textContent="margins:",Wn=y(),Sn=h("td"),xt=h("table"),ws=h("tr"),ws.innerHTML="<td>top</td><td>bottom</td><td>left</td><td>right</td>",$t=y(),yt=h("tr"),Ss=h("td"),en=h("input"),Nn=y(),Yn=h("td"),ct=h("input"),tn=y(),L=h("td"),de=h("input"),It=y(),Jn=h("td"),nn=h("input"),s.disabled=l=e[0]==e[1].defaultStyle,m(s,"class","svelte-1vd74vs"),c.disabled=g=e[0]==e[1].defaultStyle||e[0]==e[1].styles[0],m(c,"class","svelte-1vd74vs"),S.disabled=w=e[0]==e[1].defaultStyle||e[0]==e[1].styles.at(-1),m(S,"class","svelte-1vd74vs"),m(_,"class","svelte-1vd74vs"),m(n,"class","toolbar svelte-1vd74vs"),m(n,"rowspan","10"),m(I,"id","name"),m(I,"class",N=Rn(e[6](e[0].name)?"duplicate":"")+" svelte-1vd74vs"),m($,"id","font"),m($,"class","svelte-1vd74vs"),m(E,"id","size"),m(E,"type","number"),m(E,"class","svelte-1vd74vs"),m(ce,"type","checkbox"),m(ce,"id","bold"),m(ce,"class","svelte-1vd74vs"),m(_e,"for","bold"),m(ue,"type","checkbox"),m(ue,"id","italic"),m(ue,"class","svelte-1vd74vs"),m(Pe,"for","italic"),m(Te,"type","checkbox"),m(Te,"id","underline"),m(Te,"class","svelte-1vd74vs"),m(Y,"for","underline"),m(Ie,"type","checkbox"),m(Ie,"id","strikethru"),m(Ie,"class","svelte-1vd74vs"),m(X,"for","strikethru"),m(Ze,"id","color"),m(Ze,"class","svelte-1vd74vs"),m(et,"id","ocolor"),m(et,"class","svelte-1vd74vs"),m(Le,"id","outline"),m(Le,"type","number"),m(Le,"class","svelte-1vd74vs"),m(Qe,"id","shadow"),m(Qe,"type","number"),m(Qe,"class","svelte-1vd74vs"),bt.__value="BottomLeft",V(bt,bt.__value),kt.__value="BottomCenter",V(kt,kt.__value),jt.__value="BottomRight",V(jt,jt.__value),Vt.__value="CenterLeft",V(Vt,Vt.__value),Wt.__value="Center",V(Wt,Wt.__value),Qt.__value="CenterRight",V(Qt,Qt.__value),qt.__value="TopLeft",V(qt,qt.__value),Dt.__value="TopCenter",V(Dt,Dt.__value),Bt.__value="TopRight",V(Bt,Bt.__value),m(we,"id","align"),m(en,"type","number"),m(en,"class","svelte-1vd74vs"),m(ct,"type","number"),m(ct,"class","svelte-1vd74vs"),m(de,"type","number"),m(de,"class","svelte-1vd74vs"),m(nn,"type","number"),m(nn,"class","svelte-1vd74vs"),m(xt,"class","margin svelte-1vd74vs")},m(te,Fe){Q(te,t,Fe),a(t,n),a(n,s),a(s,i),a(n,r),a(n,d),a(n,o),a(n,c),a(c,f),a(n,p),a(n,S),a(S,C),a(n,k),a(n,_),e[11](_),a(t,b),a(t,v),a(t,O),a(t,H),a(H,I),V(I,e[0].name),Q(te,T,Fe),Q(te,R,Fe),a(R,U),a(R,j),a(R,oe),a(oe,$),V($,e[0].font),Q(te,B,Fe),Q(te,F,Fe),a(F,me),a(F,ie),a(F,Be),a(Be,E),V(E,e[0].size),Q(te,P,Fe),Q(te,x,Fe),a(x,q),a(x,W),a(x,G),a(G,ce),ce.checked=e[0].styles.bold,a(G,_e),a(G,Ce),a(G,ue),ue.checked=e[0].styles.italic,a(G,Pe),a(G,ve),a(G,Te),Te.checked=e[0].styles.underline,a(G,Y),a(G,le),a(G,Ie),Ie.checked=e[0].styles.strikethrough,a(G,X),Q(te,Ee,Fe),Q(te,Je,Fe),a(Je,ee),a(Je,he),a(Je,Re),a(Re,Ze),V(Ze,e[0].color),Q(te,vt,Fe),Q(te,We,Fe),a(We,mt),a(We,_t),a(We,rt),a(rt,et),V(et,e[0].outlineColor),Q(te,Oe,Fe),Q(te,dt,Fe),a(dt,ze),a(dt,Pt),a(dt,qe),a(qe,Le),V(Le,e[0].outline),Q(te,Mt,Fe),Q(te,at,Fe),a(at,pt),a(at,ge),a(at,Ge),a(Ge,Qe),V(Qe,e[0].shadow),Q(te,Ne,Fe),Q(te,At,Fe),a(At,wt),a(At,D),a(At,re),a(re,we),a(we,bt),a(we,kt),a(we,jt),a(we,Vt),a(we,Wt),a(we,Qt),a(we,qt),a(we,Dt),a(we,Bt),e[25](we),Q(te,Ae,Fe),Q(te,st,Fe),a(st,wn),a(st,Wn),a(st,Sn),a(Sn,xt),a(xt,ws),a(xt,$t),a(xt,yt),a(yt,Ss),a(Ss,en),V(en,e[0].margin.top),a(yt,Nn),a(yt,Yn),a(Yn,ct),V(ct,e[0].margin.bottom),a(yt,tn),a(yt,L),a(L,de),V(de,e[0].margin.left),a(yt,It),a(yt,Jn),a(Jn,nn),V(nn,e[0].margin.right),Zn||(Cs=[M(s,"click",e[8]),M(c,"click",e[9]),M(S,"click",e[10]),M(_,"click",e[12]),M(I,"input",e[13]),M(I,"change",e[14]),M($,"input",e[15]),M(E,"input",e[16]),M(ce,"change",e[17]),M(ue,"change",e[18]),M(Te,"change",e[19]),M(Ie,"change",e[20]),M(Ze,"input",e[21]),M(et,"input",e[22]),M(Le,"input",e[23]),M(Qe,"input",e[24]),M(we,"input",e[26]),M(en,"input",e[27]),M(ct,"input",e[28]),M(de,"input",e[29]),M(nn,"input",e[30])],Zn=!0)},p(te,Fe){Fe[0]&3&&l!==(l=te[0]==te[1].defaultStyle)&&(s.disabled=l),Fe[0]&3&&g!==(g=te[0]==te[1].defaultStyle||te[0]==te[1].styles[0])&&(c.disabled=g),Fe[0]&3&&w!==(w=te[0]==te[1].defaultStyle||te[0]==te[1].styles.at(-1))&&(S.disabled=w),Fe[0]&1&&N!==(N=Rn(te[6](te[0].name)?"duplicate":"")+" svelte-1vd74vs")&&m(I,"class",N),Fe[0]&1&&I.value!==te[0].name&&V(I,te[0].name),Fe[0]&1&&$.value!==te[0].font&&V($,te[0].font),Fe[0]&1&&tt(E.value)!==te[0].size&&V(E,te[0].size),Fe[0]&1&&(ce.checked=te[0].styles.bold),Fe[0]&1&&(ue.checked=te[0].styles.italic),Fe[0]&1&&(Te.checked=te[0].styles.underline),Fe[0]&1&&(Ie.checked=te[0].styles.strikethrough),Fe[0]&1&&Ze.value!==te[0].color&&V(Ze,te[0].color),Fe[0]&1&&et.value!==te[0].outlineColor&&V(et,te[0].outlineColor),Fe[0]&1&&tt(Le.value)!==te[0].outline&&V(Le,te[0].outline),Fe[0]&1&&tt(Qe.value)!==te[0].shadow&&V(Qe,te[0].shadow),Fe[0]&1&&tt(en.value)!==te[0].margin.top&&V(en,te[0].margin.top),Fe[0]&1&&tt(ct.value)!==te[0].margin.bottom&&V(ct,te[0].margin.bottom),Fe[0]&1&&tt(de.value)!==te[0].margin.left&&V(de,te[0].margin.left),Fe[0]&1&&tt(nn.value)!==te[0].margin.right&&V(nn,te[0].margin.right)},i:Tt,o:Tt,d(te){te&&(J(t),J(T),J(R),J(B),J(F),J(P),J(x),J(Ee),J(Je),J(vt),J(We),J(Oe),J(dt),J(Mt),J(at),J(Ne),J(At),J(Ae),J(st)),e[11](null),e[25](null),Zn=!1,ut(Cs)}}}function wd(e,t,n){const s=gs(),i=()=>s("submit");let{style:l}=t,{subtitles:r}=t,{frontend:d}=t,o,c;function f(E){for(let P of[...r.styles,r.defaultStyle])if(P!==l&&P.name==E)return!0;return!1}function g(){let E=l==r.defaultStyle,P=r.entries.filter(q=>q.texts.find(W=>W.style==l)!==void 0),x=E?[]:[r.defaultStyle];x.push(...r.styles.filter(q=>q!==l)),oi({items:[{label:"delete",disabled:P.length>0||E,event:()=>{let q=r.styles.indexOf(l);q<0||(r.styles.splice(q,1),d.markChanged(Ye.Styles,Me.Action),i())}},{label:"replace by",disabled:x.length==0,subitems:x.map(q=>({label:q.name,payload:q,event:W=>{W&&Rs.replaceStyle(r.entries,l,W.payload)&&d.markChanged(Ye.NonTime,Me.Action)}}))},{label:"duplicate",event:()=>{let q=l.clone();q.name=Rs.getUniqueStyleName(r,l.name),r.styles.push(q),n(1,r),d.markChanged(Ye.Styles,Me.Action),i()}}]})}const p=()=>{let E=r.styles.indexOf(l);Ve(E>=0);let P=new On("new");n(1,r.styles=r.styles.toSpliced(E,0,P),r),i()},S=()=>{let E=r.styles.indexOf(l);Ve(E>=0),n(1,r.styles=[...r.styles.slice(0,E-1),l,r.styles[E-1],...r.styles.slice(E+1)],r),i()},C=()=>{let E=r.styles.indexOf(l);Ve(E>=0),n(1,r.styles=[...r.styles.slice(0,E),r.styles[E+1],l,...r.styles.slice(E+2)],r),i()};function w(E){be[E?"unshift":"push"](()=>{c=E,n(4,c)})}const k=()=>g();function _(){l.name=this.value,n(0,l)}const b=()=>d.markChanged(Ye.Styles,Me.Action);function v(){l.font=this.value,n(0,l)}function O(){l.size=tt(this.value),n(0,l)}function H(){l.styles.bold=this.checked,n(0,l)}function I(){l.styles.italic=this.checked,n(0,l)}function N(){l.styles.underline=this.checked,n(0,l)}function T(){l.styles.strikethrough=this.checked,n(0,l)}function R(){l.color=this.value,n(0,l)}function U(){l.outlineColor=this.value,n(0,l)}function j(){l.outline=tt(this.value),n(0,l)}function oe(){l.shadow=tt(this.value),n(0,l)}function $(E){be[E?"unshift":"push"](()=>{o=E,n(3,o),n(0,l)})}const B=()=>n(0,l.alignment=o.selectedIndex+1,l);function F(){l.margin.top=tt(this.value),n(0,l)}function me(){l.margin.bottom=tt(this.value),n(0,l)}function ie(){l.margin.left=tt(this.value),n(0,l)}function Be(){l.margin.right=tt(this.value),n(0,l)}return e.$$set=E=>{"style"in E&&n(0,l=E.style),"subtitles"in E&&n(1,r=E.subtitles),"frontend"in E&&n(2,d=E.frontend)},e.$$.update=()=>{e.$$.dirty[0]&9&&o&&n(3,o.selectedIndex=l.alignment-1,o)},[l,r,d,o,c,i,f,g,p,S,C,w,k,_,b,v,O,H,I,N,T,R,U,j,oe,$,B,F,me,ie,Be]}class Jr extends Zt{constructor(t){super(),Jt(this,t,wd,yd,Ft,{style:0,subtitles:1,frontend:2},null,[-1,-1])}}function Fl(e,t,n){const s=e.slice();return s[9]=t[n],s}function Ml(e,t){let n,s,i;return s=new Jr({props:{frontend:t[0],style:t[9],subtitles:t[0].subs}}),s.$on("submit",t[5]),{key:e,first:null,c(){n=hs(),je(s.$$.fragment),this.first=n},m(l,r){Q(l,n,r),Ue(s,l,r),i=!0},p(l,r){t=l;const d={};r&1&&(d.frontend=t[0]),r&1&&(d.style=t[9]),r&1&&(d.subtitles=t[0].subs),s.$set(d)},i(l){i||(ye(s.$$.fragment,l),i=!0)},o(l){ke(s.$$.fragment,l),i=!1},d(l){l&&J(n),He(s,l)}}}function Sd(e){let t,n,s,i,l,r,d,o,c,f,g,p,S,C,w,k,_,b,v=[],O=new Map,H,I,N,T,R,U,j;_=new Jr({props:{frontend:e[0],style:e[0].subs.defaultStyle,subtitles:e[0].subs}});let oe=Yt(e[0].subs.styles);const $=B=>B[9].uniqueID;for(let B=0;B<oe.length;B+=1){let F=Fl(e,oe,B),me=$(F);O.set(me,v[B]=Ml(me,F))}return{c(){t=h("table"),n=h("tr"),n.innerHTML='<td>title</td> <td><input class="txt svelte-1n9pcjd"/></td>',s=y(),i=h("tr"),i.innerHTML='<td>language</td> <td><input class="txt svelte-1n9pcjd"/></td>',l=y(),r=h("tr"),d=h("td"),d.textContent="resolution",o=y(),c=h("td"),f=h("input"),g=Se(`
        ×
        `),p=h("input"),S=y(),C=h("tr"),C.innerHTML="<td>styles</td> <td><hr/></td>",w=y(),k=h("table"),je(_.$$.fragment),b=y();for(let B=0;B<v.length;B+=1)v[B].c();H=y(),I=h("tr"),N=h("td"),T=h("button"),T.textContent="+",m(f,"type","number"),m(f,"class","res svelte-1n9pcjd"),m(p,"type","number"),m(p,"class","res svelte-1n9pcjd"),m(t,"class","config"),Nt(T,"width","25px"),Nt(T,"height","20px"),Nt(N,"padding-right","10px"),m(k,"class","txt svelte-1n9pcjd")},m(B,F){Q(B,t,F),a(t,n),a(t,s),a(t,i),a(t,l),a(t,r),a(r,d),a(r,o),a(r,c),a(c,f),V(f,e[0].subs.width),a(c,g),a(c,p),V(p,e[0].subs.height),a(t,S),a(t,C),Q(B,w,F),Q(B,k,F),Ue(_,k,null),a(k,b);for(let me=0;me<v.length;me+=1)v[me]&&v[me].m(k,null);a(k,H),a(k,I),a(I,N),a(N,T),R=!0,U||(j=[M(f,"input",e[2]),M(f,"change",e[3]),M(p,"input",e[4]),M(T,"click",e[6])],U=!0)},p(B,F){F&1&&tt(f.value)!==B[0].subs.width&&V(f,B[0].subs.width),F&1&&tt(p.value)!==B[0].subs.height&&V(p,B[0].subs.height);const me={};F&1&&(me.frontend=B[0]),F&1&&(me.style=B[0].subs.defaultStyle),F&1&&(me.subtitles=B[0].subs),_.$set(me),F&1&&(oe=Yt(B[0].subs.styles),_s(),v=Ki(v,F,$,1,B,oe,O,k,fa,Ml,H,Fl),bs())},i(B){if(!R){ye(_.$$.fragment,B);for(let F=0;F<oe.length;F+=1)ye(v[F]);R=!0}},o(B){ke(_.$$.fragment,B);for(let F=0;F<v.length;F+=1)ke(v[F]);R=!1},d(B){B&&(J(t),J(w),J(k)),He(_);for(let F=0;F<v.length;F+=1)v[F].d();U=!1,ut(j)}}}function Cd(e){let t;return{c(){t=h("h2"),t.textContent="Properties",m(t,"slot","header")},m(n,s){Q(n,t,s)},p:Tt,d(n){n&&J(t)}}}function vd(e){let t,n,s,i;function l(o){e[7](o)}function r(o){e[8](o)}let d={$$slots:{header:[Cd],default:[Sd]},$$scope:{ctx:e}};return e[0]!==void 0&&(d.frontend=e[0]),e[1]!==void 0&&(d.show=e[1]),t=new ys({props:d}),be.push(()=>$e(t,"frontend",l)),be.push(()=>$e(t,"show",r)),{c(){je(t.$$.fragment)},m(o,c){Ue(t,o,c),i=!0},p(o,[c]){const f={};c&4097&&(f.$$scope={dirty:c,ctx:o}),!n&&c&1&&(n=!0,f.frontend=o[0],xe(()=>n=!1)),!s&&c&2&&(s=!0,f.show=o[1],xe(()=>s=!1)),t.$set(f)},i(o){i||(ye(t.$$.fragment,o),i=!0)},o(o){ke(t.$$.fragment,o),i=!1},d(o){He(t,o)}}}function Ad(e,t,n){let{frontend:s}=t,{show:i=!1}=t;function l(){s.subs.width=tt(this.value),n(0,s),n(1,i)}const r=()=>{var p,S;return(S=(p=s.playback.video)==null?void 0:p.subRenderer)==null?void 0:S.changeResolution()};function d(){s.subs.height=tt(this.value),n(0,s),n(1,i)}const o=()=>(n(0,s),n(1,i)),c=()=>{let p=new On("new");n(0,s.subs.styles=[...s.subs.styles,p],s)};function f(p){s=p,n(0,s),n(1,i)}function g(p){i=p,n(1,i)}return e.$$set=p=>{"frontend"in p&&n(0,s=p.frontend),"show"in p&&n(1,i=p.show)},e.$$.update=()=>{e.$$.dirty&3&&(n(0,s),n(1,i))},[s,i,l,r,d,o,c,f,g]}class kd extends Zt{constructor(t){super(),Jt(this,t,Ad,vd,Ft,{frontend:0,show:1})}}const Ed="modulepreload",Dd=function(e){return"/"+e},Tl={},Fd=function(t,n,s){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),r=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=Promise.all(n.map(d=>{if(d=Dd(d),d in Tl)return;Tl[d]=!0;const o=d.endsWith(".css"),c=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${c}`))return;const f=document.createElement("link");if(f.rel=o?"stylesheet":Ed,o||(f.as="script",f.crossOrigin=""),f.href=d,r&&f.setAttribute("nonce",r),document.head.appendChild(f),o)return new Promise((g,p)=>{f.addEventListener("load",g),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${d}`)))})}))}return i.then(()=>t()).catch(l=>{const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=l,window.dispatchEvent(r),!r.defaultPrevented)throw l})},Zr={am:.0661,ar:.0237,az:.0269,be:.0227,bg:.0234,bn:.1373,ca:.0246,cs:.0242,da:.0277,de:.0275,el:.0369,en:.0378,es:.0252,et:.0253,eu:.0369,fa:.0213,fi:.026,fr:.0253,gu:.1197,he:.0402,hi:.0578,hr:.0201,hu:.0208,hy:.0439,is:.032,it:.0251,ja:.0375,ka:.1383,kn:.1305,ko:.0222,ku:.0256,lo:.3488,lt:.0246,lv:.0264,ml:.1322,mr:.0571,ms:.0251,nl:.0342,no:.0266,or:.1269,pa:.1338,pl:.0275,pt:.0252,ro:.0247,ru:.0184,sk:.024,sl:.0253,sq:.0353,sr:.0234,sv:.033,ta:.1513,te:.1547,th:.0882,tl:.0368,tr:.0258,uk:.0206,ur:.0282,vi:.0467,yo:.0329,zh:.0152},Et={langCodes:{},langScore:[],ngrams:{},type:"",avgScore:Zr};async function Qr(e){return await Fd(()=>import("./ngrams/"+e),[]).then(t=>{if(Md(t.ngramsData),Et.type)return!0})}function Md(e){Et.langCodes=e.languages,Et.langScore=Array(Object.keys(e.languages).length).fill(0),Et.ngrams=e.ngrams,Et.type=e.type}const xr={L:{alias:"Letter",bmp:"A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꟊꟐꟑꟓꟕ-ꟙꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ"}},Td=new RegExp("[^"+xr.L.bmp+"]+(?<![\\x27\\x60\\u2019])","gu"),Od=new RegExp("([A-Za-z0-9-]+.)+com(/S*|[^"+xr.L.bmp+"])","g"),hn=[" "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","'"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"," "," "," "," "," ","M","2","R","J","O","P","{","ä",">","â","ü","é","_","Q","á","ô","ë","å","õ","è","ï","Z","û","}","à","3","ù","É","Y","î","í","]","|",")","ÿ","~","1","V","D","T","4","8","F","I","K","7","W","S","/","E","B","5",";","N","C","ê","*","X","=","^",":","[","H","ò"," "," ","¢","!","(",",","ß"," ","ø","ó"," "," "," "," ","U","ö","6","@","À","Á"," ","<","ý","G","-","A","ñ","ú"," "," "," "," ","$","L","æ","?","0",'"',"#","%","&","+","ì","9",".","ç"," ","µ"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "];function nl(e,t){let n={};for(let s of e)n[s]=t[s];return n}class Ol{constructor(t,n,s,i){this.language=t,this.getScores=()=>Rd(n,i),this.isReliable=()=>Pd(n,s,t)}}function Pd(e,t,n){if(!e.length||t<3)return!1;const s=e.length>1?e[1][0]:0;return!(Zr[n]*.24>e[0][1]/t||.01>Math.abs(e[0][1]-s))}function Rd(e,t){let n={},s;for(s in e){let i=e[s][1];if(i===0)break;n[t[e[s][0]]]=i}return n}const Ld=function(){function e(i,l,r,d){if(!i.length)return"No languages found";let o=JSON.parse(JSON.stringify(l));const c="ngrams"+d+"-"+i.length+"_"+Date.now()+".js";for(let f in o){for(let g in o[f])i.indexOf(parseInt(g))===-1&&delete o[f][g];Object.keys(o[f]).length===0&&delete o[f]}s(`// Copyright 2023 Nito T.M. [ Apache 2.0 Licence https://www.apache.org/licenses/LICENSE-2.0 ]
export const ngramsData = {
   type: "`+d+`",
   languages: `+JSON.stringify(nl(i,r))+`,
   isSubset: true,
   ngrams: `+t(o)+`
}`,c,"js")}function t(i){if(typeof i=="object"&&i){let l=[];for(const r in i)l.push("'"+r.replace(/'/g,"\\'")+"':"+n(i[r]));return"{"+l.join(",")+"}"}}function n(i){let l=[];for(const r in i)l.push(r+":"+i[r]);return"{"+l.join(",")+"}"}function s(i,l,r){const d=new Blob([i],{type:r});if(typeof window>"u"){console.log("saveSubset() is only available at the Web Browser");return}if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(d,l);else{let o=document.createElement("a"),c=URL.createObjectURL(d);o.href=c,o.download=l,document.body.appendChild(o),o.click(),setTimeout(function(){document.body.removeChild(o),window.URL.revokeObjectURL(c)},0)}}return{saveSubset:e}}();await Qr("ngramsM60.js");const Pl=function(){return{detect:Wd,cleanText:Nd,dynamicLangSubset:Vd,saveSubset:qd,loadNgrams:Qr,info:Gd}}();let ln=!1,$r=!1;function Wd(e){if(typeof e!="string")return new Ol("",0,0,{});$r&&(e=Bd(e));const t=Id(e),n=zd(t),s=Object.keys(n).length;let i=Ud(n,s),l="";return i.length>0&&(ln&&(i=jd(i)),i.sort((r,d)=>d[1]-r[1]),l=Et.langCodes[i[0][0]]),new Ol(l,i,s,Et.langCodes)}function Nd(e){$r=!!e}function Bd(e){return e=e.replace(/[hw]((ttps?:\/\/(www\.)?)|ww\.)([^\s/?.#-]+\.?)+(\/\S*)?/gi," "),e=e.replace(/[a-zA-Z0-9.!$%&’+_`-]+@[A-Za-z0-9.-]+\.[A-Za-z0-9-]{2,64}/g," "),e=e.replace(Od," "),e=e.replace(/[a-zA-Z]*[0-9]+[a-zA-Z0-9]*/g," "),e}function Id(e){return e=e.substring(0,1e3),e=e.replace(Td," "),e=e.trim().toLowerCase(),Hd(e)}function zd(e){let t={},n=0,s,i;for(let l in e){let r=e[l],d=r.length;for(d>70&&(d=70),i=0;i+4<d;i+=3,++n)s=(i===0?" ":"")+r.substring(i,i+4),t[s]=typeof t[s]<"u"?t[s]+1:1;s=(i===0?" ":"")+r.substring(d!==3?d-4:0)+" ",t[s]=typeof t[s]<"u"?t[s]+1:1,n++}for(let l in t)t[l]=t[l]/n*13200;return t}function Ud(e,t){let n,s,i,l,r,d,o,c=[...Et.langScore];for(n in e)if(r=e[n],o=Et.ngrams[n],o){l=Object.keys(o).length,l===1?i=27:l<16?i=(16-l)/2+1:i=1;for(d in o)s=o[d],c[d]+=(r>s?s/r:r/s)*i+2}let f=t*3.2,g=[];for(d in c)c[d]&&g.push([parseInt(d),c[d]/f]);return g}function Hd(e){let t="",n=[],s=0;const i=350,l=380;for(let r=0;r<e.length;r++){let d=e.charCodeAt(r);if(d<128){if(d===32){if(t!==""&&(n.push(t),t=""),s>i)break}else t+=e[r];s++}else d<2048?(t+=hn[192|d>>6]+hn[128|d&63],s+=2):d<55296||d>=57344?(t+=hn[224|d>>12]+hn[128|d>>6&63]+hn[128|d&63],s+=3):(r++,d=65536+((d&1023)<<10|e.charCodeAt(r)&1023),t+=hn[240|d>>18]+hn[128|d>>12&63]+hn[128|d>>6&63]+hn[128|d&63],s+=4);if(s>l)break}return t!==""&&n.push(t),n}function jd(e){let t=[];for(let n in e)ln.indexOf(e[n][0])>-1&&t.push(e[n]);return t}function qi(e){if(e){ln=[];for(let t in e){let n=Object.keys(Et.langCodes).find(s=>Et.langCodes[s]===e[t]);n&&ln.push(parseInt(n))}ln.length?ln.sort():ln=!1}else ln=!1;return ln}function Vd(e){let t=qi(e);return t?nl(t,Et.langCodes):{}}function qd(e){const t=qi(e);qi(!1),Ld.saveSubset(t,Et.ngrams,Et.langCodes,Et.type)}function Gd(){return{"Data type":Et.type,Languages:Et.langCodes,"Dynamic subset":ln?nl(ln,Et.langCodes):!1}}function Rl(e,t,n){const s=e.slice();return s[32]=t[n],s[33]=t,s[34]=n,s}function Ll(e){let t,n,s=e[32][0]+"",i,l,r,d=e[32][1][0]+"",o,c,f,g,p,S,C,w,k,_,b,v,O,H,I,N,T;function R(){e[17].call(S,e[33],e[34])}function U($){e[19]($,e[32])}let j={subtitles:e[1].subs};e[32][1][1]!==void 0&&(j.currentStyle=e[32][1][1]),w=new ps({props:j}),be.push(()=>$e(w,"currentStyle",U));function oe(){e[20].call(b,e[33],e[34])}return I=la(e[18][1],[e[34]]),{c(){t=h("tr"),n=h("td"),i=Se(s),l=y(),r=h("td"),o=Se(d),c=Se(" lines"),f=y(),g=h("td"),p=Se(`→
                `),S=h("input"),C=y(),je(w.$$.fragment),_=y(),b=h("input"),v=Se(`
                keep original`),O=y(),m(S,"type","radio"),m(S,"name","use"+e[34]),S.__value=!0,V(S,S.__value),m(b,"type","radio"),m(b,"name","use"+e[34]),b.__value=!1,V(b,b.__value),I.p(S,b)},m($,B){Q($,t,B),a(t,n),a(n,i),a(t,l),a(t,r),a(r,o),a(r,c),a(t,f),a(t,g),a(g,p),a(g,S),S.checked=S.__value===e[32][1][2],a(g,C),Ue(w,g,null),a(g,_),a(g,b),b.checked=b.__value===e[32][1][2],a(g,v),a(t,O),H=!0,N||(T=[M(S,"change",R),M(b,"change",oe)],N=!0)},p($,B){e=$,(!H||B[0]&8)&&s!==(s=e[32][0]+"")&&ht(i,s),(!H||B[0]&8)&&d!==(d=e[32][1][0]+"")&&ht(o,d),B[0]&8&&(S.checked=S.__value===e[32][1][2]);const F={};B[0]&2&&(F.subtitles=e[1].subs),!k&&B[0]&8&&(k=!0,F.currentStyle=e[32][1][1],xe(()=>k=!1)),w.$set(F),B[0]&8&&(b.checked=b.__value===e[32][1][2]),B[0]&8&&I.u([e[34]])},i($){H||(ye(w.$$.fragment,$),H=!0)},o($){ke(w.$$.fragment,$),H=!1},d($){$&&J(t),He(w),I.r(),N=!1,ut(T)}}}function Wl(e){let t,n,s=Yt(e[3]),i=[];for(let r=0;r<s.length;r+=1)i[r]=Ll(Rl(e,s,r));const l=r=>ke(i[r],1,1,()=>{i[r]=null});return{c(){for(let r=0;r<i.length;r+=1)i[r].c();t=hs()},m(r,d){for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(r,d);Q(r,t,d),n=!0},p(r,d){if(d[0]&10){s=Yt(r[3]);let o;for(o=0;o<s.length;o+=1){const c=Rl(r,s,o);i[o]?(i[o].p(c,d),ye(i[o],1)):(i[o]=Ll(c),i[o].c(),ye(i[o],1),i[o].m(t.parentNode,t))}for(_s(),o=s.length;o<i.length;o+=1)l(o);bs()}},i(r){if(!n){for(let d=0;d<s.length;d+=1)ye(i[d]);n=!0}},o(r){i=i.filter(Boolean);for(let d=0;d<i.length;d+=1)ke(i[d]);n=!1},d(r){r&&J(t),Gi(i,r)}}}function Kd(e){let t,n,s,i,l,r,d,o,c,f,g,p,S,C,w,k,_,b,v,O,H,I,N,T,R=e[8],U,j,oe,$,B,F,me,ie,Be,E,P,x,q,W,G,ce,_e,Ce,ue,Pe,ve,Te,Y,le,Ie,X,Ee=Wl(e);function Je(he){e[23](he)}let ee={subtitles:e[1].subs};return e[10]!==void 0&&(ee.currentStyle=e[10]),x=new ps({props:ee}),be.push(()=>$e(x,"currentStyle",Je)),le=Ts(e[18][0]),{c(){t=h("table"),n=h("tr"),s=h("td"),i=y(),l=h("td"),r=Se(e[4]),d=y(),o=h("tr"),c=h("td"),c.textContent="restrict to",f=y(),g=h("td"),p=h("input"),S=y(),C=h("button"),C.textContent="analyze again",w=h("hr"),k=y(),_=h("input"),b=Se(`
                merge adjacent lines having a same style`),v=h("br"),O=y(),H=h("input"),I=Se(`
                ignore single-line entries
                `),N=h("hr"),T=y(),Ee.c(),U=y(),j=h("tr"),oe=h("td"),$=y(),B=h("td"),F=h("button"),F.textContent="set all",me=y(),ie=h("td"),Be=Se(`→
                `),E=h("input"),P=y(),je(x.$$.fragment),W=y(),G=h("input"),ce=Se(`
                keep original`),_e=y(),Ce=h("tr"),ue=h("td"),Pe=y(),ve=h("td"),Te=h("button"),Te.textContent="split lines",m(l,"colspan","2"),m(p,"type","text"),m(_,"type","checkbox"),m(H,"type","checkbox"),m(g,"colspan","2"),m(E,"type","radio"),m(E,"name","use"),E.__value=!0,V(E,E.__value),m(G,"type","radio"),m(G,"name","use"),G.__value=!1,V(G,G.__value),Nt(Te,"width","100%"),m(ve,"colspan","2"),m(t,"class","config"),le.p(E,G)},m(he,Re){Q(he,t,Re),a(t,n),a(n,s),a(n,i),a(n,l),a(l,r),a(t,d),a(t,o),a(o,c),a(o,f),a(o,g),a(g,p),V(p,e[5]),a(g,S),a(g,C),a(g,w),a(g,k),a(g,_),_.checked=e[6],a(g,b),a(g,v),a(g,O),a(g,H),H.checked=e[7],a(g,I),a(g,N),a(t,T),Ee.m(t,null),a(t,U),a(t,j),a(j,oe),a(j,$),a(j,B),a(B,F),a(j,me),a(j,ie),a(ie,Be),a(ie,E),E.checked=E.__value===e[9],a(ie,P),Ue(x,ie,null),a(ie,W),a(ie,G),G.checked=G.__value===e[9],a(ie,ce),a(t,_e),a(t,Ce),a(Ce,ue),a(Ce,Pe),a(Ce,ve),a(ve,Te),Y=!0,Ie||(X=[M(p,"input",e[13]),M(C,"click",e[14]),M(_,"change",e[15]),M(H,"change",e[16]),M(F,"click",e[21]),M(E,"change",e[22]),M(G,"change",e[24]),M(Te,"click",e[25])],Ie=!0)},p(he,Re){(!Y||Re[0]&16)&&ht(r,he[4]),Re[0]&32&&p.value!==he[5]&&V(p,he[5]),Re[0]&64&&(_.checked=he[6]),Re[0]&128&&(H.checked=he[7]),Re[0]&256&&Ft(R,R=he[8])?(_s(),ke(Ee,1,1,Tt),bs(),Ee=Wl(he),Ee.c(),ye(Ee,1),Ee.m(t,U)):Ee.p(he,Re),Re[0]&512&&(E.checked=E.__value===he[9]);const Ze={};Re[0]&2&&(Ze.subtitles=he[1].subs),!q&&Re[0]&1024&&(q=!0,Ze.currentStyle=he[10],xe(()=>q=!1)),x.$set(Ze),Re[0]&512&&(G.checked=G.__value===he[9])},i(he){Y||(ye(Ee),ye(x.$$.fragment,he),Y=!0)},o(he){ke(Ee),ke(x.$$.fragment,he),Y=!1},d(he){he&&J(t),Ee.d(he),He(x),le.r(),Ie=!1,ut(X)}}}function Xd(e){let t,n,s,i;function l(o){e[26](o)}function r(o){e[27](o)}let d={$$slots:{default:[Kd]},$$scope:{ctx:e}};return e[1]!==void 0&&(d.frontend=e[1]),e[0]!==void 0&&(d.show=e[0]),t=new ys({props:d}),be.push(()=>$e(t,"frontend",l)),be.push(()=>$e(t,"show",r)),{c(){je(t.$$.fragment)},m(o,c){Ue(t,o,c),i=!0},p(o,c){const f={};c[0]&2046|c[1]&16&&(f.$$scope={dirty:c,ctx:o}),!n&&c[0]&2&&(n=!0,f.frontend=o[1],xe(()=>n=!1)),!s&&c[0]&1&&(s=!0,f.show=o[0],xe(()=>s=!1)),t.$set(f)},i(o){i||(ye(t.$$.fragment,o),i=!0)},o(o){ke(t.$$.fragment,o),i=!1},d(o){He(t,o)}}}function Yd(e,t,n){let{frontend:s}=t,{show:i=!1}=t,l=[],r="",d="zh ja en fr de it es",o=!0,c=!0,f=0,g=0;function p(E,P){let x=Object.entries(Pl.detect(E).getScores()),q="?",W=0;for(const[G,ce]of x)P.size>0&&!P.has(G)||ce>W&&(q=G,W=ce);return q}async function S(){await Pl.loadNgrams("ngramsL60.js")}async function C(){let E=new Set(d.split(" ")),P=new Map;P.clear();for(let x of s.subs.entries)for(let q of x.texts){let W=q.text.split(`
`).filter(ce=>ce.length>0);if(W.length<=1&&c)continue;let G="";for(const ce of W){let _e=p(ce,E);if(o){if(_e==G)continue;G=_e}P.has(_e)?P.get(_e)[0]++:P.set(_e,[1,s.subs.defaultStyle,!1])}}return P}async function w(){var x;let E=new Set(d.split(" ")),P=new Map(l);for(let q of s.subs.entries){let W=[];for(let G of q.texts){let ce=G.text.split(`
`).filter(Ce=>Ce.length>0);if(ce.length<=1&&c){W.push(G);continue}let _e="";for(const Ce of ce){let ue=p(Ce,E);if(o){if(ue==_e){W.at(-1).text+=`
`+Ce;continue}_e=ue}let Pe=G.style;(x=P.get(ue))!=null&&x[2]&&(Pe=P.get(ue)[1]),W.push({style:Pe,text:Ce})}}q.texts=W}n(0,i=!1),s.markChanged(Ye.Both,Me.Action)}async function k(){i&&(n(4,r="analyzing..."),await S(),n(3,l=[...await C()].sort((E,P)=>P[1][0]-E[1][0])),n(4,r=l.length+" languages detected"),n(8,f++,f))}let _=!1,b=s.subs.defaultStyle;function v(){for(const E of l)E[1][2]=_,E[1][1]=b;n(8,f++,f)}const O=[[],[]];function H(){d=this.value,n(5,d)}const I=()=>n(2,g++,g);function N(){o=this.checked,n(6,o)}function T(){c=this.checked,n(7,c)}function R(E,P){E[P][1][2]=this.__value,n(3,l)}function U(E,P){e.$$.not_equal(P[1][1],E)&&(P[1][1]=E,n(3,l))}function j(E,P){E[P][1][2]=this.__value,n(3,l)}const oe=()=>v();function $(){_=this.__value,n(9,_)}function B(E){b=E,n(10,b)}function F(){_=this.__value,n(9,_)}const me=()=>w();function ie(E){s=E,n(1,s)}function Be(E){i=E,n(0,i)}return e.$$set=E=>{"frontend"in E&&n(1,s=E.frontend),"show"in E&&n(0,i=E.show)},e.$$.update=()=>{e.$$.dirty[0]&5&&k()},[i,s,g,l,r,d,o,c,f,_,b,w,v,H,I,N,T,R,O,U,j,oe,$,B,F,me,ie,Be]}class Jd extends Zt{constructor(t){super(),Jt(this,t,Yd,Xd,Ft,{frontend:1,show:0},null,[-1,-1])}}function Zd(e){let t,n,s,i,l,r,d,o,c,f,g,p,S,C,w,k,_,b,v,O,H,I,N,T,R,U,j,oe=e[6][0]+"",$,B,F,me=e[6][1]+"",ie,Be,E,P=e[6][0]==1?"entry":"entries",x,q,W,G=e[7]?`${e[6][0]==1?"has":"have"} been`:"will be",ce,_e,Ce,ue=e[6][1]==1?"group":"groups",Pe,ve,Te,Y,le,Ie,X,Ee,Je;return{c(){t=h("table"),n=h("tr"),s=h("td"),s.textContent="start time threshold",i=y(),l=h("td"),r=h("input"),d=y(),o=h("tr"),c=h("td"),c.textContent="end time threshold",f=y(),g=h("td"),p=h("input"),S=y(),C=h("tr"),w=h("td"),k=y(),_=h("td"),b=h("input"),v=Se(` selection only
            `),O=h("br"),H=h("input"),I=Se(" different style only"),N=y(),T=h("tr"),T.innerHTML="<td></td> <td><hr/></td>",R=y(),U=h("tr"),j=h("td"),$=Se(oe),B=h("br"),F=h("br"),ie=Se(me),Be=y(),E=h("td"),x=Se(P),q=y(),W=h("br"),ce=Se(G),_e=Se(` combined in
            `),Ce=h("br"),Pe=Se(ue),ve=y(),Te=h("tr"),Y=h("td"),le=h("button"),le.textContent="combine",Ie=y(),X=h("tr"),X.innerHTML="<td></td> <td><hr/></td>",m(r,"type","number"),m(r,"min","0"),m(r,"step","0.001"),m(p,"type","number"),m(p,"min","0"),m(p,"step","0.001"),m(b,"type","checkbox"),m(H,"type","checkbox"),Nt(le,"width","100%"),m(Y,"colspan","2"),m(t,"class","config")},m(ee,he){Q(ee,t,he),a(t,n),a(n,s),a(n,i),a(n,l),a(l,r),V(r,e[2]),a(t,d),a(t,o),a(o,c),a(o,f),a(o,g),a(g,p),V(p,e[3]),a(t,S),a(t,C),a(C,w),a(C,k),a(C,_),a(_,b),b.checked=e[4],a(_,v),a(_,O),a(_,H),H.checked=e[5],a(_,I),a(t,N),a(t,T),a(t,R),a(t,U),a(U,j),a(j,$),a(j,B),a(j,F),a(j,ie),a(U,Be),a(U,E),a(E,x),a(E,q),a(E,W),a(E,ce),a(E,_e),a(E,Ce),a(E,Pe),a(t,ve),a(t,Te),a(Te,Y),a(Y,le),a(t,Ie),a(t,X),Ee||(Je=[M(r,"input",e[9]),M(p,"input",e[10]),M(b,"change",e[11]),M(H,"change",e[12]),M(le,"click",e[13])],Ee=!0)},p(ee,he){he&4&&tt(r.value)!==ee[2]&&V(r,ee[2]),he&8&&tt(p.value)!==ee[3]&&V(p,ee[3]),he&16&&(b.checked=ee[4]),he&32&&(H.checked=ee[5]),he&64&&oe!==(oe=ee[6][0]+"")&&ht($,oe),he&64&&me!==(me=ee[6][1]+"")&&ht(ie,me),he&64&&P!==(P=ee[6][0]==1?"entry":"entries")&&ht(x,P),he&192&&G!==(G=ee[7]?`${ee[6][0]==1?"has":"have"} been`:"will be")&&ht(ce,G),he&64&&ue!==(ue=ee[6][1]==1?"group":"groups")&&ht(Pe,ue)},d(ee){ee&&J(t),Ee=!1,ut(Je)}}}function Qd(e){let t,n,s,i;function l(o){e[14](o)}function r(o){e[15](o)}let d={$$slots:{default:[Zd]},$$scope:{ctx:e}};return e[0]!==void 0&&(d.frontend=e[0]),e[1]!==void 0&&(d.show=e[1]),t=new ys({props:d}),be.push(()=>$e(t,"frontend",l)),be.push(()=>$e(t,"show",r)),{c(){je(t.$$.fragment)},m(o,c){Ue(t,o,c),i=!0},p(o,[c]){const f={};c&65788&&(f.$$scope={dirty:c,ctx:o}),!n&&c&1&&(n=!0,f.frontend=o[0],xe(()=>n=!1)),!s&&c&2&&(s=!0,f.show=o[1],xe(()=>s=!1)),t.$set(f)},i(o){i||(ye(t.$$.fragment,o),i=!0)},o(o){ke(t.$$.fragment,o),i=!1},d(o){He(t,o)}}}function xd(e,t,n){let{frontend:s}=t,{show:i=!1}=t,l=.005,r=.005,d=[0,0],o=!0,c=!1,f=!1;function g(v,O,H,I,N){n(6,d=[0,0]);let T;if(I){let U=s.getSelection();U.length>0?T=U:T=[...s.subs.entries]}else T=[...s.subs.entries];let R=new Set;for(let U=0;U<T.length-1;U++){let j=T[U],oe=new Set(j.texts.map(B=>B.style.name)),$=1;if(!R.has(j)){for(let B=U+1;B<T.length;B++){let F=T[B];if(!R.has(F)&&Math.abs(j.start-F.start)<l&&Math.abs(j.end-F.end)<r){if(N){let me=F.texts.map(ie=>ie.style.name);if(me.some(ie=>oe.has(ie)))continue;me.forEach(ie=>oe.add(ie))}v&&(j.texts.push(...F.texts),s.subs.entries.splice(s.subs.entries.indexOf(F),1)),$+=1,R.add(F)}}$>1&&(n(6,d[0]+=$,d),n(6,d[1]+=1,d))}}if(v&&(n(7,f=!0),R.size>0)){s.clearSelection();for(let U of T.filter(j=>!R.has(j)))s.selection.submitted.add(U);s.markChanged(Ye.Times,Me.Action)}}function p(){l=tt(this.value),n(2,l)}function S(){r=tt(this.value),n(3,r)}function C(){o=this.checked,n(4,o)}function w(){c=this.checked,n(5,c)}const k=()=>g(!0,l,r,o,c);function _(v){s=v,n(0,s)}function b(v){i=v,n(1,i)}return e.$$set=v=>{"frontend"in v&&n(0,s=v.frontend),"show"in v&&n(1,i=v.show)},e.$$.update=()=>{e.$$.dirty&60&&n(7,f=!1),e.$$.dirty&60&&g(!1,l,r,o,c)},[s,i,l,r,o,c,d,f,g,p,S,C,w,k,_,b]}class $d extends Zt{constructor(t){super(),Jt(this,t,xd,Qd,Ft,{frontend:0,show:1})}}function ec(e){let t,n,s,i,l,r;const d=e[11].default,o=bi(d,e,e[10],null);return{c(){t=y(),n=h("div"),o&&o.c(),m(n,"class",s=Rn(e[2]?"resizerV":"resizerH")+" svelte-ixu9tp"),Nt(n,"cursor",e[2]?"ew-resize":"ns-resize")},m(c,f){Q(c,t,f),Q(c,n,f),o&&o.m(n,null),i=!0,l||(r=[M(document,"mousemove",e[12]),M(document,"mouseup",e[13]),M(n,"mousedown",e[14])],l=!0)},p(c,[f]){o&&o.p&&(!i||f&1024)&&wi(o,d,c,c[10],i?yi(d,c[10],f,null):Si(c[10]),null),(!i||f&4&&s!==(s=Rn(c[2]?"resizerV":"resizerH")+" svelte-ixu9tp"))&&m(n,"class",s),(!i||f&4)&&Nt(n,"cursor",c[2]?"ew-resize":"ns-resize")},i(c){i||(ye(o,c),i=!0)},o(c){ke(o,c),i=!1},d(c){c&&(J(t),J(n)),o&&o.d(c),l=!1,ut(r)}}}function tc(e,t,n){let{$$slots:s={},$$scope:i}=t,{control:l}=t,{control2:r=null}=t,{vertical:d=!1}=t,{reverse:o=!1}=t,{minValue:c=10}=t,f=0,g=0,p=0,S=0,C=!1;const w=b=>{if(C){let v=o?-1:1;if(d){let O=Math.max(p+(b.clientX-f)*v,c);r&&n(1,r.style.width=S+O-p+"px",r),n(0,l.style.width=O+"px",l)}else{let O=Math.max(p+(b.clientY-g)*v,c);r&&n(1,r.style.height=S+O-p+"px",r),n(0,l.style.height=O+"px",l)}}},k=()=>{n(9,C=!1)},_=b=>{n(5,f=b.clientX),n(6,g=b.clientY),n(7,p=d?l.offsetWidth:l.offsetHeight),r&&n(8,S=d?r.offsetWidth:r.offsetHeight),n(9,C=!0)};return e.$$set=b=>{"control"in b&&n(0,l=b.control),"control2"in b&&n(1,r=b.control2),"vertical"in b&&n(2,d=b.vertical),"reverse"in b&&n(3,o=b.reverse),"minValue"in b&&n(4,c=b.minValue),"$$scope"in b&&n(10,i=b.$$scope)},[l,r,d,o,c,f,g,p,S,C,i,s,w,k,_]}class _i extends Zt{constructor(t){super(),Jt(this,t,tc,ec,Ft,{control:0,control2:1,vertical:2,reverse:3,minValue:4})}}function nc(e){let t,n,s,i;return{c(){t=h("input"),m(t,"class",n=Rn("timestamp "+(e[1]?"stretch":""))+" svelte-6f2ljh")},m(l,r){Q(l,t,r),V(t,e[2]),s||(i=[M(t,"input",e[6]),M(t,"beforeinput",e[7]),M(t,"keydown",e[8]),M(t,"blur",e[9])],s=!0)},p(l,[r]){r&2&&n!==(n=Rn("timestamp "+(l[1]?"stretch":""))+" svelte-6f2ljh")&&m(t,"class",n),r&4&&t.value!==l[2]&&V(t,l[2])},i:Tt,o:Tt,d(l){l&&J(t),s=!1,ut(i)}}}function sc(e,t,n){let{timestamp:s=0}=t,{stretchX:i=!1}=t,l="00:00:00.000",r=!1;function d(w){w!=l&&(n(3,r=!0),n(2,l=w))}const o=gs(),c=()=>o("change",s),f=()=>o("input",s);function g(){l=this.value,n(2,l)}const p=w=>{let k=w.currentTarget.value,_=w.currentTarget.selectionStart??0,b=w.data;b&&(w.preventDefault(),_<k.length&&b.match(/^\d$/)&&((k[_]==":"||k[_]==".")&&_++,w.currentTarget.value=k.slice(0,_)+b+k.slice(_+1),w.currentTarget.selectionStart=_+1,w.currentTarget.selectionEnd=_+1,n(0,s=ft.parseTimestamp(w.currentTarget.value)??0),n(3,r=!0),f()))},S=w=>{let k=w.currentTarget.value,_=w.currentTarget.selectionStart??0;w.key=="Backspace"&&_>0&&((k[_-1]==":"||k[_-1]==".")&&_--,w.currentTarget.value=k.slice(0,_-1)+"0"+k.slice(_),w.currentTarget.selectionStart=_-1,w.currentTarget.selectionEnd=_-1,w.preventDefault(),n(0,s=ft.parseTimestamp(w.currentTarget.value)??0),n(3,r=!0),f())},C=w=>{r&&(n(0,s=ft.parseTimestamp(w.currentTarget.value)??0),c())};return e.$$set=w=>{"timestamp"in w&&n(0,s=w.timestamp),"stretchX"in w&&n(1,i=w.stretchX)},e.$$.update=()=>{if(e.$$.dirty&1){let w=ft.formatTimestamp(s);d(w)}},[s,i,l,r,c,f,g,p,S,C]}class Tn extends Zt{constructor(t){super(),Jt(this,t,sc,nc,Ft,{timestamp:0,stretchX:1})}}function ic(e){let t,n,s,i,l,r,d,o,c,f,g,p,S,C,w,k,_,b,v,O,H,I,N,T,R,U,j,oe,$,B,F,me,ie,Be,E,P,x,q,W,G,ce,_e,Ce,ue,Pe,ve,Te,Y,le,Ie,X,Ee,Je,ee,he,Re,Ze,vt,We,mt,_t,rt,et,Oe,dt=ft.formatTimestamp(e[9])+"",ze,Pt,qe,Le,Mt,at,pt,ge=ft.formatTimestamp(e[10])+"",Ge,Qe,Ne,At,wt,D,re,we,bt;function kt(Ae){e[23](Ae)}let jt={};e[2]!==void 0&&(jt.timestamp=e[2]),k=new Tn({props:jt}),be.push(()=>$e(k,"timestamp",kt)),k.$on("input",e[24]);function Vt(Ae){e[34](Ae)}let Wt={};e[3]!==void 0&&(Wt.timestamp=e[3]),Re=new Tn({props:Wt}),be.push(()=>$e(Re,"timestamp",Vt)),Re.$on("input",e[35]);function Qt(Ae){e[36](Ae)}let qt={};e[13]!==void 0&&(qt.timestamp=e[13]),qe=new Tn({props:qt}),be.push(()=>$e(qe,"timestamp",Qt)),qe.$on("input",e[37]);function Dt(Ae){e[38](Ae)}let Bt={};return e[14]!==void 0&&(Bt.timestamp=e[14]),Ne=new Tn({props:Bt}),be.push(()=>$e(Ne,"timestamp",Dt)),Ne.$on("input",e[39]),Ne.$on("change",e[40]),D=Ts(e[21][0]),re=Ts(e[21][1]),{c(){t=h("form"),n=h("table"),s=h("tr"),i=h("td"),i.textContent="shift times",l=y(),r=h("td"),d=h("input"),o=y(),c=h("label"),c.textContent="forward",f=y(),g=h("input"),p=y(),S=h("label"),S.textContent="backward",C=h("br"),w=Se(`
        by: `),je(k.$$.fragment),b=h("br"),v=y(),O=h("input"),H=y(),I=h("label"),I.textContent="modify everything after this",N=h("br"),T=y(),R=h("tr"),R.innerHTML="<td></td> <td><hr/></td>",U=y(),j=h("tr"),oe=h("td"),oe.textContent="FPS before:after",$=y(),B=h("td"),F=h("input"),me=Se(`
        :
        `),ie=h("input"),Be=y(),E=h("tr"),P=h("td"),P.textContent="scaling anchor",x=y(),q=h("td"),W=h("input"),G=y(),ce=h("label"),ce.textContent="zero time",_e=h("br"),Ce=y(),ue=h("input"),Pe=y(),ve=h("label"),ve.textContent="start of selection",Te=h("br"),Y=y(),le=h("input"),Ie=y(),X=h("label"),X.textContent="end of selection",Ee=h("br"),Je=y(),ee=h("input"),he=y(),je(Re.$$.fragment),vt=y(),We=h("tr"),We.innerHTML="<td></td> <td><hr/></td>",mt=y(),_t=h("tr"),rt=h("td"),rt.textContent="range",et=y(),Oe=h("td"),ze=Se(dt),Pt=Se(`
        →
        `),je(qe.$$.fragment),Mt=y(),at=h("br"),pt=y(),Ge=Se(ge),Qe=Se(`
        →
        `),je(Ne.$$.fragment),m(d,"type","radio"),m(d,"id","st1"),d.__value="forward",V(d,d.__value),m(c,"for","st1"),m(g,"type","radio"),m(g,"id","st2"),g.__value="backward",V(g,g.__value),m(S,"for","st2"),m(O,"type","checkbox"),m(O,"id","st"),m(I,"for","st"),m(F,"type","number"),m(F,"class","number svelte-110xmzp"),m(ie,"type","number"),m(ie,"class","number svelte-110xmzp"),m(W,"type","radio"),m(W,"id","anc0"),W.__value="zero",V(W,W.__value),m(ce,"for","anc0"),m(ue,"type","radio"),m(ue,"id","anc1"),ue.__value="start",V(ue,ue.__value),m(ve,"for","anc1"),m(le,"type","radio"),m(le,"id","anc2"),le.__value="end",V(le,le.__value),m(X,"for","anc2"),m(ee,"type","radio"),m(ee,"id","anc3"),ee.__value="custom",V(ee,ee.__value),m(n,"class","config"),D.p(W,ue,le,ee),re.p(d,g)},m(Ae,st){Q(Ae,t,st),a(t,n),a(n,s),a(s,i),a(s,l),a(s,r),a(r,d),d.checked=d.__value===e[4],a(r,o),a(r,c),a(r,f),a(r,g),g.checked=g.__value===e[4],a(r,p),a(r,S),a(r,C),a(r,w),Ue(k,r,null),a(r,b),a(r,v),a(r,O),O.checked=e[12],a(r,H),a(r,I),a(r,N),a(n,T),a(n,R),a(n,U),a(n,j),a(j,oe),a(j,$),a(j,B),a(B,F),V(F,e[6]),a(B,me),a(B,ie),V(ie,e[7]),a(n,Be),a(n,E),a(E,P),a(E,x),a(E,q),a(q,W),W.checked=W.__value===e[5],a(q,G),a(q,ce),a(q,_e),a(q,Ce),a(q,ue),ue.checked=ue.__value===e[5],a(q,Pe),a(q,ve),a(q,Te),a(q,Y),a(q,le),le.checked=le.__value===e[5],a(q,Ie),a(q,X),a(q,Ee),a(q,Je),a(q,ee),ee.checked=ee.__value===e[5],a(q,he),Ue(Re,q,null),a(n,vt),a(n,We),a(n,mt),a(n,_t),a(_t,rt),a(_t,et),a(_t,Oe),a(Oe,ze),a(Oe,Pt),Ue(qe,Oe,null),a(Oe,Mt),a(Oe,at),a(Oe,pt),a(Oe,Ge),a(Oe,Qe),Ue(Ne,Oe,null),e[41](t),wt=!0,we||(bt=[M(d,"change",e[20]),M(g,"change",e[22]),M(O,"change",e[25]),M(F,"input",e[26]),M(F,"input",e[27]),M(ie,"input",e[28]),M(ie,"input",e[29]),M(W,"change",e[30]),M(ue,"change",e[31]),M(le,"change",e[32]),M(ee,"change",e[33])],we=!0)},p(Ae,st){st[0]&16&&(d.checked=d.__value===Ae[4]),st[0]&16&&(g.checked=g.__value===Ae[4]);const wn={};!_&&st[0]&4&&(_=!0,wn.timestamp=Ae[2],xe(()=>_=!1)),k.$set(wn),st[0]&4096&&(O.checked=Ae[12]),st[0]&64&&tt(F.value)!==Ae[6]&&V(F,Ae[6]),st[0]&128&&tt(ie.value)!==Ae[7]&&V(ie,Ae[7]),st[0]&32&&(W.checked=W.__value===Ae[5]),st[0]&32&&(ue.checked=ue.__value===Ae[5]),st[0]&32&&(le.checked=le.__value===Ae[5]),st[0]&32&&(ee.checked=ee.__value===Ae[5]);const Wn={};!Ze&&st[0]&8&&(Ze=!0,Wn.timestamp=Ae[3],xe(()=>Ze=!1)),Re.$set(Wn),(!wt||st[0]&512)&&dt!==(dt=ft.formatTimestamp(Ae[9])+"")&&ht(ze,dt);const Sn={};!Le&&st[0]&8192&&(Le=!0,Sn.timestamp=Ae[13],xe(()=>Le=!1)),qe.$set(Sn),(!wt||st[0]&1024)&&ge!==(ge=ft.formatTimestamp(Ae[10])+"")&&ht(Ge,ge);const xt={};!At&&st[0]&16384&&(At=!0,xt.timestamp=Ae[14],xe(()=>At=!1)),Ne.$set(xt)},i(Ae){wt||(ye(k.$$.fragment,Ae),ye(Re.$$.fragment,Ae),ye(qe.$$.fragment,Ae),ye(Ne.$$.fragment,Ae),wt=!0)},o(Ae){ke(k.$$.fragment,Ae),ke(Re.$$.fragment,Ae),ke(qe.$$.fragment,Ae),ke(Ne.$$.fragment,Ae),wt=!1},d(Ae){Ae&&J(t),He(k),He(Re),He(qe),He(Ne),e[41](null),D.r(),re.r(),we=!1,ut(bt)}}}function lc(e){let t,n,s,i;function l(o){e[42](o)}function r(o){e[43](o)}let d={$$slots:{default:[ic]},$$scope:{ctx:e}};return e[1]!==void 0&&(d.frontend=e[1]),e[0]!==void 0&&(d.show=e[0]),t=new ys({props:d}),be.push(()=>$e(t,"frontend",l)),be.push(()=>$e(t,"show",r)),t.$on("submit",e[44]),{c(){je(t.$$.fragment)},m(o,c){Ue(t,o,c),i=!0},p(o,c){const f={};c[0]&32508|c[1]&131072&&(f.$$scope={dirty:c,ctx:o}),!n&&c[0]&2&&(n=!0,f.frontend=o[1],xe(()=>n=!1)),!s&&c[0]&1&&(s=!0,f.show=o[0],xe(()=>s=!1)),t.$set(f)},i(o){i||(ye(t.$$.fragment,o),i=!0)},o(o){ke(t.$$.fragment,o),i=!1},d(o){He(t,o)}}}function rc(e,t,n){let{frontend:s}=t,{show:i=!1}=t,l,r=0,d=0,o=!1,c="forward",f="zero",g=1,p=1,S,C;const w=gs(),k=X=>w("submit",X);let _,b,v,O,H,I;function N(){I=s.getSelection(),n(9,O=Math.min(...I.map(X=>X.start))),n(10,H=Math.max(...I.map(X=>X.end))),T()}function T(){setTimeout(()=>{n(13,S=Math.max(0,(O-v)*b+v+_)),n(14,C=Math.max(0,(H-v)*b+v+_))},0)}function R(){let X=(C-S)/(H-O);(!isFinite(X)||X<0)&&(X=1),n(6,g=1),n(7,p=X),n(8,b=X),n(15,_=S-v-(O-v)*X),n(4,c=_<0?"backward":"forward"),n(2,r=Math.abs(_))}const U=[[],[]];function j(){c=this.__value,n(4,c)}function oe(){c=this.__value,n(4,c)}function $(X){r=X,n(2,r)}const B=X=>R();function F(){o=this.checked,n(12,o)}function me(){g=tt(this.value),n(6,g)}const ie=()=>T();function Be(){p=tt(this.value),n(7,p)}const E=()=>T();function P(){f=this.__value,n(5,f)}function x(){f=this.__value,n(5,f)}function q(){f=this.__value,n(5,f)}function W(){f=this.__value,n(5,f)}function G(X){d=X,n(3,d)}const ce=()=>T();function _e(X){S=X,n(13,S)}const Ce=X=>R();function ue(X){C=X,n(14,C)}const Pe=X=>R(),ve=()=>n(7,p);function Te(X){be[X?"unshift":"push"](()=>{l=X,n(11,l)})}function Y(X){s=X,n(1,s)}function le(X){i=X,n(0,i)}const Ie=()=>{k({selection:s.getSelection(),offset:v+_-v*b,modifySince:o,scale:b})};return e.$$set=X=>{"frontend"in X&&n(1,s=X.frontend),"show"in X&&n(0,i=X.show)},e.$$.update=()=>{e.$$.dirty[0]&1&&N(),e.$$.dirty[0]&16&&T(),e.$$.dirty[0]&32&&T(),e.$$.dirty[0]&20&&n(15,_=r*(c=="forward"?1:-1)),e.$$.dirty[0]&448&&(n(8,b=p/g),(!isFinite(b)||isNaN(b)||b<0)&&n(8,b=1)),e.$$.dirty[0]&1576&&(n(16,v=0),f=="start"&&n(16,v=O),f=="end"&&n(16,v=H),f=="custom"&&n(16,v=d))},[i,s,r,d,c,f,g,p,b,O,H,l,o,S,C,_,v,k,T,R,j,U,oe,$,B,F,me,ie,Be,E,P,x,q,W,G,ce,_e,Ce,ue,Pe,ve,Te,Y,le,Ie]}class ac extends Zt{constructor(t){super(),Jt(this,t,rc,lc,Ft,{frontend:1,show:0},null,[-1,-1])}}function oc(e){let t,n,s,i,l,r,d,o,c,f,g,p,S,C,w,k,_,b,v,O,H,I,N,T,R,U,j,oe,$,B,F,me,ie,Be,E,P,x,q,W,G,ce,_e,Ce,ue,Pe,ve,Te,Y,le,Ie,X,Ee,Je,ee,he,Re,Ze,vt,We,mt,_t,rt,et,Oe,dt,ze;function Pt(ge){e[19](ge)}function qe(ge){e[20](ge)}let Le={};e[0].subs!==void 0&&(Le.subtitles=e[0].subs),e[9]!==void 0&&(Le.currentStyle=e[9]),x=new ps({props:Le}),be.push(()=>$e(x,"subtitles",Pt)),be.push(()=>$e(x,"currentStyle",qe));function Mt(ge){e[22](ge)}function at(ge){e[23](ge)}let pt={};return e[0].subs!==void 0&&(pt.subtitles=e[0].subs),e[10]!==void 0&&(pt.currentStyle=e[10]),ve=new ps({props:pt}),be.push(()=>$e(ve,"subtitles",Mt)),be.push(()=>$e(ve,"currentStyle",at)),{c(){t=h("table"),n=h("tr"),s=h("td"),s.innerHTML='<label for="expr">expression:</label>',i=y(),l=h("td"),r=h("input"),d=y(),o=h("tr"),c=h("td"),c.innerHTML='<label for="repl">replace by:</label>',f=y(),g=h("td"),p=h("input"),S=y(),C=h("tr"),w=h("td"),k=y(),_=h("td"),b=h("input"),v=y(),O=h("label"),O.textContent="use regular expressions",H=h("br"),I=y(),N=h("input"),T=y(),R=h("label"),R.textContent="case sensitive",U=h("br"),j=y(),oe=h("input"),$=y(),B=h("label"),B.textContent="selected entries only",F=h("br"),me=y(),ie=h("input"),Be=y(),E=h("label"),E.textContent="search in style",P=y(),je(x.$$.fragment),G=h("br"),ce=y(),_e=h("input"),Ce=y(),ue=h("label"),ue.textContent="replace by style",Pe=y(),je(ve.$$.fragment),le=h("br"),Ie=y(),X=h("tr"),Ee=h("td"),Je=h("button"),Je.textContent="find next",ee=y(),he=h("button"),he.textContent="select all",Re=y(),Ze=h("button"),Ze.textContent="replace next",vt=y(),We=h("button"),We.textContent="replace all",mt=y(),_t=h("br"),rt=y(),et=h("button"),et.textContent="replace styles only",m(s,"class","right svelte-1rt6tcb"),m(r,"class","expr svelte-1rt6tcb"),m(r,"id","expr"),m(c,"class","right svelte-1rt6tcb"),m(p,"class","expr svelte-1rt6tcb"),m(p,"id","repl"),m(b,"type","checkbox"),m(b,"id","reg"),m(O,"for","reg"),m(N,"type","checkbox"),m(N,"id","case"),m(R,"for","case"),m(oe,"type","checkbox"),m(oe,"id","sel"),m(B,"for","sel"),m(ie,"type","checkbox"),m(ie,"id","style1"),m(E,"for","style1"),m(_e,"type","checkbox"),m(_e,"id","style2"),m(ue,"for","style2"),m(Ee,"colspan","2"),m(t,"class","config")},m(ge,Ge){Q(ge,t,Ge),a(t,n),a(n,s),a(n,i),a(n,l),a(l,r),V(r,e[2]),a(t,d),a(t,o),a(o,c),a(o,f),a(o,g),a(g,p),V(p,e[3]),a(t,S),a(t,C),a(C,w),a(C,k),a(C,_),a(_,b),b.checked=e[4],a(_,v),a(_,O),a(_,H),a(_,I),a(_,N),N.checked=e[5],a(_,T),a(_,R),a(_,U),a(_,j),a(_,oe),oe.checked=e[6],a(_,$),a(_,B),a(_,F),a(_,me),a(_,ie),ie.checked=e[7],a(_,Be),a(_,E),a(_,P),Ue(x,_,null),a(_,G),a(_,ce),a(_,_e),_e.checked=e[8],a(_,Ce),a(_,ue),a(_,Pe),Ue(ve,_,null),a(_,le),a(t,Ie),a(t,X),a(X,Ee),a(Ee,Je),a(Ee,ee),a(Ee,he),a(Ee,Re),a(Ee,Ze),a(Ee,vt),a(Ee,We),a(Ee,mt),a(Ee,_t),a(Ee,rt),a(Ee,et),Oe=!0,dt||(ze=[M(r,"input",e[13]),M(p,"input",e[14]),M(b,"change",e[15]),M(N,"change",e[16]),M(oe,"change",e[17]),M(ie,"change",e[18]),M(_e,"change",e[21]),M(Je,"click",e[24]),M(he,"click",e[25]),M(Ze,"click",e[26]),M(We,"click",e[27]),M(et,"click",e[28])],dt=!0)},p(ge,Ge){Ge[0]&4&&r.value!==ge[2]&&V(r,ge[2]),Ge[0]&8&&p.value!==ge[3]&&V(p,ge[3]),Ge[0]&16&&(b.checked=ge[4]),Ge[0]&32&&(N.checked=ge[5]),Ge[0]&64&&(oe.checked=ge[6]),Ge[0]&128&&(ie.checked=ge[7]);const Qe={};!q&&Ge[0]&1&&(q=!0,Qe.subtitles=ge[0].subs,xe(()=>q=!1)),!W&&Ge[0]&512&&(W=!0,Qe.currentStyle=ge[9],xe(()=>W=!1)),x.$set(Qe),Ge[0]&256&&(_e.checked=ge[8]);const Ne={};!Te&&Ge[0]&1&&(Te=!0,Ne.subtitles=ge[0].subs,xe(()=>Te=!1)),!Y&&Ge[0]&1024&&(Y=!0,Ne.currentStyle=ge[10],xe(()=>Y=!1)),ve.$set(Ne)},i(ge){Oe||(ye(x.$$.fragment,ge),ye(ve.$$.fragment,ge),Oe=!0)},o(ge){ke(x.$$.fragment,ge),ke(ve.$$.fragment,ge),Oe=!1},d(ge){ge&&J(t),He(x),He(ve),dt=!1,ut(ze)}}}function uc(e){let t;return{c(){t=h("h2"),t.textContent="Search",m(t,"slot","header")},m(n,s){Q(n,t,s)},p:Tt,d(n){n&&J(t)}}}function dc(e){let t,n,s,i;function l(o){e[29](o)}function r(o){e[30](o)}let d={modal:!1,centerWhenOpen:!1,$$slots:{header:[uc],default:[oc]},$$scope:{ctx:e}};return e[0]!==void 0&&(d.frontend=e[0]),e[1]!==void 0&&(d.show=e[1]),t=new ys({props:d}),be.push(()=>$e(t,"frontend",l)),be.push(()=>$e(t,"show",r)),{c(){je(t.$$.fragment)},m(o,c){Ue(t,o,c),i=!0},p(o,c){const f={};c[0]&2045|c[1]&4&&(f.$$scope={dirty:c,ctx:o}),!n&&c[0]&1&&(n=!0,f.frontend=o[0],xe(()=>n=!1)),!s&&c[0]&2&&(s=!0,f.show=o[1],xe(()=>s=!1)),t.$set(f)},i(o){i||(ye(t.$$.fragment,o),i=!0)},o(o){ke(t.$$.fragment,o),i=!1},d(o){He(t,o)}}}function cc(e,t,n){let{frontend:s}=t,{show:i=!1}=t,l="",r="",d=!1,o=!0,c=!1,f=!1,g=!1,p=s.subs.defaultStyle,S=s.subs.defaultStyle,C=null,w=0;var k=(P=>(P[P.Find=0]="Find",P[P.Select=1]="Select",P[P.Replace=2]="Replace",P[P.ReplaceStyleOnly=3]="ReplaceStyleOnly",P))(k||{});function _(P,x){let q=s.subs.entries;if(q.length==0)return;let W=s.getSelection(),G=new Set(W),ce=C??q[0];c&&(ce=W.at(0)??ce);let _e=new RegExp(d?l:Xt.escapeRegexp(l),`g${o?"":"i"}`);(P==1||!c)&&s.clearSelection(Me.Action);let Ce=0,ue=P==2?r:"";console.log(p);e:for(let Pe=Math.max(q.indexOf(ce),0);Pe<q.length;Pe++){let ve=q[Pe];if(!(c&&!G.has(ve)))for(let Te=ve==C?w+1:0;Te<ve.texts.length;Te++){let Y=ve.texts[Te];if(f&&Y.style.name!=p.name)continue;let le=Y.text.replace(_e,ue);if(le!=Y.text&&(console.log(Te,w,ve,C),Ce++,P==1?s.selection.submitted.add(ve):P==2?(Y.text=le,g&&(Y.style=S)):P==3&&(Y.style=S),x)){C=ve,w=Te,s.selectEntry(ve,!1,!0,Me.Action),n(0,s.current.style=Y.style,s);break e}}}Ce>0?(P==1?(n(0,s.status=`selected ${Ce} line${Ce>1?"s":""}`,s),s.onSelectionChanged.dispatch(Me.Action)):P==2?n(0,s.status=`replaced ${Ce} lines${Ce>1?"s":""}`,s):n(0,s.status=`found ${Ce} line${Ce>1?"s":""}; ${C==null?void 0:C.start}, ${w}`,s),s.markChanged(Ye.NonTime,Me.Action)):(n(0,s.status="found nothing",s),C=null,w=0,x&&(n(0,s.current.entry=null,s),s.onSelectionChanged.dispatch(Me.Action)))}function b(){l=this.value,n(2,l)}function v(){r=this.value,n(3,r)}function O(){d=this.checked,n(4,d)}function H(){o=this.checked,n(5,o)}function I(){c=this.checked,n(6,c)}function N(){f=this.checked,n(7,f)}function T(P){e.$$.not_equal(s.subs,P)&&(s.subs=P,n(0,s))}function R(P){p=P,n(9,p)}function U(){g=this.checked,n(8,g)}function j(P){e.$$.not_equal(s.subs,P)&&(s.subs=P,n(0,s))}function oe(P){S=P,n(10,S)}const $=()=>_(k.Find,!0),B=()=>_(k.Select,!1),F=()=>_(k.Replace,!0),me=()=>_(k.Replace,!1),ie=()=>_(k.ReplaceStyleOnly,!1);function Be(P){s=P,n(0,s)}function E(P){i=P,n(1,i)}return e.$$set=P=>{"frontend"in P&&n(0,s=P.frontend),"show"in P&&n(1,i=P.show)},[s,i,l,r,d,o,c,f,g,p,S,k,_,b,v,O,H,I,N,T,R,U,j,oe,$,B,F,me,ie,Be,E]}class hc extends Zt{constructor(t){super(),Jt(this,t,cc,dc,Ft,{frontend:0,show:1},null,[-1,-1])}}var ds,cs,ei;class Nl{constructor(t,n){ne(this,cs);pe(this,"cxt");ne(this,ds,new Set);this.canvas=t;let s=t.getContext("2d");Ve(s!==null),this.cxt=s,Z(this,cs,ei).call(this),new ResizeObserver(()=>Z(this,cs,ei).call(this)).observe(n)}bind(t){u(this,ds).add(t),Z(this,cs,ei).call(this)}unbind(t){u(this,ds).delete(t)}}ds=new WeakMap,cs=new WeakSet,ei=function(){let t=window.devicePixelRatio,n=this.canvas.clientWidth,s=this.canvas.clientHeight;this.canvas.width=Math.floor(n*t),this.canvas.height=Math.floor(s*t),u(this,ds).forEach(i=>i.setDisplaySize(n,s,n*t,s*t))};const{document:fc}=ia;function Bl(e,t,n){const s=e.slice();return s[76]=t[n],s[78]=n,s}function Il(e,t,n){const s=e.slice();return s[79]=t[n],s[81]=n,s}function zl(e,t,n){const s=e.slice();return s[79]=t[n],s[82]=t,s[78]=n,s}function Ul(e){let t,n,s,i,l,r,d,o,c,f,g;return{c(){t=h("li"),n=h("button"),s=Se("undo"),l=y(),r=h("li"),d=h("button"),o=Se("redo"),n.disabled=i=e[2].undoStack.length<=1,d.disabled=c=e[2].redoStack.length==0},m(p,S){Q(p,t,S),a(t,n),a(n,s),Q(p,l,S),Q(p,r,S),a(r,d),a(d,o),f||(g=[M(n,"click",e[34]),M(d,"click",e[35])],f=!0)},p(p,S){S[0]&4&&i!==(i=p[2].undoStack.length<=1)&&(n.disabled=i),S[0]&4&&c!==(c=p[2].redoStack.length==0)&&(d.disabled=c)},d(p){p&&(J(t),J(l),J(r)),f=!1,ut(g)}}}function mc(e){let t,n=e[2].states.virtualEntryHighlighted?"double-click or press enter to append new entry":"select a line to start editing",s;return{c(){t=h("i"),s=Se(n)},m(i,l){Q(i,t,l),a(t,s)},p(i,l){l[0]&4&&n!==(n=i[2].states.virtualEntryHighlighted?"double-click or press enter to append new entry":"select a line to start editing")&&ht(s,n)},i:Tt,o:Tt,d(i){i&&J(t)}}}function pc(e){let t,n,s=Yt(e[2].current.entry.texts),i=[];for(let r=0;r<s.length;r+=1)i[r]=Hl(zl(e,s,r));const l=r=>ke(i[r],1,1,()=>{i[r]=null});return{c(){t=h("table");for(let r=0;r<i.length;r+=1)i[r].c();m(t,"class","fields")},m(r,d){Q(r,t,d);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(t,null);n=!0},p(r,d){if(d[0]&4){s=Yt(r[2].current.entry.texts);let o;for(o=0;o<s.length;o+=1){const c=zl(r,s,o);i[o]?(i[o].p(c,d),ye(i[o],1)):(i[o]=Hl(c),i[o].c(),ye(i[o],1),i[o].m(t,null))}for(_s(),o=s.length;o<i.length;o+=1)l(o);bs()}},i(r){if(!n){for(let d=0;d<s.length;d+=1)ye(i[d]);n=!0}},o(r){i=i.filter(Boolean);for(let d=0;d<i.length;d+=1)ke(i[d]);n=!1},d(r){r&&J(t),Gi(i,r)}}}function Hl(e){let t,n,s,i,l,r,d,o,c,f,g,p,S,C,w,k,_,b;function v(R){e[51](R,e[79])}let O={subtitles:e[2].subs};e[79].style!==void 0&&(O.currentStyle=e[79].style),s=new ps({props:O}),be.push(()=>$e(s,"currentStyle",v)),s.$on("submit",e[52]);function H(){return e[53](e[78])}function I(){return e[54](e[78])}function N(){e[55].call(S,e[82],e[78])}function T(){return e[56](e[79])}return{c(){t=h("tr"),n=h("td"),je(s.$$.fragment),l=y(),r=h("button"),r.textContent="+",d=y(),o=h("button"),c=Se("-"),g=y(),p=h("td"),S=h("textarea"),w=y(),m(r,"tabindex","-1"),m(o,"tabindex","-1"),o.disabled=f=e[2].current.entry.texts.length==1,m(S,"class","contentarea"),m(S,"tabindex","0"),Nt(p,"width","100%")},m(R,U){Q(R,t,U),a(t,n),Ue(s,n,null),a(n,l),a(n,r),a(n,d),a(n,o),a(o,c),a(t,g),a(t,p),a(p,S),V(S,e[79].text),a(t,w),k=!0,_||(b=[M(r,"click",H),M(o,"click",I),M(S,"input",N),xl(C=e[19].call(null,S,e[79])),M(S,"focus",T),M(S,"blur",e[57]),M(S,"input",e[58]),M(S,"change",bc)],_=!0)},p(R,U){e=R;const j={};U[0]&4&&(j.subtitles=e[2].subs),!i&&U[0]&4&&(i=!0,j.currentStyle=e[79].style,xe(()=>i=!1)),s.$set(j),(!k||U[0]&4&&f!==(f=e[2].current.entry.texts.length==1))&&(o.disabled=f),U[0]&4&&V(S,e[79].text),C&&Vs(C.update)&&U[0]&4&&C.update.call(null,e[79])},i(R){k||(ye(s.$$.fragment,R),k=!0)},o(R){ke(s.$$.fragment,R),k=!1},d(R){R&&J(t),He(s),_=!1,ut(b)}}}function jl(e){let t,n,s,i,l,r,d,o,c,f,g,p,S,C,w,k,_,b,v,O,H,I,N,T,R,U,j,oe,$;function B(W){e[42](W)}let F={stretchX:!0};e[15]!==void 0&&(F.timestamp=e[15]),S=new Tn({props:F}),be.push(()=>$e(S,"timestamp",B)),S.$on("input",e[43]),S.$on("change",e[44]);function me(W){e[45](W)}let ie={stretchX:!0};e[16]!==void 0&&(ie.timestamp=e[16]),_=new Tn({props:ie}),be.push(()=>$e(_,"timestamp",me)),_.$on("input",e[46]),_.$on("change",e[47]);function Be(W){e[48](W)}let E={stretchX:!0};e[17]!==void 0&&(E.timestamp=e[17]),H=new Tn({props:E}),be.push(()=>$e(H,"timestamp",Be)),H.$on("input",e[49]),H.$on("change",e[50]);const P=[pc,mc],x=[];function q(W,G){return W[2].current.entry!==null?0:1}return R=q(e),U=x[R]=P[R](e),{c(){t=h("td"),n=h("div"),s=h("select"),i=h("option"),i.textContent="anchor start",l=h("option"),l.textContent="anchor end",r=y(),d=h("span"),o=h("input"),c=y(),f=h("label"),f.textContent="keep duration",g=y(),p=h("div"),je(S.$$.fragment),w=y(),k=h("div"),je(_.$$.fragment),v=y(),O=h("div"),je(H.$$.fragment),N=y(),T=h("td"),U.c(),i.__value="anchor start",V(i,i.__value),l.__value="anchor end",V(l,l.__value),m(s,"class","anchor-select"),m(o,"type","checkbox"),m(o,"id","keepd"),m(f,"for","keepd"),m(p,"class","svelte-1t7lduw"),m(k,"class","svelte-1t7lduw"),m(O,"class","svelte-1t7lduw"),m(n,"class","svelte-1t7lduw"),m(t,"class","times svelte-1t7lduw"),m(T,"class","scroll svelte-1t7lduw")},m(W,G){Q(W,t,G),a(t,n),a(n,s),a(s,i),a(s,l),a(n,r),a(n,d),a(d,o),o.checked=e[14],a(d,c),a(d,f),a(n,g),a(n,p),Ue(S,p,null),a(n,w),a(n,k),Ue(_,k,null),a(n,v),a(n,O),Ue(H,O,null),Q(W,N,G),Q(W,T,G),x[R].m(T,null),j=!0,oe||($=[M(s,"input",e[40]),M(o,"change",e[41])],oe=!0)},p(W,G){G[0]&16384&&(o.checked=W[14]);const ce={};!C&&G[0]&32768&&(C=!0,ce.timestamp=W[15],xe(()=>C=!1)),S.$set(ce);const _e={};!b&&G[0]&65536&&(b=!0,_e.timestamp=W[16],xe(()=>b=!1)),_.$set(_e);const Ce={};!I&&G[0]&131072&&(I=!0,Ce.timestamp=W[17],xe(()=>I=!1)),H.$set(Ce);let ue=R;R=q(W),R===ue?x[R].p(W,G):(_s(),ke(x[ue],1,1,()=>{x[ue]=null}),bs(),U=x[R],U?U.p(W,G):(U=x[R]=P[R](W),U.c()),ye(U,1),U.m(T,null))},i(W){j||(ye(S.$$.fragment,W),ye(_.$$.fragment,W),ye(H.$$.fragment,W),ye(U),j=!0)},o(W){ke(S.$$.fragment,W),ke(_.$$.fragment,W),ke(H.$$.fragment,W),ke(U),j=!1},d(W){W&&(J(t),J(N),J(T)),He(S),He(_),He(H),x[R].d(),oe=!1,ut($)}}}function Vl(e){let t,n=e[78]+"",s,i,l,r,d,o=ft.formatTimestamp(e[76].start)+"",c,f,g,p,S=ft.formatTimestamp(e[76].end)+"",C,w,k,_;return{c(){t=h("td"),s=Se(n),r=y(),d=h("td"),c=Se(o),g=y(),p=h("td"),C=Se(S),m(t,"rowspan",i=e[76].texts.length),m(d,"rowspan",f=e[76].texts.length),m(p,"rowspan",w=e[76].texts.length)},m(b,v){Q(b,t,v),a(t,s),Q(b,r,v),Q(b,d,v),a(d,c),Q(b,g,v),Q(b,p,v),a(p,C),k||(_=xl(l=_c.call(null,t,e[76])),k=!0)},p(b,v){e=b,v[0]&4&&n!==(n=e[78]+"")&&ht(s,n),v[0]&4&&i!==(i=e[76].texts.length)&&m(t,"rowspan",i),l&&Vs(l.update)&&v[0]&4&&l.update.call(null,e[76]),v[0]&4&&o!==(o=ft.formatTimestamp(e[76].start)+"")&&ht(c,o),v[0]&4&&f!==(f=e[76].texts.length)&&m(d,"rowspan",f),v[0]&4&&S!==(S=ft.formatTimestamp(e[76].end)+"")&&ht(C,S),v[0]&4&&w!==(w=e[76].texts.length)&&m(p,"rowspan",w)},d(b){b&&(J(t),J(r),J(d),J(g),J(p)),k=!1,_()}}}function ql(e,t){let n,s,i,l=t[79].style.name+"",r,d,o,c=v()+"",f,g,p,S=t[79].text+"",C,w,k,_,b=t[79]===t[76].texts[0]&&Vl(t);function v(){return t[66](t[79],t[76])}function O(...N){return t[67](t[76],...N)}function H(){return t[69](t[76])}function I(...N){return t[70](t[76],...N)}return{key:e,first:null,c(){n=h("tr"),b&&b.c(),s=y(),i=h("td"),r=Se(l),d=y(),o=h("td"),f=Se(c),g=y(),p=h("td"),C=Se(S),w=y(),m(p,"class","subtext"),Qn(n,"focushlt",t[2].current.entry==t[76]),Qn(n,"sametime",t[2].current.entry!=t[76]&&Jl(t[2].current.entry,t[76])),Qn(n,"selected",t[4].has(t[76])),this.first=n},m(N,T){Q(N,n,T),b&&b.m(n,null),a(n,s),a(n,i),a(i,r),a(n,d),a(n,o),a(o,f),a(n,g),a(n,p),a(p,C),a(n,w),k||(_=[M(n,"mousedown",O),M(n,"contextmenu",t[68]),M(n,"dblclick",H),M(n,"mousemove",I)],k=!0)},p(N,T){t=N,t[79]===t[76].texts[0]?b?b.p(t,T):(b=Vl(t),b.c(),b.m(n,s)):b&&(b.d(1),b=null),T[0]&4&&l!==(l=t[79].style.name+"")&&ht(r,l),T[0]&4&&c!==(c=v()+"")&&ht(f,c),T[0]&4&&S!==(S=t[79].text+"")&&ht(C,S),T[0]&4&&Qn(n,"focushlt",t[2].current.entry==t[76]),T[0]&4&&Qn(n,"sametime",t[2].current.entry!=t[76]&&Jl(t[2].current.entry,t[76])),T[0]&20&&Qn(n,"selected",t[4].has(t[76]))},d(N){N&&J(n),b&&b.d(),k=!1,ut(_)}}}function Gl(e,t){let n,s=[],i=new Map,l,r=Yt(t[76].texts);const d=o=>`${o[78]},${o[81]}`;for(let o=0;o<r.length;o+=1){let c=Il(t,r,o),f=d(c);i.set(f,s[o]=ql(f,c))}return{key:e,first:null,c(){n=hs();for(let o=0;o<s.length;o+=1)s[o].c();l=hs(),this.first=n},m(o,c){Q(o,n,c);for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(o,c);Q(o,l,c)},p(o,c){t=o,c[0]&20&&(r=Yt(t[76].texts),s=Ki(s,c,d,1,t,r,i,l.parentNode,$l,ql,l,Il))},d(o){o&&(J(n),J(l));for(let c=0;c<s.length;c+=1)s[c].d(o)}}}function Kl(e){let t,n,s,i,l,r,d;return{c(){t=h("tr"),n=h("td"),n.textContent="﹡",s=y(),i=h("td"),m(i,"colspan","5"),m(t,"class",l=e[2].states.virtualEntryHighlighted?"focushlt":"")},m(o,c){Q(o,t,c),a(t,n),a(t,s),a(t,i),r||(d=[M(t,"dblclick",e[71]),M(t,"mousedown",e[72])],r=!0)},p(o,c){c[0]&4&&l!==(l=o[2].states.virtualEntryHighlighted?"focushlt":"")&&m(t,"class",l)},d(o){o&&J(t),r=!1,ut(d)}}}function Xl(e){let t,n=e[2].status+"",s;return{c(){t=h("p"),s=Se(n),m(t,"class","status")},m(i,l){Q(i,t,l),a(t,s)},p(i,l){l[0]&4&&n!==(n=i[2].status+"")&&ht(s,n)},d(i){i&&J(t)}}}function gc(e){let t,n,s,i,l,r,d,o,c,f,g,p,S,C,w,k,_,b,v,O,H,I,N,T,R,U,j,oe,$,B=e[11],F,me,ie,Be,E,P,x,q,W,G,ce,_e=(e[2].currentFile?Xt.getFilename(e[2].currentFile):"<untitled>")+"",Ce,ue,Pe=e[2].fileChanged?"*":"",ve,Te,Y,le,Ie,X,Ee,Je,ee,he,Re=e[10],Ze,vt,We,mt,_t,rt,et,Oe,dt,ze,Pt,qe,Le,Mt,at,pt,ge,Ge,Qe,Ne=[],At=new Map,wt,D,re,we,bt,kt,jt,Vt,Wt,Qt,qt=e[12],Dt,Bt,Ae,st={frontend:e[2]};n=new kd({props:st}),e[24](n);let wn={frontend:e[2]};i=new hc({props:wn}),e[25](i);let Wn={frontend:e[2]};r=new ac({props:Wn}),e[26](r);let Sn={frontend:e[2]};o=new bd({props:Sn}),e[27](o);let xt={frontend:e[2]};f=new $d({props:xt}),e[28](f);let ws={frontend:e[2]};p=new Jd({props:ws}),e[29](p);let $t=Ul(e);ee=new _i({props:{vertical:!0,minValue:100,control:e[5]}});let yt=jl(e);mt=new _i({props:{control:e[2].ui.editTable,control2:e[5],minValue:100}});function Ss(L){e[63](L)}let en={};e[9]!==void 0&&(en.timestamp=e[9]),qe=new Tn({props:en}),be.push(()=>$e(qe,"timestamp",Ss)),qe.$on("change",e[64]);let Nn=Yt(e[2].subs.entries);const Yn=L=>L[76].uniqueID;for(let L=0;L<Nn.length;L+=1){let de=Bl(e,Nn,L),It=Yn(de);At.set(It,Ne[L]=Gl(It,de))}let ct=!e[2].states.isEditingVirtualEntry&&Kl(e);kt=new _i({props:{control:e[1],reverse:!0}});let tn=Xl(e);return{c(){t=y(),je(n.$$.fragment),s=y(),je(i.$$.fragment),l=y(),je(r.$$.fragment),d=y(),je(o.$$.fragment),c=y(),je(f.$$.fragment),g=y(),je(p.$$.fragment),S=y(),C=h("main"),w=h("ul"),k=h("li"),_=h("button"),_.textContent="open",b=y(),v=h("li"),O=h("button"),O.textContent="save as",H=y(),I=h("li"),N=h("button"),N.textContent="import",T=y(),R=h("li"),U=h("button"),U.textContent="export",j=y(),oe=h("li"),$=y(),$t.c(),F=y(),me=h("li"),ie=y(),Be=h("li"),E=h("button"),E.textContent="open video",P=y(),x=h("li"),q=h("button"),q.textContent="manage styles",W=y(),G=h("li"),ce=h("div"),Ce=Se(_e),ue=y(),ve=Se(Pe),Te=y(),Y=h("table"),le=h("tr"),Ie=h("td"),X=h("canvas"),Ee=y(),Je=h("td"),je(ee.$$.fragment),he=y(),yt.c(),Ze=y(),vt=h("tfoot"),We=h("td"),je(mt.$$.fragment),_t=y(),rt=h("div"),et=h("button"),Oe=Se(e[6]),dt=y(),ze=h("input"),Pt=y(),je(qe.$$.fragment),Mt=y(),at=h("div"),pt=h("table"),ge=h("thead"),ge.innerHTML='<tr><th scope="col">#</th> <th scope="col">start</th> <th scope="col">end</th> <th scope="col">style</th> <th scope="col">n/s</th> <th scope="col">text</th></tr>',Ge=y(),Qe=h("tbody");for(let L=0;L<Ne.length;L+=1)Ne[L].c();wt=y(),ct&&ct.c(),D=hs(),re=y(),we=h("table"),bt=h("tr"),je(kt.$$.fragment),jt=y(),Vt=h("tr"),Wt=h("canvas"),Qt=y(),tn.c(),m(oe,"class","separator"),m(me,"class","separator"),m(ce,"class","label"),m(w,"class","menu"),m(X,"width","0"),m(X,"height","0"),m(X,"class","svelte-1t7lduw"),m(Ie,"class","player-container svelte-1t7lduw"),Nt(Je,"width","2px"),m(We,"colspan","4"),m(Y,"class","edit"),m(et,"class","svelte-1t7lduw"),m(ze,"type","range"),m(ze,"class","play-pointer"),Nt(ze,"width","100%"),m(ze,"step","any"),m(ze,"max","1"),m(ze,"min","0"),ze.disabled=e[7],m(rt,"class","controls-container svelte-1t7lduw"),m(pt,"class","subs"),m(at,"class","subscontainer"),m(Wt,"class","timeline svelte-1t7lduw"),m(C,"class","container")},m(L,de){Q(L,t,de),Ue(n,L,de),Q(L,s,de),Ue(i,L,de),Q(L,l,de),Ue(r,L,de),Q(L,d,de),Ue(o,L,de),Q(L,c,de),Ue(f,L,de),Q(L,g,de),Ue(p,L,de),Q(L,S,de),Q(L,C,de),a(C,w),a(w,k),a(k,_),a(w,b),a(w,v),a(v,O),a(w,H),a(w,I),a(I,N),a(w,T),a(w,R),a(R,U),a(w,j),a(w,oe),a(w,$),$t.m(w,null),a(w,F),a(w,me),a(w,ie),a(w,Be),a(Be,E),a(w,P),a(w,x),a(x,q),a(w,W),a(w,G),a(G,ce),a(ce,Ce),a(ce,ue),a(ce,ve),a(C,Te),a(C,Y),a(Y,le),a(le,Ie),a(Ie,X),e[38](X),e[39](Ie),a(le,Ee),a(le,Je),Ue(ee,Je,null),a(le,he),yt.m(le,null),a(Y,Ze),a(Y,vt),a(vt,We),Ue(mt,We,null),e[59](Y),a(C,_t),a(C,rt),a(rt,et),a(et,Oe),a(rt,dt),a(rt,ze),V(ze,e[8]),a(rt,Pt),Ue(qe,rt,null),a(C,Mt),a(C,at),a(at,pt),a(pt,ge),e[65](ge),a(pt,Ge),a(pt,Qe);for(let It=0;It<Ne.length;It+=1)Ne[It]&&Ne[It].m(Qe,null);a(Qe,wt),ct&&ct.m(Qe,null),a(Qe,D),e[73](at),a(C,re),a(C,we),a(we,bt),Ue(kt,bt,null),a(we,jt),a(we,Vt),a(Vt,Wt),e[74](Wt),a(C,Qt),tn.m(C,null),Dt=!0,Bt||(Ae=[M(window,"beforeunload",e[22]),M(fc,"keydown",e[23]),M(_,"click",e[30]),M(O,"click",e[31]),M(N,"click",e[32]),M(U,"click",e[33]),M(E,"click",e[36]),M(q,"click",e[37]),M(et,"click",e[60]),M(ze,"change",e[61]),M(ze,"input",e[61]),M(ze,"input",e[62])],Bt=!0)},p(L,de){const It={};de[0]&4&&(It.frontend=L[2]),n.$set(It);const Jn={};de[0]&4&&(Jn.frontend=L[2]),i.$set(Jn);const nn={};de[0]&4&&(nn.frontend=L[2]),r.$set(nn);const Zn={};de[0]&4&&(Zn.frontend=L[2]),o.$set(Zn);const Cs={};de[0]&4&&(Cs.frontend=L[2]),f.$set(Cs);const te={};de[0]&4&&(te.frontend=L[2]),p.$set(te),de[0]&2048&&Ft(B,B=L[11])?($t.d(1),$t=Ul(L),$t.c(),$t.m(w,F)):$t.p(L,de),(!Dt||de[0]&4)&&_e!==(_e=(L[2].currentFile?Xt.getFilename(L[2].currentFile):"<untitled>")+"")&&ht(Ce,_e),(!Dt||de[0]&4)&&Pe!==(Pe=L[2].fileChanged?"*":"")&&ht(ve,Pe);const Fe={};de[0]&32&&(Fe.control=L[5]),ee.$set(Fe),de[0]&1024&&Ft(Re,Re=L[10])?(_s(),ke(yt,1,1,Tt),bs(),yt=jl(L),yt.c(),ye(yt,1),yt.m(le,null)):yt.p(L,de);const ui={};de[0]&4&&(ui.control=L[2].ui.editTable),de[0]&32&&(ui.control2=L[5]),mt.$set(ui),(!Dt||de[0]&64)&&ht(Oe,L[6]),(!Dt||de[0]&128)&&(ze.disabled=L[7]),de[0]&256&&V(ze,L[8]);const sl={};!Le&&de[0]&512&&(Le=!0,sl.timestamp=L[9],xe(()=>Le=!1)),qe.$set(sl),de[0]&20&&(Nn=Yt(L[2].subs.entries),Ne=Ki(Ne,de,Yn,1,L,Nn,At,wt.parentNode,$l,Gl,wt,Bl)),L[2].states.isEditingVirtualEntry?ct&&(ct.d(1),ct=null):ct?ct.p(L,de):(ct=Kl(L),ct.c(),ct.m(D.parentNode,D));const il={};de[0]&2&&(il.control=L[1]),kt.$set(il),de[0]&4096&&Ft(qt,qt=L[12])?(tn.d(1),tn=Xl(L),tn.c(),tn.m(C,null)):tn.p(L,de)},i(L){Dt||(ye(n.$$.fragment,L),ye(i.$$.fragment,L),ye(r.$$.fragment,L),ye(o.$$.fragment,L),ye(f.$$.fragment,L),ye(p.$$.fragment,L),ye(ee.$$.fragment,L),ye(yt),ye(mt.$$.fragment,L),ye(qe.$$.fragment,L),ye(kt.$$.fragment,L),Dt=!0)},o(L){ke(n.$$.fragment,L),ke(i.$$.fragment,L),ke(r.$$.fragment,L),ke(o.$$.fragment,L),ke(f.$$.fragment,L),ke(p.$$.fragment,L),ke(ee.$$.fragment,L),ke(yt),ke(mt.$$.fragment,L),ke(qe.$$.fragment,L),ke(kt.$$.fragment,L),Dt=!1},d(L){L&&(J(t),J(s),J(l),J(d),J(c),J(g),J(S),J(C)),e[24](null),He(n,L),e[25](null),He(i,L),e[26](null),He(r,L),e[27](null),He(o,L),e[28](null),He(f,L),e[29](null),He(p,L),$t.d(L),e[38](null),e[39](null),He(ee),yt.d(L),He(mt),e[59](null),He(qe),e[65](null);for(let de=0;de<Ne.length;de+=1)Ne[de].d();ct&&ct.d(),e[73](null),He(kt),e[74](null),tn.d(L),Bt=!1,ut(Ae)}}}function Yl(e){e.style.height="calc(2.5lh)",e.style.height=`${e.scrollHeight+3}px`}function _c(e,t){return t.gui=e,{update:n=>n.gui=e,destory:()=>t.gui=void 0}}function Jl(e,t){return e&&t&&e.start<t.end&&e.end>t.start}const bc=()=>{};function yc(e,t,n){let s=new hd,i,l=new Set,r,d,o,c="▶",f=!0,g=0,p=0,S=0,C=0,w=0,k=0,_=!1,b=0,v=0,O=0;s.onUndoBufferChanged.bind(()=>{n(11,C++,C)}),s.onStatusChanged.bind(()=>{n(12,w++,w)}),s.onSubtitlesChanged.bind((D,re)=>{n(2,s),re!=Me.UIForm&&n(10,S++,S),console.log("changed",Ye[D],Me[re])}),s.onSelectionChanged.bind(()=>{n(4,l=new Set(s.getSelection())),n(2,s),H()}),s.playback.onRefreshPlaybackControl=()=>{let D=s.playback;n(7,f=!D.isLoaded),n(6,c=D.isPlaying?"⏸":"▶"),n(9,p=D.position??0),n(8,g=D.isLoaded?D.position/D.duration:0)};function H(){if(!s.current.entry)return;let D=s.current.entry;n(15,b=D.start),n(16,v=D.end),n(17,O=v-b);let re=s.states.isEditing;setTimeout(()=>{let we=document.getElementsByClassName("contentarea");for(let bt=0;bt<we.length;bt++){let kt=we.item(bt);Yl(kt)}re&&s.focusOnCurrentEntry()},0)}function I(){if(!s.current.entry)return;let D=s.current.entry;D.start=b,D.end=v,n(17,O=v-b)}function N(D,re){return re.gui=D,{update:we=>{we.gui=D,s.states.editChanged&&s.markChanged(Ye.NonTime,Me.UIForm)},destory:()=>re.gui=void 0}}let T=()=>{if(r===void 0||d===void 0)return;n(20,T=()=>{});let D=new Nl(d,r);D.bind(s.playback.createVideo(D.cxt,s.subs))},R=()=>{if(o===void 0)return;n(21,R=()=>{});let D=new Nl(o,o);D.bind(s.playback.createTimeline(D.cxt,s))};Cn.init();const U=D=>{s.fileChanged&&D.preventDefault()},j=D=>s.uiHelper.processGlobalKeydown(D);function oe(D){be[D?"unshift":"push"](()=>{i=D,n(3,i)})}function $(D){be[D?"unshift":"push"](()=>{s.dialogs.search=D,n(2,s)})}function B(D){be[D?"unshift":"push"](()=>{s.modalDialogs.timeTrans=D,n(2,s)})}function F(D){be[D?"unshift":"push"](()=>{s.modalDialogs.importOpt=D,n(2,s)})}function me(D){be[D?"unshift":"push"](()=>{s.modalDialogs.combine=D,n(2,s)})}function ie(D){be[D?"unshift":"push"](()=>{s.modalDialogs.splitLanguages=D,n(2,s)})}const Be=()=>{const D=Cn.get("paths");oi({items:[{label:"other file...",event:()=>s.askOpenFile()},{is_separator:!0},...D.length==0?[{label:"no recent files",disabled:!0}]:D.map(re=>({label:"[...]/"+re.name.split(Di).slice(-2).join(Di),event:()=>s.openDocument(re.name)})),{is_separator:!0},{label:"clear recents",disabled:D.length==0,event:()=>Cn.set("paths",[])}]})},E=()=>s.askSaveFile(!0),P=()=>s.askImportFile(),x=()=>s.askExportFile(),q=()=>s.undo(),W=()=>s.redo(),G=()=>s.askOpenVideo(),ce=()=>i.$set({show:!0});function _e(D){be[D?"unshift":"push"](()=>{d=D,n(0,d)})}function Ce(D){be[D?"unshift":"push"](()=>{r=D,n(5,r)})}const ue=D=>n(13,k=D.currentTarget.selectedIndex);function Pe(){_=this.checked,n(14,_)}function ve(D){b=D,n(15,b)}const Te=()=>{k==0&&_&&n(16,v=b+O),I(),n(2,s.states.editChanged=!0,s)},Y=()=>s.markChanged(Ye.Times,Me.UIForm);function le(D){v=D,n(16,v)}const Ie=()=>{k==1&&_&&n(15,b=v-O),I(),n(2,s.states.editChanged=!0,s)},X=()=>{v<b&&n(16,v=b),I(),s.markChanged(Ye.Times,Me.UIForm)};function Ee(D){O=D,n(17,O)}const Je=()=>{k==0?n(16,v=b+O):k==1&&n(15,b=v-O),I(),n(2,s.states.editChanged=!0,s)},ee=()=>s.markChanged(Ye.Times,Me.UIForm);function he(D,re){e.$$.not_equal(re.style,D)&&(re.style=D,n(2,s))}const Re=()=>{s.markChanged(Ye.NonTime,Me.UIForm)},Ze=D=>s.insertChannelAt(D),vt=D=>s.deleteChannelAt(D);function We(D,re){D[re].text=this.value,n(2,s)}const mt=D=>{n(2,s.states.isEditing=!0,s),n(2,s.current.style=D.style,s),n(2,s.status="set focusedStyle to "+D.style.name,s)},_t=()=>n(2,s.states.isEditing=!1,s),rt=D=>{Yl(D.currentTarget),n(2,s.states.editChanged=!0,s)};function et(D){be[D?"unshift":"push"](()=>{s.ui.editTable=D,n(2,s)})}const Oe=()=>s.playback.toggle().catch(()=>n(2,s.status="can't play now!",s));function dt(){g=tt(this.value),n(8,g)}const ze=()=>{if(!s.playback.isLoaded){n(8,g=0);return}s.playback.setPosition(g*s.playback.duration)};function Pt(D){p=D,n(9,p)}const qe=()=>s.playback.setPosition(p);function Le(D){be[D?"unshift":"push"](()=>{s.ui.tableHeader=D,n(2,s)})}const Mt=(D,re)=>{let we=ft.getTextLength(D.text)/(re.end-re.start);return isFinite(we)&&!isNaN(we)?we.toFixed(1):"--"},at=(D,re)=>{re.button==0&&s.toggleEntry(D,re.shiftKey,re.getModifierState(Xt.ctrlKey()))},pt=D=>{s.uiHelper.contextMenu(),D.preventDefault()},ge=D=>{s.focusOnCurrentEntry(),s.playback.setPosition(D.start)},Ge=(D,re)=>{re.buttons==1&&s.selectEntry(D,!0,re.getModifierState(Xt.ctrlKey()))},Qe=()=>{s.startEditingNewVirtualEntry()},Ne=()=>{n(2,s.states.virtualEntryHighlighted=!0,s),s.clearSelection()};function At(D){be[D?"unshift":"push"](()=>{s.ui.subscontainer=D,n(2,s)})}function wt(D){be[D?"unshift":"push"](()=>{o=D,n(1,o)})}return e.$$.update=()=>{e.$$.dirty[0]&1048577&&T(),e.$$.dirty[0]&2097154&&R()},[d,o,s,i,l,r,c,f,g,p,S,C,w,k,_,b,v,O,I,N,T,R,U,j,oe,$,B,F,me,ie,Be,E,P,x,q,W,G,ce,_e,Ce,ue,Pe,ve,Te,Y,le,Ie,X,Ee,Je,ee,he,Re,Ze,vt,We,mt,_t,rt,et,Oe,dt,ze,Pt,qe,Le,Mt,at,pt,ge,Ge,Qe,Ne,At,wt]}class wc extends Zt{constructor(t){super(),Jt(this,t,yc,gc,Ft,{},null,[-1,-1,-1])}}new wc({target:document.getElementById("app")});
